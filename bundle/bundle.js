(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function (process){
function normalizeArray(r,t){for(var e=0,n=r.length-1;n>=0;n--){var s=r[n];"."===s?r.splice(n,1):".."===s?(r.splice(n,1),e++):e&&(r.splice(n,1),e--)}if(t)for(;e--;e)r.unshift("..");return r}function filter(r,t){if(r.filter)return r.filter(t);for(var e=[],n=0;n<r.length;n++)t(r[n],n,r)&&e.push(r[n]);return e}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,splitPath=function(r){return splitPathRe.exec(r).slice(1)};exports.resolve=function(){for(var r="",t=!1,e=arguments.length-1;e>=-1&&!t;e--){var n=e>=0?arguments[e]:process.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(r=n+"/"+r,t="/"===n.charAt(0))}return r=normalizeArray(filter(r.split("/"),function(r){return!!r}),!t).join("/"),(t?"/":"")+r||"."},exports.normalize=function(r){var t=exports.isAbsolute(r),e="/"===substr(r,-1);return r=normalizeArray(filter(r.split("/"),function(r){return!!r}),!t).join("/"),r||t||(r="."),r&&e&&(r+="/"),(t?"/":"")+r},exports.isAbsolute=function(r){return"/"===r.charAt(0)},exports.join=function(){var r=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(r,function(r,t){if("string"!=typeof r)throw new TypeError("Arguments to path.join must be strings");return r}).join("/"))},exports.relative=function(r,t){function e(r){for(var t=0;t<r.length&&""===r[t];t++);for(var e=r.length-1;e>=0&&""===r[e];e--);return t>e?[]:r.slice(t,e-t+1)}r=exports.resolve(r).substr(1),t=exports.resolve(t).substr(1);for(var n=e(r.split("/")),s=e(t.split("/")),i=Math.min(n.length,s.length),o=i,u=0;i>u;u++)if(n[u]!==s[u]){o=u;break}for(var l=[],u=o;u<n.length;u++)l.push("..");return l=l.concat(s.slice(o)),l.join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(r){var t=splitPath(r),e=t[0],n=t[1];return e||n?(n&&(n=n.substr(0,n.length-1)),e+n):"."},exports.basename=function(r,t){var e=splitPath(r)[2];return t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e},exports.extname=function(r){return splitPath(r)[3]};var substr="b"==="ab".substr(-1)?function(r,t,e){return r.substr(t,e)}:function(r,t,e){return 0>t&&(t=r.length+t),r.substr(t,e)};
}).call(this,require('_process'))

},{"_process":2}],2:[function(require,module,exports){
function cleanUpNextTick(){draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue()}function drainQueue(){if(!draining){var e=setTimeout(cleanUpNextTick);draining=!0;for(var n=queue.length;n;){for(currentQueue=queue,queue=[];++queueIndex<n;)currentQueue[queueIndex].run();queueIndex=-1,n=queue.length}currentQueue=null,draining=!1,clearTimeout(e)}}function Item(e,n){this.fun=e,this.array=n}function noop(){}var process=module.exports={},queue=[],draining=!1,currentQueue,queueIndex=-1;process.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];queue.push(new Item(e,n)),1!==queue.length||draining||setTimeout(drainQueue,0)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};
},{}],3:[function(require,module,exports){
(function (global){
!function(e){function o(e){throw RangeError(T[e])}function n(e,o){for(var n=e.length,r=[];n--;)r[n]=o(e[n]);return r}function r(e,o){var r=e.split("@"),t="";r.length>1&&(t=r[0]+"@",e=r[1]),e=e.replace(S,".");var u=e.split("."),i=n(u,o).join(".");return t+i}function t(e){for(var o,n,r=[],t=0,u=e.length;u>t;)o=e.charCodeAt(t++),o>=55296&&56319>=o&&u>t?(n=e.charCodeAt(t++),56320==(64512&n)?r.push(((1023&o)<<10)+(1023&n)+65536):(r.push(o),t--)):r.push(o);return r}function u(e){return n(e,function(e){var o="";return e>65535&&(e-=65536,o+=P(e>>>10&1023|55296),e=56320|1023&e),o+=P(e)}).join("")}function i(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:b}function f(e,o){return e+22+75*(26>e)-((0!=o)<<5)}function c(e,o,n){var r=0;for(e=n?M(e/j):e>>1,e+=M(e/o);e>L*C>>1;r+=b)e=M(e/L);return M(r+(L+1)*e/(e+m))}function l(e){var n,r,t,f,l,s,d,a,p,h,v=[],g=e.length,w=0,m=I,j=A;for(r=e.lastIndexOf(E),0>r&&(r=0),t=0;r>t;++t)e.charCodeAt(t)>=128&&o("not-basic"),v.push(e.charCodeAt(t));for(f=r>0?r+1:0;g>f;){for(l=w,s=1,d=b;f>=g&&o("invalid-input"),a=i(e.charCodeAt(f++)),(a>=b||a>M((x-w)/s))&&o("overflow"),w+=a*s,p=j>=d?y:d>=j+C?C:d-j,!(p>a);d+=b)h=b-p,s>M(x/h)&&o("overflow"),s*=h;n=v.length+1,j=c(w-l,n,0==l),M(w/n)>x-m&&o("overflow"),m+=M(w/n),w%=n,v.splice(w++,0,m)}return u(v)}function s(e){var n,r,u,i,l,s,d,a,p,h,v,g,w,m,j,F=[];for(e=t(e),g=e.length,n=I,r=0,l=A,s=0;g>s;++s)v=e[s],128>v&&F.push(P(v));for(u=i=F.length,i&&F.push(E);g>u;){for(d=x,s=0;g>s;++s)v=e[s],v>=n&&d>v&&(d=v);for(w=u+1,d-n>M((x-r)/w)&&o("overflow"),r+=(d-n)*w,n=d,s=0;g>s;++s)if(v=e[s],n>v&&++r>x&&o("overflow"),v==n){for(a=r,p=b;h=l>=p?y:p>=l+C?C:p-l,!(h>a);p+=b)j=a-h,m=b-h,F.push(P(f(h+j%m,0))),a=M(j/m);F.push(P(f(a,0))),l=c(r,w,u==i),r=0,++u}++r,++n}return F.join("")}function d(e){return r(e,function(e){return F.test(e)?l(e.slice(4).toLowerCase()):e})}function a(e){return r(e,function(e){return O.test(e)?"xn--"+s(e):e})}var p="object"==typeof exports&&exports&&!exports.nodeType&&exports,h="object"==typeof module&&module&&!module.nodeType&&module,v="object"==typeof global&&global;(v.global===v||v.window===v||v.self===v)&&(e=v);var g,w,x=2147483647,b=36,y=1,C=26,m=38,j=700,A=72,I=128,E="-",F=/^xn--/,O=/[^\x20-\x7E]/,S=/[\x2E\u3002\uFF0E\uFF61]/g,T={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},L=b-y,M=Math.floor,P=String.fromCharCode;if(g={version:"1.3.2",ucs2:{decode:t,encode:u},decode:l,encode:s,toASCII:a,toUnicode:d},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return g});else if(p&&h)if(module.exports==p)h.exports=g;else for(w in g)g.hasOwnProperty(w)&&(p[w]=g[w]);else e.punycode=g}(this);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],4:[function(require,module,exports){
"use strict";function hasOwnProperty(r,e){return Object.prototype.hasOwnProperty.call(r,e)}module.exports=function(r,e,t,n){e=e||"&",t=t||"=";var o={};if("string"!=typeof r||0===r.length)return o;var a=/\+/g;r=r.split(e);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var p=r.length;s>0&&p>s&&(p=s);for(var y=0;p>y;++y){var u,c,i,l,f=r[y].replace(a,"%20"),v=f.indexOf(t);v>=0?(u=f.substr(0,v),c=f.substr(v+1)):(u=f,c=""),i=decodeURIComponent(u),l=decodeURIComponent(c),hasOwnProperty(o,i)?isArray(o[i])?o[i].push(l):o[i]=[o[i],l]:o[i]=l}return o};var isArray=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)};
},{}],5:[function(require,module,exports){
"use strict";function map(r,e){if(r.map)return r.map(e);for(var t=[],n=0;n<r.length;n++)t.push(e(r[n],n));return t}var stringifyPrimitive=function(r){switch(typeof r){case"string":return r;case"boolean":return r?"true":"false";case"number":return isFinite(r)?r:"";default:return""}};module.exports=function(r,e,t,n){return e=e||"&",t=t||"=",null===r&&(r=void 0),"object"==typeof r?map(objectKeys(r),function(n){var i=encodeURIComponent(stringifyPrimitive(n))+t;return isArray(r[n])?map(r[n],function(r){return i+encodeURIComponent(stringifyPrimitive(r))}).join(e):i+encodeURIComponent(stringifyPrimitive(r[n]))}).join(e):n?encodeURIComponent(stringifyPrimitive(n))+t+encodeURIComponent(stringifyPrimitive(r)):""};var isArray=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)},objectKeys=Object.keys||function(r){var e=[];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&e.push(t);return e};
},{}],6:[function(require,module,exports){
"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode");
},{"./decode":4,"./encode":5}],7:[function(require,module,exports){
function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function urlParse(t,s,e){if(t&&isObject(t)&&t instanceof Url)return t;var h=new Url;return h.parse(t,s,e),h}function urlFormat(t){return isString(t)&&(t=urlParse(t)),t instanceof Url?t.format():Url.prototype.format.call(t)}function urlResolve(t,s){return urlParse(t,!1,!0).resolve(s)}function urlResolveObject(t,s){return t?urlParse(t,!1,!0).resolveObject(s):s}function isString(t){return"string"==typeof t}function isObject(t){return"object"==typeof t&&null!==t}function isNull(t){return null===t}function isNullOrUndefined(t){return null==t}var punycode=require("punycode");exports.parse=urlParse,exports.resolve=urlResolve,exports.resolveObject=urlResolveObject,exports.format=urlFormat,exports.Url=Url;var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,delims=["<",">",'"',"`"," ","\r","\n","	"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=require("querystring");Url.prototype.parse=function(t,s,e){if(!isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var h=t;h=h.trim();var r=protocolPattern.exec(h);if(r){r=r[0];var o=r.toLowerCase();this.protocol=o,h=h.substr(r.length)}if(e||r||h.match(/^\/\/[^@\/]+@[^@\/]+/)){var a="//"===h.substr(0,2);!a||r&&hostlessProtocol[r]||(h=h.substr(2),this.slashes=!0)}if(!hostlessProtocol[r]&&(a||r&&!slashedProtocol[r])){for(var n=-1,i=0;i<hostEndingChars.length;i++){var l=h.indexOf(hostEndingChars[i]);-1!==l&&(-1===n||n>l)&&(n=l)}var c,u;u=-1===n?h.lastIndexOf("@"):h.lastIndexOf("@",n),-1!==u&&(c=h.slice(0,u),h=h.slice(u+1),this.auth=decodeURIComponent(c)),n=-1;for(var i=0;i<nonHostChars.length;i++){var l=h.indexOf(nonHostChars[i]);-1!==l&&(-1===n||n>l)&&(n=l)}-1===n&&(n=h.length),this.host=h.slice(0,n),h=h.slice(n),this.parseHost(),this.hostname=this.hostname||"";var p="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!p)for(var f=this.hostname.split(/\./),i=0,m=f.length;m>i;i++){var v=f[i];if(v&&!v.match(hostnamePartPattern)){for(var g="",y=0,d=v.length;d>y;y++)g+=v.charCodeAt(y)>127?"x":v[y];if(!g.match(hostnamePartPattern)){var P=f.slice(0,i),b=f.slice(i+1),j=v.match(hostnamePartStart);j&&(P.push(j[1]),b.unshift(j[2])),b.length&&(h="/"+b.join(".")+h),this.hostname=P.join(".");break}}}if(this.hostname.length>hostnameMaxLen?this.hostname="":this.hostname=this.hostname.toLowerCase(),!p){for(var O=this.hostname.split("."),q=[],i=0;i<O.length;++i){var x=O[i];q.push(x.match(/[^A-Za-z0-9_-]/)?"xn--"+punycode.encode(x):x)}this.hostname=q.join(".")}var U=this.port?":"+this.port:"",C=this.hostname||"";this.host=C+U,this.href+=this.host,p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==h[0]&&(h="/"+h))}if(!unsafeProtocol[o])for(var i=0,m=autoEscape.length;m>i;i++){var A=autoEscape[i],E=encodeURIComponent(A);E===A&&(E=escape(A)),h=h.split(A).join(E)}var w=h.indexOf("#");-1!==w&&(this.hash=h.substr(w),h=h.slice(0,w));var R=h.indexOf("?");if(-1!==R?(this.search=h.substr(R),this.query=h.substr(R+1),s&&(this.query=querystring.parse(this.query)),h=h.slice(0,R)):s&&(this.search="",this.query={}),h&&(this.pathname=h),slashedProtocol[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var U=this.pathname||"",x=this.search||"";this.path=U+x}return this.href=this.format(),this},Url.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var s=this.protocol||"",e=this.pathname||"",h=this.hash||"",r=!1,o="";this.host?r=t+this.host:this.hostname&&(r=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&isObject(this.query)&&Object.keys(this.query).length&&(o=querystring.stringify(this.query));var a=this.search||o&&"?"+o||"";return s&&":"!==s.substr(-1)&&(s+=":"),this.slashes||(!s||slashedProtocol[s])&&r!==!1?(r="//"+(r||""),e&&"/"!==e.charAt(0)&&(e="/"+e)):r||(r=""),h&&"#"!==h.charAt(0)&&(h="#"+h),a&&"?"!==a.charAt(0)&&(a="?"+a),e=e.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),a=a.replace("#","%23"),s+r+e+a+h},Url.prototype.resolve=function(t){return this.resolveObject(urlParse(t,!1,!0)).format()},Url.prototype.resolveObject=function(t){if(isString(t)){var s=new Url;s.parse(t,!1,!0),t=s}var e=new Url;if(Object.keys(this).forEach(function(t){e[t]=this[t]},this),e.hash=t.hash,""===t.href)return e.href=e.format(),e;if(t.slashes&&!t.protocol)return Object.keys(t).forEach(function(s){"protocol"!==s&&(e[s]=t[s])}),slashedProtocol[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e;if(t.protocol&&t.protocol!==e.protocol){if(!slashedProtocol[t.protocol])return Object.keys(t).forEach(function(s){e[s]=t[s]}),e.href=e.format(),e;if(e.protocol=t.protocol,t.host||hostlessProtocol[t.protocol])e.pathname=t.pathname;else{for(var h=(t.pathname||"").split("/");h.length&&!(t.host=h.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==h[0]&&h.unshift(""),h.length<2&&h.unshift(""),e.pathname=h.join("/")}if(e.search=t.search,e.query=t.query,e.host=t.host||"",e.auth=t.auth,e.hostname=t.hostname||t.host,e.port=t.port,e.pathname||e.search){var r=e.pathname||"",o=e.search||"";e.path=r+o}return e.slashes=e.slashes||t.slashes,e.href=e.format(),e}var a=e.pathname&&"/"===e.pathname.charAt(0),n=t.host||t.pathname&&"/"===t.pathname.charAt(0),i=n||a||e.host&&t.pathname,l=i,c=e.pathname&&e.pathname.split("/")||[],h=t.pathname&&t.pathname.split("/")||[],u=e.protocol&&!slashedProtocol[e.protocol];if(u&&(e.hostname="",e.port=null,e.host&&(""===c[0]?c[0]=e.host:c.unshift(e.host)),e.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===h[0]?h[0]=t.host:h.unshift(t.host)),t.host=null),i=i&&(""===h[0]||""===c[0])),n)e.host=t.host||""===t.host?t.host:e.host,e.hostname=t.hostname||""===t.hostname?t.hostname:e.hostname,e.search=t.search,e.query=t.query,c=h;else if(h.length)c||(c=[]),c.pop(),c=c.concat(h),e.search=t.search,e.query=t.query;else if(!isNullOrUndefined(t.search)){if(u){e.hostname=e.host=c.shift();var p=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;p&&(e.auth=p.shift(),e.host=e.hostname=p.shift())}return e.search=t.search,e.query=t.query,isNull(e.pathname)&&isNull(e.search)||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!c.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var f=c.slice(-1)[0],m=(e.host||t.host)&&("."===f||".."===f)||""===f,v=0,g=c.length;g>=0;g--)f=c[g],"."==f?c.splice(g,1):".."===f?(c.splice(g,1),v++):v&&(c.splice(g,1),v--);if(!i&&!l)for(;v--;v)c.unshift("..");!i||""===c[0]||c[0]&&"/"===c[0].charAt(0)||c.unshift(""),m&&"/"!==c.join("/").substr(-1)&&c.push("");var y=""===c[0]||c[0]&&"/"===c[0].charAt(0);if(u){e.hostname=e.host=y?"":c.length?c.shift():"";var p=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;p&&(e.auth=p.shift(),e.host=e.hostname=p.shift())}return i=i||e.host&&c.length,i&&!y&&c.unshift(""),c.length?e.pathname=c.join("/"):(e.pathname=null,e.path=null),isNull(e.pathname)&&isNull(e.search)||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=t.auth||e.auth,e.slashes=e.slashes||t.slashes,e.href=e.format(),e},Url.prototype.parseHost=function(){var t=this.host,s=portPattern.exec(t);s&&(s=s[0],":"!==s&&(this.port=s.substr(1)),t=t.substr(0,t.length-s.length)),t&&(this.hostname=t)};
},{"punycode":3,"querystring":6}],8:[function(require,module,exports){
(function (global){
var Class=require("js-class"),PIXI=require("pixi.js"),Stats=require("stats.js"),Input=require("keypress.js"),BigScreen=require("bigscreen"),EntityFactory=require("./EntityFactory"),PlayerInputSystem=require("./systems/PlayerInputSystem"),MovementSystem=require("./systems/MovementSystem");Application=Class({constructor:function(t){this.virtualWidth=t.virtualWidth,this.virtualHeight=t.virtualHeight,this.domContainer=t.domContainer,this.lastTime=Date.now(),this.inputListener=null,this.systems=[]},start:function(){this.stage=new PIXI.Container,this.renderer=PIXI.autoDetectRenderer(this.virtualWidth,this.virtualHeight),this.renderer.view.id="gameCanvas",this.renderer.view.style.width=window.innerWidth+"px",this.renderer.view.style.height=window.innerHeight+"px",this.domContainer.appendChild(this.renderer.view),this.stats=new Stats,this.stats.domElement.style.position="absolute",this.stats.domElement.style.left="0px",this.stats.domElement.style.top="0px",this.domContainer.appendChild(this.stats.domElement),this.inputListener=new Input.keypress.Listener,this.playerInput=new PlayerInputSystem(EntityFactory.entities,this.inputListener),this.systems.push(this.playerInput),this.systems.push(new MovementSystem(EntityFactory.entities)),this.player=EntityFactory.makePlayer({imgPath:"gfx/battleMage.gif",x:this.virtualWidth/2,y:this.virtualHeight/2,stage:this.stage}),this.attachListeners(),this.run(),this.iswasd=!0,this.inputListener.register_combo({keys:"num_0",on_keydown:function(){this.iswasd=!this.iswasd,this.iswasd?this.playerInput.setupWASD():this.playerInput.setupArrows()},"this":this,prevent_repeat:!0})},attachListeners:function(){window.addEventListener("resize",function(t){this.renderer.view.style.width=window.innerWidth+"px",this.renderer.view.style.height=window.innerHeight+"px"}.bind(this)),this.inputListener.register_combo({keys:"alt enter",on_keydown:function(){this.renderer.view;BigScreen.toggle(this.domContainer)},"this":this,prevent_repeat:!0})},run:function(){var t=Date.now(),e=(t-this.lastTime)/1e3;this.lastTime=t,this.stats.begin(),this.systems.forEach(function(t){t.update(e)}),this.renderer.render(this.stage),this.stats.end(),requestAnimationFrame(this.run.bind(this))}}),module?module.exports=Application:global.Application=Application;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./EntityFactory":9,"./systems/MovementSystem":13,"./systems/PlayerInputSystem":14,"bigscreen":15,"js-class":16,"keypress.js":17,"pixi.js":122,"stats.js":141}],9:[function(require,module,exports){
(function (global){
var EntityManager=require("tiny-ecs").EntityManager,C={};C.Drawable=require("./components/Drawable"),C.Velocity=require("./components/Velocity");var EntityFactory={};EntityFactory.entities=new EntityManager,EntityFactory.makePlayer=function(t){var e=EntityFactory.entities.createEntity();return e.addTag("player"),e.addComponent(C.Drawable),e.addComponent(C.Velocity),e.drawable.texture=PIXI.Texture.fromImage(t.imgPath),e.drawable.sprite=new PIXI.Sprite(e.drawable.texture),e.drawable.sprite.anchor.x=.5,e.drawable.sprite.anchor.y=.5,e.drawable.sprite.position.x=t.x||0,e.drawable.sprite.position.y=t.y||0,t.stage&&t.stage.addChild(e.drawable.sprite),e},module?module.exports=EntityFactory:global.EntityFactory=EntityFactory;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./components/Drawable":11,"./components/Velocity":12,"tiny-ecs":142}],10:[function(require,module,exports){
function init(){var i=new Application({virtualWidth:1920,virtualHeight:1080,domContainer:document.getElementById("applicationContainer")});i.start()}var Application=require("./Application");document.onload=init();
},{"./Application":8}],11:[function(require,module,exports){
(function (global){
function Drawable(){this.texture=null,this.sprite=null}module?module.exports=Drawable:global.Drawable=Drawable;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],12:[function(require,module,exports){
(function (global){
function Velocity(){this.x=0,this.y=0}module?module.exports=Velocity:global.Velocity=Velocity;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],13:[function(require,module,exports){
(function (global){
var Class=require("js-class"),PIXI=require("pixi.js"),C={};C.Drawable=require("./../components/Drawable"),C.Velocity=require("./../components/Velocity");var MovementSystem=Class({constructor:function(e){this.entities=e},update:function(e){var t=this.entities.queryComponents([C.Drawable,C.Velocity]);t.forEach(function(t){t.drawable.sprite.position.x+=t.velocity.x*e,t.drawable.sprite.position.y+=t.velocity.y*e})}});module?module.exports=MovementSystem:global.MovementSystem=MovementSystem;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./../components/Drawable":11,"./../components/Velocity":12,"js-class":16,"pixi.js":122}],14:[function(require,module,exports){
(function (global){
var Class=require("js-class"),PIXI=require("pixi.js"),C={};C.Drawable=require("./../components/Drawable"),C.Velocity=require("./../components/Velocity");var PlayerInputSystem=Class({constructor:function(t,i){this.entities=t,this.inputListener=i,this.actionMapping={left:"a",right:"d",up:"w",down:"s"},this.actionDown={left:!1,right:!1,up:!1,down:!1},this.actionPressed={left:!1,right:!1,up:!1,down:!1},this.setupWASD()},update:function(t){var i=this.entities.queryTag("player");i.forEach(function(t){this.actionDown.left?t.velocity.x=-60:this.actionDown.right?t.velocity.x=60:t.velocity.x=0,this.actionDown.up?t.velocity.y=-60:this.actionDown.down?t.velocity.y=60:t.velocity.y=0}.bind(this));for(var n in this.actionPressed)this.actionPressed.hasOwnProperty(n)&&(this.actionPressed[n]=!1)},bindAction:function(t,i){this.actionMapping[i]!==t&&this.inputListener.unregister_combo(this.actionMapping[i]),this.actionMapping[i]=t,this.inputListener.register_combo({keys:t,on_keydown:function(){this.actionDown[i]=!0},on_keyup:function(){this.actionDown[i]=!1,this.actionPressed[i]=!0},"this":this,prevent_repeat:!0})},setupWASD:function(){this.bindAction("a","left"),this.bindAction("d","right"),this.bindAction("w","up"),this.bindAction("s","down")},setupArrows:function(){this.bindAction("left","left"),this.bindAction("right","right"),this.bindAction("up","up"),this.bindAction("down","down")}});module?module.exports=PlayerInputSystem:global.PlayerInputSystem=PlayerInputSystem;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./../components/Drawable":11,"./../components/Velocity":12,"js-class":16,"pixi.js":122}],15:[function(require,module,exports){
!function(e,n,t){"use strict";function r(e){var n=null;if("VIDEO"===e.tagName)n=e;else{var t=e.getElementsByTagName("video");t[0]&&(n=t[0])}return n}function l(e){var n=r(e);if(n&&n.webkitEnterFullscreen){try{n.readyState<n.HAVE_METADATA?(n.addEventListener("loadedmetadata",function l(){n.removeEventListener("loadedmetadata",l,!1),n.webkitEnterFullscreen(),d=!!n.getAttribute("controls")},!1),n.load()):(n.webkitEnterFullscreen(),d=!!n.getAttribute("controls")),s=n}catch(t){return E("not_supported",e)}return!0}return E(void 0===c.request?"not_supported":"not_enabled",e)}function o(){h.element||(v(),u())}function i(){t&&"webkitfullscreenchange"===c.change&&window.addEventListener("resize",o,!1)}function u(){t&&"webkitfullscreenchange"===c.change&&window.removeEventListener("resize",o,!1)}var a=/i(Pad|Phone|Pod)/.test(navigator.userAgent)&&parseInt(navigator.userAgent.replace(/^.*OS (\d+)_(\d+).*$/,"$1.$2"),10)>=7,c=function(){var e=n.createElement("video"),t={request:["requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"],exit:["exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],enabled:["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],element:["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"],change:["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],error:["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"]},r={};for(var l in t)for(var o=0,i=t[l].length;i>o;o++)if(t[l][o]in e||t[l][o]in n||"on"+t[l][o].toLowerCase()in n){r[l]=t[l][o];break}return r}(),s=null,d=null,m=function(){},f=[],b=!1;navigator.userAgent.indexOf("Android")>-1&&navigator.userAgent.indexOf("Chrome")>-1&&(b=parseInt(navigator.userAgent.replace(/^.*Chrome\/(\d+).*$/,"$1"),10)||!0);var g=function(e){var n=f[f.length-1];n&&(e!==n.element&&e!==s||!n.hasEntered)&&("VIDEO"===e.tagName&&(s=e),1===f.length&&h.onenter(h.element),n.enter.call(n.element,e||n.element),n.hasEntered=!0)},v=function(){!s||d||a||(s.setAttribute("controls","controls"),s.removeAttribute("controls")),s=null,d=null;var e=f.pop();e&&(e.exit.call(e.element),h.element||(f.forEach(function(e){e.exit.call(e.element)}),f=[],h.onexit()))},E=function(e,n){if(f.length>0){var t=f.pop();n=n||t.element,t.error.call(n,e),h.onerror(n,e)}},h={request:function(e,r,o,i){if(e=e||n.body,f.push({element:e,enter:r||m,exit:o||m,error:i||m}),void 0===c.request)return void l(e);if(t&&n[c.enabled]===!1)return void l(e);if(b!==!1&&32>b)return void l(e);if(t&&void 0===c.enabled)return c.enabled="webkitFullscreenEnabled",e[c.request](),void setTimeout(function(){n[c.element]?n[c.enabled]=!0:(n[c.enabled]=!1,l(e))},250);try{e[c.request](),setTimeout(function(){n[c.element]||E(t?"not_enabled":"not_allowed",e)},100)}catch(u){E("not_enabled",e)}},exit:function(){u(),n[c.exit]()},toggle:function(e,n,t,r){h.element?h.exit():h.request(e,n,t,r)},videoEnabled:function(e){if(h.enabled)return!0;e=e||n.body;var t=r(e);return t&&void 0!==t.webkitSupportsFullscreen?t.readyState<t.HAVE_METADATA?"maybe":t.webkitSupportsFullscreen:!1},onenter:m,onexit:m,onchange:m,onerror:m};try{Object.defineProperties(h,{element:{enumerable:!0,get:function(){return s&&s.webkitDisplayingFullscreen?s:n[c.element]||null}},enabled:{enumerable:!0,get:function(){return"webkitCancelFullScreen"!==c.exit||t?b!==!1&&32>b?!1:n[c.enabled]||!1:!0}}}),c.change&&n.addEventListener(c.change,function(e){if(h.onchange(h.element),h.element){var n=f[f.length-2];n&&n.element===h.element?v():(g(h.element),i())}else v()},!1),n.addEventListener("webkitbeginfullscreen",function(e){var n=!0;if(f.length>0)for(var t=0,l=f.length;l>t;t++){var o=r(f[t].element);if(o===e.srcElement){n=!1;break}}n&&f.push({element:e.srcElement,enter:m,exit:m,error:m}),h.onchange(e.srcElement),g(e.srcElement)},!0),n.addEventListener("webkitendfullscreen",function(e){h.onchange(e.srcElement),v(e.srcElement)},!0),c.error&&n.addEventListener(c.error,function(e){E("not_allowed")},!1)}catch(w){h.element=null,h.enabled=!1}"function"==typeof define&&define.amd?define(function(){return h}):"undefined"!=typeof module&&module.exports?module.exports=h:e.BigScreen=h}(this,document,self!==top);
},{}],16:[function(require,module,exports){
(function (global){
function inherit(e,t,r){for(;t&&t!==Object.prototype&&(Object.getOwnPropertyNames(t).forEach(function(r){if(".class"!=r&&!e.hasOwnProperty(r)){var o=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,o)}}),!r);)t=t.__proto__;return e}function findType(e,t){for(;e;){if(e.type.prototype===t.prototype)return!0;for(var r in e["implements"]){var o=e["implements"][r],n=o[".class.meta"];if(n){if(findType(n,t))return!0}else for(var s=o.prototype;s;s=s.__proto__)if(s===t.prototype)return!0}e=e.base?e.base[".class.meta"]:void 0}return!1}var Class=function(e,t,r){"function"!=typeof e&&(r=t,t=e,e=Object),t||(t={}),r||(r={});var o={name:r.name,base:e,"implements":[]},n=Class.clone(t);r["implements"]&&(Array.isArray(r["implements"])?r["implements"]:[r["implements"]]).forEach(function(e){"function"==typeof e&&e.prototype&&(o["implements"].push(e),Class.extend(n,e.prototype))}),n.__proto__=e.prototype;var s=function(){"function"==typeof this.constructor&&this.constructor.apply(this,arguments)};return o.type=s,s.prototype=n,Object.defineProperty(s,".class.meta",{value:o,enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(n,".class",{value:s,enumerable:!1,configurable:!1,writable:!1}),r.statics&&Class.extend(s,r.statics),s};Class.extend=inherit,Class.clone=function(e){return inherit({},e)};var Checker=Class({constructor:function(e){this.object=e},typeOf:function(e){if(this.object instanceof e)return!0;var t=Class.typeInfo(this.object);return t&&findType(t,e)}});Checker.prototype.a=Checker.prototype.typeOf,Checker.prototype.an=Checker.prototype.typeOf,Class.is=function(e){return new Checker(e)},Class.typeInfo=function(e){var t=e.__proto__[".class"];return t?t[".class.meta"]:void 0},Class.VERSION=[0,0,2],module?module.exports=Class:global.Class=Class;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],17:[function(require,module,exports){
(function(){var e,t,n,o,r,i,s,_,u,c,l,h,f,a,d,p,y,m,v,k,g,b,w={}.hasOwnProperty,q=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};u={is_unordered:!1,is_counting:!1,is_exclusive:!1,is_solitary:!1,prevent_default:!1,prevent_repeat:!1},g=["meta","alt","option","ctrl","shift","cmd"],v="ctrl",t={},t.debug=!1,e=function(){function e(e){var t,n;for(t in e)w.call(e,t)&&(n=e[t],n!==!1&&(this[t]=n));this.keys=this.keys||[],this.count=this.count||0}return e.prototype.allows_key_repeat=function(){return!this.prevent_repeat&&"function"==typeof this.on_keydown},e.prototype.reset=function(){return this.count=0,this.keyup_fired=null},e}(),t.Listener=function(){function t(e,t){var n,o,r;"undefined"!=typeof jQuery&&null!==jQuery&&e instanceof jQuery&&(1!==e.length&&m("Warning: your jQuery selector should have exactly one object."),e=e[0]),this.should_suppress_event_defaults=!1,this.should_force_event_defaults=!1,this.sequence_delay=800,this._registered_combos=[],this._keys_down=[],this._active_combos=[],this._sequence=[],this._sequence_timer=null,this._prevent_capture=!1,this._defaults=t||{};for(o in u)w.call(u,o)&&(r=u[o],this._defaults[o]=this._defaults[o]||r);this.element=e||document.body,n=function(e,t,n){return e.addEventListener?e.addEventListener(t,n):e.attachEvent&&e.attachEvent("on"+t,n),n},this.keydown_event=n(this.element,"keydown",function(e){return function(t){return t=t||window.event,e._receive_input(t,!0),e._bug_catcher(t)}}(this)),this.keyup_event=n(this.element,"keyup",function(e){return function(t){return t=t||window.event,e._receive_input(t,!1)}}(this)),this.blur_event=n(window,"blur",function(e){return function(){var t,n,o,r;for(r=e._keys_down,n=0,o=r.length;o>n;n++)t=r[n],e._key_up(t,{});return e._keys_down=[]}}(this))}return t.prototype.destroy=function(){var e;return e=function(e,t,n){return null!=e.removeEventListener?e.removeEventListener(t,n):null!=e.removeEvent?e.removeEvent("on"+t,n):void 0},e(this.element,"keydown",this.keydown_event),e(this.element,"keyup",this.keyup_event),e(window,"blur",this.blur_event)},t.prototype._bug_catcher=function(e){var t;return"cmd"===v&&q.call(this._keys_down,"cmd")>=0&&"cmd"!==(t=i(e.keyCode))&&"shift"!==t&&"alt"!==t&&"caps"!==t&&"tab"!==t?this._receive_input(e,!1):void 0},t.prototype._cmd_bug_check=function(e){return"cmd"===v&&q.call(this._keys_down,"cmd")>=0&&q.call(e,"cmd")<0?!1:!0},t.prototype._prevent_default=function(e,t){return(t||this.should_suppress_event_defaults)&&!this.should_force_event_defaults&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation)?e.stopPropagation():void 0},t.prototype._get_active_combos=function(e){var t,n;return t=[],n=c(this._keys_down,function(t){return t!==e}),n.push(e),this._match_combo_arrays(n,function(e){return function(n){return e._cmd_bug_check(n.keys)?t.push(n):void 0}}(this)),this._fuzzy_match_combo_arrays(n,function(e){return function(n){return q.call(t,n)>=0?void 0:!n.is_solitary&&e._cmd_bug_check(n.keys)?t.push(n):void 0}}(this)),t},t.prototype._get_potential_combos=function(e){var t,n,o,r,i;for(n=[],i=this._registered_combos,o=0,r=i.length;r>o;o++)t=i[o],t.is_sequence||q.call(t.keys,e)>=0&&this._cmd_bug_check(t.keys)&&n.push(t);return n},t.prototype._add_to_active_combos=function(e){var t,n,o,r,i,s,_,u,c,l,h,f,a,d,p;if(u=!1,_=!0,r=!1,q.call(this._active_combos,e)>=0)return!0;if(this._active_combos.length)for(s=c=0,d=this._active_combos.length;d>=0?d>c:c>d;s=d>=0?++c:--c)if(t=this._active_combos[s],t&&t.is_exclusive&&e.is_exclusive){if(o=t.keys,!u)for(l=0,f=o.length;f>l;l++)if(n=o[l],u=!0,q.call(e.keys,n)<0){u=!1;break}if(_&&!u)for(p=e.keys,h=0,a=p.length;a>h;h++)if(i=p[h],_=!1,q.call(o,i)<0){_=!0;break}u&&(r?(t=this._active_combos.splice(s,1)[0],null!=t&&t.reset()):(t=this._active_combos.splice(s,1,e)[0],null!=t&&t.reset(),r=!0),_=!1)}return _&&this._active_combos.unshift(e),u||_},t.prototype._remove_from_active_combos=function(e){var t,n,o,r;for(n=o=0,r=this._active_combos.length;r>=0?r>o:o>r;n=r>=0?++o:--o)if(t=this._active_combos[n],t===e){e=this._active_combos.splice(n,1)[0],e.reset();break}},t.prototype._get_possible_sequences=function(){var e,t,n,o,r,i,s,_,u,l,h,f,a;for(r=[],h=this._registered_combos,s=0,l=h.length;l>s;s++)for(e=h[s],n=_=1,f=this._sequence.length;f>=1?f>=_:_>=f;n=f>=1?++_:--_)if(i=this._sequence.slice(-n),e.is_sequence&&(!(q.call(e.keys,"shift")<0)||(i=c(i,function(e){return"shift"!==e}),i.length))){for(t=u=0,a=i.length;a>=0?a>u:u>a;t=a>=0?++u:--u){if(e.keys[t]!==i[t]){o=!1;break}o=!0}o&&r.push(e)}return r},t.prototype._add_key_to_sequence=function(e,t){var n,o,r,i;if(this._sequence.push(e),o=this._get_possible_sequences(),o.length){for(r=0,i=o.length;i>r;r++)n=o[r],this._prevent_default(t,n.prevent_default);this._sequence_timer&&clearTimeout(this._sequence_timer),this.sequence_delay>-1&&(this._sequence_timer=setTimeout(function(){return this._sequence=[]},this.sequence_delay))}else this._sequence=[]},t.prototype._get_sequence=function(e){var t,n,o,r,i,s,_,u,l,h,f,a,d;for(f=this._registered_combos,_=0,h=f.length;h>_;_++)if(t=f[_],t.is_sequence){for(o=u=1,a=this._sequence.length;a>=1?a>=u:u>=a;o=a>=1?++u:--u)if(s=c(this._sequence,function(e){return q.call(t.keys,"shift")>=0?!0:"shift"!==e}).slice(-o),t.keys.length===s.length)for(n=l=0,d=s.length;d>=0?d>l:l>d;n=d>=0?++l:--l)if(i=s[n],!(q.call(t.keys,"shift")<0&&"shift"===i||"shift"===e&&q.call(t.keys,"shift")<0)){if(t.keys[n]!==i){r=!1;break}r=!0}if(r)return t.is_exclusive&&(this._sequence=[]),t}return!1},t.prototype._receive_input=function(e,t){var n;return this._prevent_capture?void(this._keys_down.length&&(this._keys_down=[])):(n=i(e.keyCode),(t||this._keys_down.length||"alt"!==n&&n!==v)&&n?t?this._key_down(n,e):this._key_up(n,e):void 0)},t.prototype._fire=function(e,t,n,o){return"function"==typeof t["on_"+e]&&this._prevent_default(n,t["on_"+e].call(t["this"],n,t.count,o)!==!0),"release"===e&&(t.count=0),"keyup"===e?t.keyup_fired=!0:void 0},t.prototype._match_combo_arrays=function(e,t){var n,i,s,_;for(_=this._registered_combos,i=0,s=_.length;s>i;i++)n=_[i],(!n.is_unordered&&r(e,n.keys)||n.is_unordered&&o(e,n.keys))&&t(n)},t.prototype._fuzzy_match_combo_arrays=function(e,t){var n,o,r,i;for(i=this._registered_combos,o=0,r=i.length;r>o;o++)n=i[o],(!n.is_unordered&&f(n.keys,e)||n.is_unordered&&h(n.keys,e))&&t(n)},t.prototype._keys_remain=function(e){var t,n,o,r,i;for(i=e.keys,o=0,r=i.length;r>o;o++)if(t=i[o],q.call(this._keys_down,t)>=0){n=!0;break}return n},t.prototype._key_down=function(e,t){var n,o,r,i,_,u,c,l,h,f,a,d,p,y,m;h=s(e,t),h&&(e=h),this._add_key_to_sequence(e,t),l=this._get_sequence(e),l&&this._fire("keydown",l,t);for(_ in k)r=k[_],t[r]&&(_===e||q.call(this._keys_down,_)>=0||this._keys_down.push(_));for(_ in k)if(r=k[_],_!==e&&q.call(this._keys_down,_)>=0&&!t[r]){if("cmd"===_&&"cmd"!==v)continue;for(i=f=0,m=this._keys_down.length;m>=0?m>f:f>m;i=m>=0?++f:--f)this._keys_down[i]===_&&this._keys_down.splice(i,1)}for(o=this._get_active_combos(e),c=this._get_potential_combos(e),a=0,p=o.length;p>a;a++)n=o[a],this._handle_combo_down(n,c,e,t);if(c.length)for(d=0,y=c.length;y>d;d++)u=c[d],this._prevent_default(t,u.prevent_default);q.call(this._keys_down,e)<0&&this._keys_down.push(e)},t.prototype._handle_combo_down=function(e,t,n,o){var r,i,s,_,u,c;if(q.call(e.keys,n)<0)return!1;if(this._prevent_default(o,e&&e.prevent_default),r=!1,q.call(this._keys_down,n)>=0&&(r=!0,!e.allows_key_repeat()))return!1;if(_=this._add_to_active_combos(e,n),e.keyup_fired=!1,i=!1,e.is_exclusive)for(u=0,c=t.length;c>u;u++)if(s=t[u],s.is_exclusive&&s.keys.length>e.keys.length){i=!0;break}return!i&&(e.is_counting&&"function"==typeof e.on_keydown&&(e.count+=1),_)?this._fire("keydown",e,o,r):void 0},t.prototype._key_up=function(e,t){var n,o,r,i,_,u,c,l,h,f,a,d,p,m,v,k,g,b,w;if(l=e,c=s(e,t),c&&(e=c),c=y[l],t.shiftKey?c&&q.call(this._keys_down,c)>=0||(e=l):l&&q.call(this._keys_down,l)>=0||(e=c),u=this._get_sequence(e),u&&this._fire("keyup",u,t),q.call(this._keys_down,e)<0)return!1;for(_=h=0,k=this._keys_down.length;k>=0?k>h:h>k;_=k>=0?++h:--h)if((g=this._keys_down[_])===e||g===c||g===l){this._keys_down.splice(_,1);break}for(o=this._active_combos.length,i=[],b=this._active_combos,f=0,p=b.length;p>f;f++)n=b[f],q.call(n.keys,e)>=0&&i.push(n);for(a=0,m=i.length;m>a;a++)r=i[a],this._handle_combo_up(r,t,e);if(o>1)for(w=this._active_combos,d=0,v=w.length;v>d;d++)n=w[d],void 0===n||q.call(i,n)>=0||this._keys_remain(n)||this._remove_from_active_combos(n)},t.prototype._handle_combo_up=function(e,t,n){var r,i;this._prevent_default(t,e&&e.prevent_default),i=this._keys_remain(e),e.keyup_fired||(r=this._keys_down.slice(),r.push(n),(!e.is_solitary||o(r,e.keys))&&(this._fire("keyup",e,t),e.is_counting&&"function"==typeof e.on_keyup&&"function"!=typeof e.on_keydown&&(e.count+=1))),i||(this._fire("release",e,t),this._remove_from_active_combos(e))},t.prototype.simple_combo=function(e,t){return this.register_combo({keys:e,on_keydown:t})},t.prototype.counting_combo=function(e,t){return this.register_combo({keys:e,is_counting:!0,is_unordered:!1,on_keydown:t})},t.prototype.sequence_combo=function(e,t){return this.register_combo({keys:e,on_keydown:t,is_sequence:!0,is_exclusive:!0})},t.prototype.register_combo=function(t){var n,o,r,i;"string"==typeof t.keys&&(t.keys=t.keys.split(" ")),i=this._defaults;for(o in i)w.call(i,o)&&(r=i[o],void 0===t[o]&&(t[o]=r));return n=new e(t),b(n)?(this._registered_combos.push(n),n):void 0},t.prototype.register_many=function(e){var t,n,o,r;for(r=[],n=0,o=e.length;o>n;n++)t=e[n],r.push(this.register_combo(t));return r},t.prototype.unregister_combo=function(t){var n,i,s,_,u,c;if(!t)return!1;if(i=function(e){return function(t){var n,o,r,i;for(i=[],n=o=0,r=e._registered_combos.length;r>=0?r>o:o>r;n=r>=0?++o:--o){if(t===e._registered_combos[n]){e._registered_combos.splice(n,1);break}i.push(void 0)}return i}}(this),t instanceof e)return i(t);for("string"==typeof t&&(t=t.split(" ")),u=this._registered_combos,c=[],s=0,_=u.length;_>s;s++)n=u[s],null!=n&&(n.is_unordered&&o(t,n.keys)||!n.is_unordered&&r(t,n.keys)?c.push(i(n)):c.push(void 0));return c},t.prototype.unregister_many=function(e){var t,n,o,r;for(r=[],n=0,o=e.length;o>n;n++)t=e[n],r.push(this.unregister_combo(t));return r},t.prototype.get_registered_combos=function(){return this._registered_combos},t.prototype.reset=function(){return this._registered_combos=[]},t.prototype.listen=function(){return this._prevent_capture=!1},t.prototype.stop_listening=function(){return this._prevent_capture=!0},t.prototype.get_meta_key=function(){return v},t}(),_=function(){-1!==navigator.userAgent.indexOf("Mac OS X")&&(v="cmd")},n=function(){-1!==navigator.userAgent.indexOf("Opera")&&(p[17]="cmd")},i=function(e){return p[e]},c=function(e,t){var n;return e.filter?e.filter(t):function(){var o,r,i;for(i=[],o=0,r=e.length;r>o;o++)n=e[o],t(n)&&i.push(n);return i}()},o=function(e,t){var n,o,r;if(e.length!==t.length)return!1;for(o=0,r=e.length;r>o;o++)if(n=e[o],!(q.call(t,n)>=0))return!1;return!0},r=function(e,t){var n,o,r;if(e.length!==t.length)return!1;for(n=o=0,r=e.length;r>=0?r>o:o>r;n=r>=0?++o:--o)if(e[n]!==t[n])return!1;return!0},h=function(e,t){var n,o,r;for(o=0,r=e.length;r>o;o++)if(n=e[o],q.call(t,n)<0)return!1;return!0},l=Array.prototype.indexOf||function(e,t){var n,o,r;for(n=o=0,r=e.length;r>=0?r>=o:o>=r;n=r>=0?++o:--o)if(e[n]===t)return n;return-1},f=function(e,t){var n,o,r,i,s;for(r=0,i=0,s=e.length;s>i;i++){if(o=e[i],n=l.call(t,o),!(n>=r))return!1;r=n}return!0},m=function(){return t.debug?console.log.apply(console,arguments):void 0},a=function(e){var t,n,o;t=!1;for(o in p)if(n=p[o],e===n){t=!0;break}if(!t)for(o in y)if(n=y[o],e===n){t=!0;break}return t},b=function(e){var t,n,o,r,i,s,_,c,h,f,p,y,k,b,w;for(_=!0,e.keys.length||m("You're trying to bind a combo with no keys:",e),n=h=0,b=e.keys.length;b>=0?b>h:h>b;n=b>=0?++h:--h)o=e.keys[n],t=d[o],t&&(o=e.keys[n]=t),"meta"===o&&e.keys.splice(n,1,v),"cmd"===o&&m('Warning: use the "meta" key rather than "cmd" for Windows compatibility');for(w=e.keys,f=0,y=w.length;y>f;f++)o=w[f],a(o)||(m('Do not recognize the key "'+o+'"'),_=!1);if(q.call(e.keys,"meta")>=0||q.call(e.keys,"cmd")>=0){for(i=e.keys.slice(),p=0,k=g.length;k>p;p++)r=g[p],(n=l.call(i,r))>-1&&i.splice(n,1);i.length>1&&(m("META and CMD key combos cannot have more than 1 non-modifier keys",e,i),_=!1)}for(s in e)c=e[s],"undefined"===u[s]&&m("The property "+s+" is not a valid combo property. Your combo has still been registered.");return _},s=function(e,t){var n;return t.shiftKey?(n=y[e],null!=n?n:!1):!1},k={cmd:"metaKey",ctrl:"ctrlKey",shift:"shiftKey",alt:"altKey"},d={escape:"esc",control:"ctrl",command:"cmd","break":"pause",windows:"cmd",option:"alt",caps_lock:"caps",apostrophe:"'",semicolon:";",tilde:"~",accent:"`",scroll_lock:"scroll",num_lock:"num"},y={"/":"?",".":">",",":"<","'":'"',";":":","[":"{","]":"}","\\":"|","`":"~","=":"+","-":"_",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")"},p={0:"\\",8:"backspace",9:"tab",12:"num",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"caps",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",44:"print",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"cmd",92:"cmd",93:"cmd",96:"num_0",97:"num_1",98:"num_2",99:"num_3",100:"num_4",101:"num_5",102:"num_6",103:"num_7",104:"num_8",105:"num_9",106:"num_multiply",107:"num_add",108:"num_enter",109:"num_subtract",110:"num_decimal",111:"num_divide",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",124:"print",144:"num",145:"scroll",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"`",224:"cmd",225:"alt",57392:"ctrl",63289:"num",59:";",61:"=",173:"-"},t._keycode_dictionary=p,t._is_array_in_array_sorted=f,_(),n(),"function"==typeof define&&define.amd?define([],function(){return t}):"undefined"!=typeof exports&&null!==exports?exports.keypress=t:window.keypress=t}).call(this);
},{}],18:[function(require,module,exports){
(function (process,global){
!function(){function n(){}function t(n){return n}function e(n){return!!n}function r(n){return!n}function u(n){return function(){if(null===n)throw new Error("Callback was already called.");n.apply(this,arguments),n=null}}function i(n){return function(){null!==n&&(n.apply(this,arguments),n=null)}}function o(n){return M(n)||"number"==typeof n.length&&n.length>=0&&n.length%1===0}function c(n,t){for(var e=-1,r=n.length;++e<r;)t(n[e],e,n)}function a(n,t){for(var e=-1,r=n.length,u=Array(r);++e<r;)u[e]=t(n[e],e,n);return u}function f(n){return a(Array(n),function(n,t){return t})}function l(n,t,e){return c(n,function(n,r,u){e=t(e,n,r,u)}),e}function s(n,t){c(W(n),function(e){t(n[e],e)})}function p(n,t){for(var e=0;e<n.length;e++)if(n[e]===t)return e;return-1}function h(n){var t,e,r=-1;return o(n)?(t=n.length,function(){return r++,t>r?r:null}):(e=W(n),t=e.length,function(){return r++,t>r?e[r]:null})}function m(n,t){return t=null==t?n.length-1:+t,function(){for(var e=Math.max(arguments.length-t,0),r=Array(e),u=0;e>u;u++)r[u]=arguments[u+t];switch(t){case 0:return n.call(this,r);case 1:return n.call(this,arguments[0],r)}}}function y(n){return function(t,e,r){return n(t,r)}}function v(t){return function(e,r,o){o=i(o||n),e=e||[];var c=h(e);if(0>=t)return o(null);var a=!1,f=0,l=!1;!function s(){if(a&&0>=f)return o(null);for(;t>f&&!l;){var n=c();if(null===n)return a=!0,void(0>=f&&o(null));f+=1,r(e[n],n,u(function(n){f-=1,n?(o(n),l=!0):s()}))}}()}}function d(n){return function(t,e,r){return n(C.eachOf,t,e,r)}}function g(n){return function(t,e,r,u){return n(v(e),t,r,u)}}function k(n){return function(t,e,r){return n(C.eachOfSeries,t,e,r)}}function b(t,e,r,u){u=i(u||n),e=e||[];var c=o(e)?[]:{};t(e,function(n,t,e){r(n,function(n,r){c[t]=r,e(n)})},function(n){u(n,c)})}function w(n,t,e,r){var u=[];n(t,function(n,t,r){e(n,function(e){e&&u.push({index:t,value:n}),r()})},function(){r(a(u.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})}function O(n,t,e,r){w(n,t,function(n,t){e(n,function(n){t(!n)})},r)}function S(n,t,e){return function(r,u,i,o){function c(){o&&o(e(!1,void 0))}function a(n,r,u){return o?void i(n,function(r){o&&t(r)&&(o(e(!0,n)),o=i=!1),u()}):u()}arguments.length>3?n(r,u,a,c):(o=i,i=u,n(r,a,c))}}function E(n,t){return t}function L(t,e,r){r=r||n;var u=o(e)?[]:{};t(e,function(n,t,e){n(m(function(n,r){r.length<=1&&(r=r[0]),u[t]=r,e(n)}))},function(n){r(n,u)})}function I(n,t,e,r){var u=[];n(t,function(n,t,r){e(n,function(n,t){u=u.concat(t||[]),r(n)})},function(n){r(n,u)})}function x(t,e,r){function i(t,e,r,u){if(null!=u&&"function"!=typeof u)throw new Error("task callback must be a function");return t.started=!0,M(e)||(e=[e]),0===e.length&&t.idle()?C.setImmediate(function(){t.drain()}):(c(e,function(e){var i={data:e,callback:u||n};r?t.tasks.unshift(i):t.tasks.push(i),t.tasks.length===t.concurrency&&t.saturated()}),void C.setImmediate(t.process))}function o(n,t){return function(){f-=1;var e=!1,r=arguments;c(t,function(n){c(l,function(t,r){t!==n||e||(l.splice(r,1),e=!0)}),n.callback.apply(n,r)}),n.tasks.length+f===0&&n.drain(),n.process()}}if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var f=0,l=[],s={tasks:[],concurrency:e,payload:r,saturated:n,empty:n,drain:n,started:!1,paused:!1,push:function(n,t){i(s,n,!1,t)},kill:function(){s.drain=n,s.tasks=[]},unshift:function(n,t){i(s,n,!0,t)},process:function(){if(!s.paused&&f<s.concurrency&&s.tasks.length)for(;f<s.concurrency&&s.tasks.length;){var n=s.payload?s.tasks.splice(0,s.payload):s.tasks.splice(0,s.tasks.length),e=a(n,function(n){return n.data});0===s.tasks.length&&s.empty(),f+=1,l.push(n[0]);var r=u(o(s,n));t(e,r)}},length:function(){return s.tasks.length},running:function(){return f},workersList:function(){return l},idle:function(){return s.tasks.length+f===0},pause:function(){s.paused=!0},resume:function(){if(s.paused!==!1){s.paused=!1;for(var n=Math.min(s.concurrency,s.tasks.length),t=1;n>=t;t++)C.setImmediate(s.process)}}};return s}function j(n){return m(function(t,e){t.apply(null,e.concat([m(function(t,e){"object"==typeof console&&(t?console.error&&console.error(t):console[n]&&c(e,function(t){console[n](t)}))})]))})}function A(n){return function(t,e,r){n(f(t),e,r)}}function T(n){return m(function(t,e){var r=m(function(e){var r=this,u=e.pop();return n(t,function(n,t,u){n.apply(r,e.concat([u]))},u)});return e.length?r.apply(this,e):r})}function z(n){return m(function(t){var e=t.pop();t.push(function(){var n=arguments;r?C.setImmediate(function(){e.apply(null,n)}):e.apply(null,n)});var r=!0;n.apply(this,t),r=!1})}var q,C={},P="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this;null!=P&&(q=P.async),C.noConflict=function(){return P.async=q,C};var H=Object.prototype.toString,M=Array.isArray||function(n){return"[object Array]"===H.call(n)},U=function(n){var t=typeof n;return"function"===t||"object"===t&&!!n},W=Object.keys||function(n){var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t},B="function"==typeof setImmediate&&setImmediate,D=B?function(n){B(n)}:function(n){setTimeout(n,0)};"object"==typeof process&&"function"==typeof process.nextTick?C.nextTick=process.nextTick:C.nextTick=D,C.setImmediate=B?D:C.nextTick,C.forEach=C.each=function(n,t,e){return C.eachOf(n,y(t),e)},C.forEachSeries=C.eachSeries=function(n,t,e){return C.eachOfSeries(n,y(t),e)},C.forEachLimit=C.eachLimit=function(n,t,e,r){return v(t)(n,y(e),r)},C.forEachOf=C.eachOf=function(t,e,r){function o(n){f--,n?r(n):null===c&&0>=f&&r(null)}r=i(r||n),t=t||[];for(var c,a=h(t),f=0;null!=(c=a());)f+=1,e(t[c],c,u(o));0===f&&r(null)},C.forEachOfSeries=C.eachOfSeries=function(t,e,r){function o(){var n=!0;return null===a?r(null):(e(t[a],a,u(function(t){if(t)r(t);else{if(a=c(),null===a)return r(null);n?C.setImmediate(o):o()}})),void(n=!1))}r=i(r||n),t=t||[];var c=h(t),a=c();o()},C.forEachOfLimit=C.eachOfLimit=function(n,t,e,r){v(t)(n,e,r)},C.map=d(b),C.mapSeries=k(b),C.mapLimit=g(b),C.inject=C.foldl=C.reduce=function(n,t,e,r){C.eachOfSeries(n,function(n,r,u){e(t,n,function(n,e){t=e,u(n)})},function(n){r(n,t)})},C.foldr=C.reduceRight=function(n,e,r,u){var i=a(n,t).reverse();C.reduce(i,e,r,u)},C.transform=function(n,t,e,r){3===arguments.length&&(r=e,e=t,t=M(n)?[]:{}),C.eachOf(n,function(n,r,u){e(t,n,r,u)},function(n){r(n,t)})},C.select=C.filter=d(w),C.selectLimit=C.filterLimit=g(w),C.selectSeries=C.filterSeries=k(w),C.reject=d(O),C.rejectLimit=g(O),C.rejectSeries=k(O),C.any=C.some=S(C.eachOf,e,t),C.someLimit=S(C.eachOfLimit,e,t),C.all=C.every=S(C.eachOf,r,r),C.everyLimit=S(C.eachOfLimit,r,r),C.detect=S(C.eachOf,t,E),C.detectSeries=S(C.eachOfSeries,t,E),C.detectLimit=S(C.eachOfLimit,t,E),C.sortBy=function(n,t,e){function r(n,t){var e=n.criteria,r=t.criteria;return r>e?-1:e>r?1:0}C.map(n,function(n,e){t(n,function(t,r){t?e(t):e(null,{value:n,criteria:r})})},function(n,t){return n?e(n):void e(null,a(t.sort(r),function(n){return n.value}))})},C.auto=function(t,e,r){function u(n){d.unshift(n)}function o(n){var t=p(d,n);t>=0&&d.splice(t,1)}function a(){h--,c(d.slice(0),function(n){n()})}r||(r=e,e=null),r=i(r||n);var f=W(t),h=f.length;if(!h)return r(null);e||(e=h);var y={},v=0,d=[];u(function(){h||r(null,y)}),c(f,function(n){function i(){return e>v&&l(g,function(n,t){return n&&y.hasOwnProperty(t)},!0)&&!y.hasOwnProperty(n)}function c(){i()&&(v++,o(c),h[h.length-1](d,y))}for(var f,h=M(t[n])?t[n]:[t[n]],d=m(function(t,e){if(v--,e.length<=1&&(e=e[0]),t){var u={};s(y,function(n,t){u[t]=n}),u[n]=e,r(t,u)}else y[n]=e,C.setImmediate(a)}),g=h.slice(0,h.length-1),k=g.length;k--;){if(!(f=t[g[k]]))throw new Error("Has inexistant dependency");if(M(f)&&p(f,n)>=0)throw new Error("Has cyclic dependencies")}i()?(v++,h[h.length-1](d,y)):u(c)})},C.retry=function(n,t,e){function r(n,t){if("number"==typeof t)n.times=parseInt(t,10)||i;else{if("object"!=typeof t)throw new Error("Unsupported argument type for 'times': "+typeof t);n.times=parseInt(t.times,10)||i,n.interval=parseInt(t.interval,10)||o}}function u(n,t){function e(n,e){return function(r){n(function(n,t){r(!n||e,{err:n,result:t})},t)}}function r(n){return function(t){setTimeout(function(){t(null)},n)}}for(;a.times;){var u=!(a.times-=1);c.push(e(a.task,u)),!u&&a.interval>0&&c.push(r(a.interval))}C.series(c,function(t,e){e=e[e.length-1],(n||a.callback)(e.err,e.result)})}var i=5,o=0,c=[],a={times:i,interval:o},f=arguments.length;if(1>f||f>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");return 2>=f&&"function"==typeof n&&(e=t,t=n),"function"!=typeof n&&r(a,n),a.callback=e,a.task=t,a.callback?u():u},C.waterfall=function(t,e){function r(n){return m(function(t,u){if(t)e.apply(null,[t].concat(u));else{var i=n.next();i?u.push(r(i)):u.push(e),z(n).apply(null,u)}})}if(e=i(e||n),!M(t)){var u=new Error("First argument to waterfall must be an array of functions");return e(u)}return t.length?void r(C.iterator(t))():e()},C.parallel=function(n,t){L(C.eachOf,n,t)},C.parallelLimit=function(n,t,e){L(v(t),n,e)},C.series=function(n,t){L(C.eachOfSeries,n,t)},C.iterator=function(n){function t(e){function r(){return n.length&&n[e].apply(null,arguments),r.next()}return r.next=function(){return e<n.length-1?t(e+1):null},r}return t(0)},C.apply=m(function(n,t){return m(function(e){return n.apply(null,t.concat(e))})}),C.concat=d(I),C.concatSeries=k(I),C.whilst=function(t,e,r){if(r=r||n,t()){var u=m(function(n,i){n?r(n):t.apply(this,i)?e(u):r(null)});e(u)}else r(null)},C.doWhilst=function(n,t,e){var r=0;return C.whilst(function(){return++r<=1||t.apply(this,arguments)},n,e)},C.until=function(n,t,e){return C.whilst(function(){return!n.apply(this,arguments)},t,e)},C.doUntil=function(n,t,e){return C.doWhilst(n,function(){return!t.apply(this,arguments)},e)},C.during=function(t,e,r){r=r||n;var u=m(function(n,e){n?r(n):(e.push(i),t.apply(this,e))}),i=function(n,t){n?r(n):t?e(u):r(null)};t(i)},C.doDuring=function(n,t,e){var r=0;C.during(function(n){r++<1?n(null,!0):t.apply(this,arguments)},n,e)},C.queue=function(n,t){var e=x(function(t,e){n(t[0],e)},t,1);return e},C.priorityQueue=function(t,e){function r(n,t){return n.priority-t.priority}function u(n,t,e){for(var r=-1,u=n.length-1;u>r;){var i=r+(u-r+1>>>1);e(t,n[i])>=0?r=i:u=i-1}return r}function i(t,e,i,o){if(null!=o&&"function"!=typeof o)throw new Error("task callback must be a function");return t.started=!0,M(e)||(e=[e]),0===e.length?C.setImmediate(function(){t.drain()}):void c(e,function(e){var c={data:e,priority:i,callback:"function"==typeof o?o:n};t.tasks.splice(u(t.tasks,c,r)+1,0,c),t.tasks.length===t.concurrency&&t.saturated(),C.setImmediate(t.process)})}var o=C.queue(t,e);return o.push=function(n,t,e){i(o,n,t,e)},delete o.unshift,o},C.cargo=function(n,t){return x(n,1,t)},C.log=j("log"),C.dir=j("dir"),C.memoize=function(n,e){var r={},u={};e=e||t;var i=m(function(t){var i=t.pop(),o=e.apply(null,t);o in r?C.setImmediate(function(){i.apply(null,r[o])}):o in u?u[o].push(i):(u[o]=[i],n.apply(null,t.concat([m(function(n){r[o]=n;var t=u[o];delete u[o];for(var e=0,i=t.length;i>e;e++)t[e].apply(null,n)})])))});return i.memo=r,i.unmemoized=n,i},C.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}},C.times=A(C.map),C.timesSeries=A(C.mapSeries),C.timesLimit=function(n,t,e,r){return C.mapLimit(f(n),t,e,r)},C.seq=function(){var t=arguments;return m(function(e){var r=this,u=e[e.length-1];"function"==typeof u?e.pop():u=n,C.reduce(t,e,function(n,t,e){t.apply(r,n.concat([m(function(n,t){e(n,t)})]))},function(n,t){u.apply(r,[n].concat(t))})})},C.compose=function(){return C.seq.apply(null,Array.prototype.reverse.call(arguments))},C.applyEach=T(C.eachOf),C.applyEachSeries=T(C.eachOfSeries),C.forever=function(t,e){function r(n){return n?i(n):void o(r)}var i=u(e||n),o=z(t);r()},C.ensureAsync=z,C.constant=m(function(n){var t=[null].concat(n);return function(n){return n.apply(this,t)}}),C.wrapSync=C.asyncify=function(n){return m(function(t){var e,r=t.pop();try{e=n.apply(this,t)}catch(u){return r(u)}U(e)&&"function"==typeof e.then?e.then(function(n){r(null,n)})["catch"](function(n){r(n.message?n:new Error(n))}):r(null,e)})},"object"==typeof module&&module.exports?module.exports=C:"function"==typeof define&&define.amd?define([],function(){return C}):P.async=C}();
}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"_process":2}],19:[function(require,module,exports){
"use strict";function earcut(e,n,t){t=t||2;var r=n&&n.length,i=r?n[0]*t:e.length,x=filterPoints(linkedList(e,0,i,t,!0)),o=[];if(!x)return o;var l,a,u,s,v,f,y;if(r&&(x=eliminateHoles(e,n,x,t)),e.length>80*t){l=u=e[0],a=s=e[1];for(var p=t;i>p;p+=t)v=e[p],f=e[p+1],l>v&&(l=v),a>f&&(a=f),v>u&&(u=v),f>s&&(s=f);y=Math.max(u-l,s-a)}return earcutLinked(x,o,t,l,a,y),o}function linkedList(e,n,t,r,i){var x,o,l,a=0;for(x=n,o=t-r;t>x;x+=r)a+=(e[o]-e[x])*(e[x+1]+e[o+1]),o=x;if(i===a>0)for(x=n;t>x;x+=r)l=insertNode(x,e[x],e[x+1],l);else for(x=t-r;x>=n;x-=r)l=insertNode(x,e[x],e[x+1],l);return l}function filterPoints(e,n){if(!e)return e;n||(n=e);var t,r=e;do if(t=!1,r.steiner||!equals(r,r.next)&&0!==area(r.prev,r,r.next))r=r.next;else{if(removeNode(r),r=n=r.prev,r===r.next)return null;t=!0}while(t||r!==n);return n}function earcutLinked(e,n,t,r,i,x,o){if(e){!o&&x&&indexCurve(e,r,i,x);for(var l,a,u=e;e.prev!==e.next;)if(l=e.prev,a=e.next,x?isEarHashed(e,r,i,x):isEar(e))n.push(l.i/t),n.push(e.i/t),n.push(a.i/t),removeNode(e),e=a.next,u=a.next;else if(e=a,e===u){o?1===o?(e=cureLocalIntersections(e,n,t),earcutLinked(e,n,t,r,i,x,2)):2===o&&splitEarcut(e,n,t,r,i,x):earcutLinked(filterPoints(e),n,t,r,i,x,1);break}}}function isEar(e){var n=e.prev,t=e,r=e.next;if(area(n,t,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(pointInTriangle(n.x,n.y,t.x,t.y,r.x,r.y,i.x,i.y)&&area(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function isEarHashed(e,n,t,r){var i=e.prev,x=e,o=e.next;if(area(i,x,o)>=0)return!1;for(var l=i.x<x.x?i.x<o.x?i.x:o.x:x.x<o.x?x.x:o.x,a=i.y<x.y?i.y<o.y?i.y:o.y:x.y<o.y?x.y:o.y,u=i.x>x.x?i.x>o.x?i.x:o.x:x.x>o.x?x.x:o.x,s=i.y>x.y?i.y>o.y?i.y:o.y:x.y>o.y?x.y:o.y,v=zOrder(l,a,n,t,r),f=zOrder(u,s,n,t,r),y=e.nextZ;y&&y.z<=f;){if(y!==e.prev&&y!==e.next&&pointInTriangle(i.x,i.y,x.x,x.y,o.x,o.y,y.x,y.y)&&area(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(y=e.prevZ;y&&y.z>=v;){if(y!==e.prev&&y!==e.next&&pointInTriangle(i.x,i.y,x.x,x.y,o.x,o.y,y.x,y.y)&&area(y.prev,y,y.next)>=0)return!1;y=y.prevZ}return!0}function cureLocalIntersections(e,n,t){var r=e;do{var i=r.prev,x=r.next.next;intersects(i,r,r.next,x)&&locallyInside(i,x)&&locallyInside(x,i)&&(n.push(i.i/t),n.push(r.i/t),n.push(x.i/t),removeNode(r),removeNode(r.next),r=e=x),r=r.next}while(r!==e);return r}function splitEarcut(e,n,t,r,i,x){var o=e;do{for(var l=o.next.next;l!==o.prev;){if(o.i!==l.i&&isValidDiagonal(o,l)){var a=splitPolygon(o,l);return o=filterPoints(o,o.next),a=filterPoints(a,a.next),earcutLinked(o,n,t,r,i,x),void earcutLinked(a,n,t,r,i,x)}l=l.next}o=o.next}while(o!==e)}function eliminateHoles(e,n,t,r){var i,x,o,l,a,u=[];for(i=0,x=n.length;x>i;i++)o=n[i]*r,l=x-1>i?n[i+1]*r:e.length,a=linkedList(e,o,l,r,!1),a===a.next&&(a.steiner=!0),a=filterPoints(a),a&&u.push(getLeftmost(a));for(u.sort(compareX),i=0;i<u.length;i++)eliminateHole(u[i],t),t=filterPoints(t,t.next);return t}function compareX(e,n){return e.x-n.x}function eliminateHole(e,n){if(n=findHoleBridge(e,n)){var t=splitPolygon(n,e);filterPoints(t,t.next)}}function findHoleBridge(e,n){var t,r=n,i=e.x,x=e.y,o=-(1/0);do{if(x<=r.y&&x>=r.next.y){var l=r.x+(x-r.y)*(r.next.x-r.x)/(r.next.y-r.y);i>=l&&l>o&&(o=l,t=r.x<r.next.x?r:r.next)}r=r.next}while(r!==n);if(!t)return null;var a,u=t,s=1/0;for(r=t.next;r!==u;)i>=r.x&&r.x>=t.x&&pointInTriangle(x<t.y?i:o,x,t.x,t.y,x<t.y?o:i,x,r.x,r.y)&&(a=Math.abs(x-r.y)/(i-r.x),(s>a||a===s&&r.x>t.x)&&locallyInside(r,e)&&(t=r,s=a)),r=r.next;return t}function indexCurve(e,n,t,r){var i=e;do null===i.z&&(i.z=zOrder(i.x,i.y,n,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,sortLinked(i)}function sortLinked(e){var n,t,r,i,x,o,l,a,u=1;do{for(t=e,e=null,x=null,o=0;t;){for(o++,r=t,l=0,n=0;u>n&&(l++,r=r.nextZ,r);n++);for(a=u;l>0||a>0&&r;)0===l?(i=r,r=r.nextZ,a--):0!==a&&r?t.z<=r.z?(i=t,t=t.nextZ,l--):(i=r,r=r.nextZ,a--):(i=t,t=t.nextZ,l--),x?x.nextZ=i:e=i,i.prevZ=x,x=i;t=r}x.nextZ=null,u*=2}while(o>1);return e}function zOrder(e,n,t,r,i){return e=32767*(e-t)/i,n=32767*(n-r)/i,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),n=16711935&(n|n<<8),n=252645135&(n|n<<4),n=858993459&(n|n<<2),n=1431655765&(n|n<<1),e|n<<1}function getLeftmost(e){var n=e,t=e;do n.x<t.x&&(t=n),n=n.next;while(n!==e);return t}function pointInTriangle(e,n,t,r,i,x,o,l){return(i-o)*(n-l)-(e-o)*(x-l)>=0&&(e-o)*(r-l)-(t-o)*(n-l)>=0&&(t-o)*(x-l)-(i-o)*(r-l)>=0}function isValidDiagonal(e,n){return equals(e,n)||e.next.i!==n.i&&e.prev.i!==n.i&&!intersectsPolygon(e,n)&&locallyInside(e,n)&&locallyInside(n,e)&&middleInside(e,n)}function area(e,n,t){return(n.y-e.y)*(t.x-n.x)-(n.x-e.x)*(t.y-n.y)}function equals(e,n){return e.x===n.x&&e.y===n.y}function intersects(e,n,t,r){return area(e,n,t)>0!=area(e,n,r)>0&&area(t,r,e)>0!=area(t,r,n)>0}function intersectsPolygon(e,n){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==n.i&&t.next.i!==n.i&&intersects(t,t.next,e,n))return!0;t=t.next}while(t!==e);return!1}function locallyInside(e,n){return area(e.prev,e,e.next)<0?area(e,n,e.next)>=0&&area(e,e.prev,n)>=0:area(e,n,e.prev)<0||area(e,e.next,n)<0}function middleInside(e,n){var t=e,r=!1,i=(e.x+n.x)/2,x=(e.y+n.y)/2;do t.y>x!=t.next.y>x&&i<(t.next.x-t.x)*(x-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==e);return r}function splitPolygon(e,n){var t=new Node(e.i,e.x,e.y),r=new Node(n.i,n.x,n.y),i=e.next,x=n.prev;return e.next=n,n.prev=e,t.next=i,i.prev=t,r.next=t,t.prev=r,x.next=r,r.prev=x,r}function insertNode(e,n,t,r){var i=new Node(e,n,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function removeNode(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Node(e,n,t){this.i=e,this.x=n,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}module.exports=earcut;
},{}],20:[function(require,module,exports){
"use strict";function EE(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function EventEmitter(){}var prefix="function"!=typeof Object.create?"~":!1;EventEmitter.prototype._events=void 0,EventEmitter.prototype.listeners=function(e,t){var n=prefix?prefix+e:e,r=this._events&&this._events[n];if(t)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,o=new Array(s);s>i;i++)o[i]=r[i].fn;return o},EventEmitter.prototype.emit=function(e,t,n,r,i,s){var o=prefix?prefix+e:e;if(!this._events||!this._events[o])return!1;var f,v,c=this._events[o],h=arguments.length;if("function"==typeof c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,r),!0;case 5:return c.fn.call(c.context,t,n,r,i),!0;case 6:return c.fn.call(c.context,t,n,r,i,s),!0}for(v=1,f=new Array(h-1);h>v;v++)f[v-1]=arguments[v];c.fn.apply(c.context,f)}else{var p,a=c.length;for(v=0;a>v;v++)switch(c[v].once&&this.removeListener(e,c[v].fn,void 0,!0),h){case 1:c[v].fn.call(c[v].context);break;case 2:c[v].fn.call(c[v].context,t);break;case 3:c[v].fn.call(c[v].context,t,n);break;default:if(!f)for(p=1,f=new Array(h-1);h>p;p++)f[p-1]=arguments[p];c[v].fn.apply(c[v].context,f)}}return!0},EventEmitter.prototype.on=function(e,t,n){var r=new EE(t,n||this),i=prefix?prefix+e:e;return this._events||(this._events=prefix?{}:Object.create(null)),this._events[i]?this._events[i].fn?this._events[i]=[this._events[i],r]:this._events[i].push(r):this._events[i]=r,this},EventEmitter.prototype.once=function(e,t,n){var r=new EE(t,n||this,!0),i=prefix?prefix+e:e;return this._events||(this._events=prefix?{}:Object.create(null)),this._events[i]?this._events[i].fn?this._events[i]=[this._events[i],r]:this._events[i].push(r):this._events[i]=r,this},EventEmitter.prototype.removeListener=function(e,t,n,r){var i=prefix?prefix+e:e;if(!this._events||!this._events[i])return this;var s=this._events[i],o=[];if(t)if(s.fn)(s.fn!==t||r&&!s.once||n&&s.context!==n)&&o.push(s);else for(var f=0,v=s.length;v>f;f++)(s[f].fn!==t||r&&!s[f].once||n&&s[f].context!==n)&&o.push(s[f]);return o.length?this._events[i]=1===o.length?o[0]:o:delete this._events[i],this},EventEmitter.prototype.removeAllListeners=function(e){return this._events?(e?delete this._events[prefix?prefix+e:e]:this._events=prefix?{}:Object.create(null),this):this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prototype.setMaxListeners=function(){return this},EventEmitter.prefixed=prefix,"undefined"!=typeof module&&(module.exports=EventEmitter);
},{}],21:[function(require,module,exports){
"use strict";function toObject(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;module.exports=Object.assign||function(e,r){for(var t,n,o=toObject(e),a=1;a<arguments.length;a++){t=Object(arguments[a]);for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);if(Object.getOwnPropertySymbols){n=Object.getOwnPropertySymbols(t);for(var c=0;c<n.length;c++)propIsEnumerable.call(t,n[c])&&(o[n[c]]=t[n[c]])}}return o};
},{}],22:[function(require,module,exports){
(function (process){
!function(){function n(n){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,n.apply(t,arguments)}}var t,e,r={};t=this,null!=t&&(e=t.async),r.noConflict=function(){return t.async=e,r};var u=Object.prototype.toString,i=Array.isArray||function(n){return"[object Array]"===u.call(n)},c=function(n,t){for(var e=0;e<n.length;e+=1)t(n[e],e,n)},a=function(n,t){if(n.map)return n.map(t);var e=[];return c(n,function(n,r,u){e.push(t(n,r,u))}),e},o=function(n,t,e){return n.reduce?n.reduce(t,e):(c(n,function(n,r,u){e=t(e,n,r,u)}),e)},l=function(n){if(Object.keys)return Object.keys(n);var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t};"undefined"!=typeof process&&process.nextTick?(r.nextTick=process.nextTick,"undefined"!=typeof setImmediate?r.setImmediate=function(n){setImmediate(n)}:r.setImmediate=r.nextTick):"function"==typeof setImmediate?(r.nextTick=function(n){setImmediate(n)},r.setImmediate=r.nextTick):(r.nextTick=function(n){setTimeout(n,0)},r.setImmediate=r.nextTick),r.each=function(t,e,r){function u(n){n?(r(n),r=function(){}):(i+=1,i>=t.length&&r())}if(r=r||function(){},!t.length)return r();var i=0;c(t,function(t){e(t,n(u))})},r.forEach=r.each,r.eachSeries=function(n,t,e){if(e=e||function(){},!n.length)return e();var r=0,u=function(){t(n[r],function(t){t?(e(t),e=function(){}):(r+=1,r>=n.length?e():u())})};u()},r.forEachSeries=r.eachSeries,r.eachLimit=function(n,t,e,r){var u=f(t);u.apply(null,[n,e,r])},r.forEachLimit=r.eachLimit;var f=function(n){return function(t,e,r){if(r=r||function(){},!t.length||0>=n)return r();var u=0,i=0,c=0;!function a(){if(u>=t.length)return r();for(;n>c&&i<t.length;)i+=1,c+=1,e(t[i-1],function(n){n?(r(n),r=function(){}):(u+=1,c-=1,u>=t.length?r():a())})}()}},s=function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(null,[r.each].concat(t))}},p=function(n,t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[f(n)].concat(e))}},d=function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(null,[r.eachSeries].concat(t))}},y=function(n,t,e,r){if(t=a(t,function(n,t){return{index:t,value:n}}),r){var u=[];n(t,function(n,t){e(n.value,function(e,r){u[n.index]=r,t(e)})},function(n){r(n,u)})}else n(t,function(n,t){e(n.value,function(n){t(n)})})};r.map=s(y),r.mapSeries=d(y),r.mapLimit=function(n,t,e,r){return m(t)(n,e,r)};var m=function(n){return p(n,y)};r.reduce=function(n,t,e,u){r.eachSeries(n,function(n,r){e(t,n,function(n,e){t=e,r(n)})},function(n){u(n,t)})},r.inject=r.reduce,r.foldl=r.reduce,r.reduceRight=function(n,t,e,u){var i=a(n,function(n){return n}).reverse();r.reduce(i,t,e,u)},r.foldr=r.reduceRight;var v=function(n,t,e,r){var u=[];t=a(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e){e&&u.push(n),t()})},function(n){r(a(u.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})};r.filter=s(v),r.filterSeries=d(v),r.select=r.filter,r.selectSeries=r.filterSeries;var h=function(n,t,e,r){var u=[];t=a(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e){e||u.push(n),t()})},function(n){r(a(u.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})};r.reject=s(h),r.rejectSeries=d(h);var g=function(n,t,e,r){n(t,function(n,t){e(n,function(e){e?(r(n),r=function(){}):t()})},function(n){r()})};r.detect=s(g),r.detectSeries=d(g),r.some=function(n,t,e){r.each(n,function(n,r){t(n,function(n){n&&(e(!0),e=function(){}),r()})},function(n){e(!1)})},r.any=r.some,r.every=function(n,t,e){r.each(n,function(n,r){t(n,function(n){n||(e(!1),e=function(){}),r()})},function(n){e(!0)})},r.all=r.every,r.sortBy=function(n,t,e){r.map(n,function(n,e){t(n,function(t,r){t?e(t):e(null,{value:n,criteria:r})})},function(n,t){if(n)return e(n);var r=function(n,t){var e=n.criteria,r=t.criteria;return r>e?-1:e>r?1:0};e(null,a(t.sort(r),function(n){return n.value}))})},r.auto=function(n,t){t=t||function(){};var e=l(n),u=e.length;if(!u)return t();var a={},f=[],s=function(n){f.unshift(n)},p=function(n){for(var t=0;t<f.length;t+=1)if(f[t]===n)return void f.splice(t,1)},d=function(){u--,c(f.slice(0),function(n){n()})};s(function(){if(!u){var n=t;t=function(){},n(null,a)}}),c(e,function(e){var u=i(n[e])?n[e]:[n[e]],f=function(n){var u=Array.prototype.slice.call(arguments,1);if(u.length<=1&&(u=u[0]),n){var i={};c(l(a),function(n){i[n]=a[n]}),i[e]=u,t(n,i),t=function(){}}else a[e]=u,r.setImmediate(d)},y=u.slice(0,Math.abs(u.length-1))||[],m=function(){return o(y,function(n,t){return n&&a.hasOwnProperty(t)},!0)&&!a.hasOwnProperty(e)};if(m())u[u.length-1](f,a);else{var v=function(){m()&&(p(v),u[u.length-1](f,a))};s(v)}})},r.retry=function(n,t,e){var u=5,i=[];"function"==typeof n&&(e=t,t=n,n=u),n=parseInt(n,10)||u;var c=function(u,c){for(var a=function(n,t){return function(e){n(function(n,r){e(!n||t,{err:n,result:r})},c)}};n;)i.push(a(t,!(n-=1)));r.series(i,function(n,t){t=t[t.length-1],(u||e)(t.err,t.result)})};return e?c():c},r.waterfall=function(n,t){if(t=t||function(){},!i(n)){var e=new Error("First argument to waterfall must be an array of functions");return t(e)}if(!n.length)return t();var u=function(n){return function(e){if(e)t.apply(null,arguments),t=function(){};else{var i=Array.prototype.slice.call(arguments,1),c=n.next();c?i.push(u(c)):i.push(t),r.setImmediate(function(){n.apply(null,i)})}}};u(r.iterator(n))()};var k=function(n,t,e){if(e=e||function(){},i(t))n.map(t,function(n,t){n&&n(function(n){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),t.call(null,n,e)})},e);else{var r={};n.each(l(t),function(n,e){t[n](function(t){var u=Array.prototype.slice.call(arguments,1);u.length<=1&&(u=u[0]),r[n]=u,e(t)})},function(n){e(n,r)})}};r.parallel=function(n,t){k({map:r.map,each:r.each},n,t)},r.parallelLimit=function(n,t,e){k({map:m(t),each:f(t)},n,e)},r.series=function(n,t){if(t=t||function(){},i(n))r.mapSeries(n,function(n,t){n&&n(function(n){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),t.call(null,n,e)})},t);else{var e={};r.eachSeries(l(n),function(t,r){n[t](function(n){var u=Array.prototype.slice.call(arguments,1);u.length<=1&&(u=u[0]),e[t]=u,r(n)})},function(n){t(n,e)})}},r.iterator=function(n){var t=function(e){var r=function(){return n.length&&n[e].apply(null,arguments),r.next()};return r.next=function(){return e<n.length-1?t(e+1):null},r};return t(0)},r.apply=function(n){var t=Array.prototype.slice.call(arguments,1);return function(){return n.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var A=function(n,t,e,r){var u=[];n(t,function(n,t){e(n,function(n,e){u=u.concat(e||[]),t(n)})},function(n){r(n,u)})};r.concat=s(A),r.concatSeries=d(A),r.whilst=function(n,t,e){n()?t(function(u){return u?e(u):void r.whilst(n,t,e)}):e()},r.doWhilst=function(n,t,e){n(function(u){if(u)return e(u);var i=Array.prototype.slice.call(arguments,1);t.apply(null,i)?r.doWhilst(n,t,e):e()})},r.until=function(n,t,e){n()?e():t(function(u){return u?e(u):void r.until(n,t,e)})},r.doUntil=function(n,t,e){n(function(u){if(u)return e(u);var i=Array.prototype.slice.call(arguments,1);t.apply(null,i)?e():r.doUntil(n,t,e)})},r.queue=function(t,e){function u(n,t,e,u){return n.started||(n.started=!0),i(t)||(t=[t]),0==t.length?r.setImmediate(function(){n.drain&&n.drain()}):void c(t,function(t){var i={data:t,callback:"function"==typeof u?u:null};e?n.tasks.unshift(i):n.tasks.push(i),n.saturated&&n.tasks.length===n.concurrency&&n.saturated(),r.setImmediate(n.process)})}void 0===e&&(e=1);var a=0,o={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(n,t){u(o,n,!1,t)},kill:function(){o.drain=null,o.tasks=[]},unshift:function(n,t){u(o,n,!0,t)},process:function(){if(!o.paused&&a<o.concurrency&&o.tasks.length){var e=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),a+=1;var r=function(){a-=1,e.callback&&e.callback.apply(e,arguments),o.drain&&o.tasks.length+a===0&&o.drain(),o.process()},u=n(r);t(e.data,u)}},length:function(){return o.tasks.length},running:function(){return a},idle:function(){return o.tasks.length+a===0},pause:function(){o.paused!==!0&&(o.paused=!0)},resume:function(){if(o.paused!==!1){o.paused=!1;for(var n=1;n<=o.concurrency;n++)r.setImmediate(o.process)}}};return o},r.priorityQueue=function(n,t){function e(n,t){return n.priority-t.priority}function u(n,t,e){for(var r=-1,u=n.length-1;u>r;){var i=r+(u-r+1>>>1);e(t,n[i])>=0?r=i:u=i-1}return r}function a(n,t,a,o){return n.started||(n.started=!0),i(t)||(t=[t]),0==t.length?r.setImmediate(function(){n.drain&&n.drain()}):void c(t,function(t){var i={data:t,priority:a,callback:"function"==typeof o?o:null};n.tasks.splice(u(n.tasks,i,e)+1,0,i),n.saturated&&n.tasks.length===n.concurrency&&n.saturated(),r.setImmediate(n.process)})}var o=r.queue(n,t);return o.push=function(n,t,e){a(o,n,t,e)},delete o.unshift,o},r.cargo=function(n,t){var e=!1,u=[],o={tasks:u,payload:t,saturated:null,empty:null,drain:null,drained:!0,push:function(n,e){i(n)||(n=[n]),c(n,function(n){u.push({data:n,callback:"function"==typeof e?e:null}),o.drained=!1,o.saturated&&u.length===t&&o.saturated()}),r.setImmediate(o.process)},process:function l(){if(!e){if(0===u.length)return o.drain&&!o.drained&&o.drain(),void(o.drained=!0);var r="number"==typeof t?u.splice(0,t):u.splice(0,u.length),i=a(r,function(n){return n.data});o.empty&&o.empty(),e=!0,n(i,function(){e=!1;var n=arguments;c(r,function(t){t.callback&&t.callback.apply(null,n)}),l()})}},length:function(){return u.length},running:function(){return e}};return o};var x=function(n){return function(t){var e=Array.prototype.slice.call(arguments,1);t.apply(null,e.concat([function(t){var e=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[n]&&c(e,function(t){console[n](t)}))}]))}};r.log=x("log"),r.dir=x("dir"),r.memoize=function(n,t){var e={},u={};t=t||function(n){return n};var i=function(){var i=Array.prototype.slice.call(arguments),c=i.pop(),a=t.apply(null,i);a in e?r.nextTick(function(){c.apply(null,e[a])}):a in u?u[a].push(c):(u[a]=[c],n.apply(null,i.concat([function(){e[a]=arguments;var n=u[a];delete u[a];for(var t=0,r=n.length;r>t;t++)n[t].apply(null,arguments)}])))};return i.memo=e,i.unmemoized=n,i},r.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}},r.times=function(n,t,e){for(var u=[],i=0;n>i;i++)u.push(i);return r.map(u,t,e)},r.timesSeries=function(n,t,e){for(var u=[],i=0;n>i;i++)u.push(i);return r.mapSeries(u,t,e)},r.seq=function(){var n=arguments;return function(){var t=this,e=Array.prototype.slice.call(arguments),u=e.pop();r.reduce(n,e,function(n,e,r){e.apply(t,n.concat([function(){var n=arguments[0],t=Array.prototype.slice.call(arguments,1);r(n,t)}]))},function(n,e){u.apply(t,[n].concat(e))})}},r.compose=function(){return r.seq.apply(null,Array.prototype.reverse.call(arguments))};var S=function(n,t){var e=function(){var e=this,r=Array.prototype.slice.call(arguments),u=r.pop();return n(t,function(n,t){n.apply(e,r.concat([t]))},u)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return e.apply(this,r)}return e};r.applyEach=s(S),r.applyEachSeries=d(S),r.forever=function(n,t){function e(r){if(r){if(t)return t(r);throw r}n(e)}e()},"undefined"!=typeof module&&module.exports?module.exports=r:"undefined"!=typeof define&&define.amd?define([],function(){return r}):t.async=r}();
}).call(this,require('_process'))

},{"_process":2}],23:[function(require,module,exports){
function Loader(e,t){EventEmitter.call(this),t=t||10,this.baseUrl=e||"",this.progress=0,this.loading=!1,this._progressChunk=0,this._beforeMiddleware=[],this._afterMiddleware=[],this._boundLoadResource=this._loadResource.bind(this),this._boundOnLoad=this._onLoad.bind(this),this._buffer=[],this._numToLoad=0,this._queue=async.queue(this._boundLoadResource,t),this.resources={}}var async=require("async"),urlParser=require("url"),Resource=require("./Resource"),EventEmitter=require("eventemitter3");Loader.prototype=Object.create(EventEmitter.prototype),Loader.prototype.constructor=Loader,module.exports=Loader,Loader.prototype.add=Loader.prototype.enqueue=function(e,t,r,s){if(Array.isArray(e)){for(var o=0;o<e.length;++o)this.add(e[o]);return this}if("object"==typeof e&&(s=t||e.callback||e.onComplete,r=e,t=e.url,e=e.name||e.key||e.url),"string"!=typeof t&&(s=r,r=t,t=e),"string"!=typeof t)throw new Error("No url passed to add resource to loader.");if("function"==typeof r&&(s=r,r=null),this.resources[e])throw new Error('Resource with name "'+e+'" already exists.');return t=this._handleBaseUrl(t),this.resources[e]=new Resource(e,t,r),"function"==typeof s&&this.resources[e].once("afterMiddleware",s),this._numToLoad++,this._queue.started?(this._queue.push(this.resources[e]),this._progressChunk=(100-this.progress)/(this._queue.length()+this._queue.running())):(this._buffer.push(this.resources[e]),this._progressChunk=100/this._buffer.length),this},Loader.prototype._handleBaseUrl=function(e){var t=urlParser.parse(e);return t.protocol||0===t.pathname.indexOf("//")?e:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&e.lastIndexOf("/")!==e.length-1?this.baseUrl+"/"+e:this.baseUrl+e},Loader.prototype.before=Loader.prototype.pre=function(e){return this._beforeMiddleware.push(e),this},Loader.prototype.after=Loader.prototype.use=function(e){return this._afterMiddleware.push(e),this},Loader.prototype.reset=function(){this.progress=0,this.loading=!1,this._progressChunk=0,this._buffer.length=0,this._numToLoad=0,this._queue.kill(),this._queue.started=!1,this.resources={}},Loader.prototype.load=function(e){if("function"==typeof e&&this.once("complete",e),this._queue.started)return this;this.emit("start",this);for(var t=0;t<this._buffer.length;++t)this._queue.push(this._buffer[t]);return this._buffer.length=0,this},Loader.prototype._loadResource=function(e,t){var r=this;e._dequeue=t,this._runMiddleware(e,this._beforeMiddleware,function(){e.load(r._boundOnLoad)})},Loader.prototype._onComplete=function(){this.emit("complete",this,this.resources)},Loader.prototype._onLoad=function(e){this.progress+=this._progressChunk,this.emit("progress",this,e),this._runMiddleware(e,this._afterMiddleware,function(){e.emit("afterMiddleware",e),this._numToLoad--,0===this._numToLoad&&(this.progress=100,this._onComplete()),e.error?this.emit("error",e.error,this,e):this.emit("load",this,e)}),e._dequeue()},Loader.prototype._runMiddleware=function(e,t,r){var s=this;async.eachSeries(t,function(t,r){t.call(s,e,r)},r.bind(this,e))},Loader.LOAD_TYPE=Resource.LOAD_TYPE,Loader.XHR_READY_STATE=Resource.XHR_READY_STATE,Loader.XHR_RESPONSE_TYPE=Resource.XHR_RESPONSE_TYPE;
},{"./Resource":24,"async":22,"eventemitter3":20,"url":7}],24:[function(require,module,exports){
function Resource(e,t,r){if(EventEmitter.call(this),r=r||{},"string"!=typeof e||"string"!=typeof t)throw new Error("Both name and url are required for constructing a resource.");this.name=e,this.url=t,this.isDataUrl=0===this.url.indexOf("data:"),this.data=null,this.crossOrigin=r.crossOrigin===!0?"anonymous":null,this.loadType=r.loadType||this._determineLoadType(),this.xhrType=r.xhrType,this.error=null,this.xhr=null,this.isJson=!1,this.isXml=!1,this.isImage=!1,this.isAudio=!1,this.isVideo=!1,this._dequeue=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this)}function reqType(e){return e.toString().replace("object ","")}function setExtMap(e,t,r){t&&0===t.indexOf(".")&&(t=t.substring(1)),t&&(e[t]=r)}var EventEmitter=require("eventemitter3"),_url=require("url"),useXdr=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),tempAnchor=null;Resource.prototype=Object.create(EventEmitter.prototype),Resource.prototype.constructor=Resource,module.exports=Resource,Resource.prototype.complete=function(){this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError),this.data.removeEventListener("load",this._boundComplete),this.data.removeEventListener("progress",this._boundOnProgress),this.data.removeEventListener("canplaythrough",this._boundComplete)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError),this.xhr.removeEventListener("abort",this._boundXhrOnAbort),this.xhr.removeEventListener("progress",this._boundOnProgress),this.xhr.removeEventListener("load",this._boundXhrOnLoad)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.emit("complete",this)},Resource.prototype.load=function(e){switch(this.emit("start",this),e&&this.once("complete",e),"string"!=typeof this.crossOrigin&&(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case Resource.LOAD_TYPE.IMAGE:this._loadImage();break;case Resource.LOAD_TYPE.AUDIO:this._loadElement("audio");break;case Resource.LOAD_TYPE.VIDEO:this._loadElement("video");break;case Resource.LOAD_TYPE.XHR:default:useXdr&&this.crossOrigin?this._loadXdr():this._loadXhr()}},Resource.prototype._loadImage=function(){this.data=new Image,this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.data.src=this.url,this.isImage=!0,this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},Resource.prototype._loadElement=function(e){if("audio"===e&&"undefined"!=typeof Audio?this.data=new Audio:this.data=document.createElement(e),null===this.data)return this.error=new Error("Unsupported element "+e),void this.complete();if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var t=0;t<this.url.length;++t)this.data.appendChild(this._createSource(e,this.url[t]));else this.data.appendChild(this._createSource(e,this.url));this["is"+e[0].toUpperCase()+e.substring(1)]=!0,this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()},Resource.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),this.xhrType===Resource.XHR_RESPONSE_TYPE.JSON||this.xhrType===Resource.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=Resource.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},Resource.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XDomainRequest;e.timeout=5e3,e.onerror=this._boundXhrOnError,e.ontimeout=this._boundXdrOnTimeout,e.onprogress=this._boundOnProgress,e.onload=this._boundXhrOnLoad,e.open("GET",this.url,!0),setTimeout(function(){e.send()},0)},Resource.prototype._createSource=function(e,t,r){r||(r=e+"/"+t.substr(t.lastIndexOf(".")+1));var s=document.createElement("source");return s.src=t,s.type=r,s},Resource.prototype._onError=function(e){this.error=new Error("Failed to load element using "+e.target.nodeName),this.complete()},Resource.prototype._onProgress=function(e){e&&e.lengthComputable&&this.emit("progress",this,e.loaded/e.total)},Resource.prototype._xhrOnError=function(){this.error=new Error(reqType(this.xhr)+" Request failed. Status: "+this.xhr.status+', text: "'+this.xhr.statusText+'"'),this.complete()},Resource.prototype._xhrOnAbort=function(){this.error=new Error(reqType(this.xhr)+" Request was aborted by the user."),this.complete()},Resource.prototype._xdrOnTimeout=function(){this.error=new Error(reqType(this.xhr)+" Request timed out."),this.complete()},Resource.prototype._xhrOnLoad=function(){var e=this.xhr,t=void 0!==e.status?e.status:200;if(200===t||204===t||0===t&&e.responseText.length>0)if(this.xhrType===Resource.XHR_RESPONSE_TYPE.TEXT)this.data=e.responseText;else if(this.xhrType===Resource.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(e.responseText),this.isJson=!0}catch(r){this.error=new Error("Error trying to parse loaded json:",r)}else if(this.xhrType===Resource.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var s=new DOMParser;this.data=s.parseFromString(e.responseText,"text/xml")}else{var o=document.createElement("div");o.innerHTML=e.responseText,this.data=o}this.isXml=!0}catch(r){this.error=new Error("Error trying to parse loaded xml:",r)}else this.data=e.response||e.responseText;else this.error=new Error("["+e.status+"]"+e.statusText+":"+e.responseURL);this.complete()},Resource.prototype._determineCrossOrigin=function(e,t){if(0===e.indexOf("data:"))return"";t=t||window.location,tempAnchor||(tempAnchor=document.createElement("a")),tempAnchor.href=e,e=_url.parse(tempAnchor.href);var r=!e.port&&""===t.port||e.port===t.port;return e.hostname===t.hostname&&r&&e.protocol===t.protocol?"":"anonymous"},Resource.prototype._determineXhrType=function(){return Resource._xhrTypeMap[this._getExtension()]||Resource.XHR_RESPONSE_TYPE.TEXT},Resource.prototype._determineLoadType=function(){return Resource._loadTypeMap[this._getExtension()]||Resource.LOAD_TYPE.XHR},Resource.prototype._getExtension=function(){var e,t=this.url;if(this.isDataUrl){var r=t.indexOf("/");e=t.substring(r+1,t.indexOf(";",r))}else{var s=t.indexOf("?");-1!==s&&(t=t.substring(0,s)),e=t.substring(t.lastIndexOf(".")+1)}return e},Resource.prototype._getMimeFromXhrType=function(e){switch(e){case Resource.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case Resource.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case Resource.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case Resource.XHR_RESPONSE_TYPE.JSON:return"application/json";case Resource.XHR_RESPONSE_TYPE.DEFAULT:case Resource.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},Resource.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},Resource.XHR_READY_STATE={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},Resource.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},Resource._loadTypeMap={gif:Resource.LOAD_TYPE.IMAGE,png:Resource.LOAD_TYPE.IMAGE,bmp:Resource.LOAD_TYPE.IMAGE,jpg:Resource.LOAD_TYPE.IMAGE,jpeg:Resource.LOAD_TYPE.IMAGE,tif:Resource.LOAD_TYPE.IMAGE,tiff:Resource.LOAD_TYPE.IMAGE,webp:Resource.LOAD_TYPE.IMAGE,tga:Resource.LOAD_TYPE.IMAGE},Resource._xhrTypeMap={xhtml:Resource.XHR_RESPONSE_TYPE.DOCUMENT,html:Resource.XHR_RESPONSE_TYPE.DOCUMENT,htm:Resource.XHR_RESPONSE_TYPE.DOCUMENT,xml:Resource.XHR_RESPONSE_TYPE.DOCUMENT,tmx:Resource.XHR_RESPONSE_TYPE.DOCUMENT,tsx:Resource.XHR_RESPONSE_TYPE.DOCUMENT,svg:Resource.XHR_RESPONSE_TYPE.DOCUMENT,gif:Resource.XHR_RESPONSE_TYPE.BLOB,png:Resource.XHR_RESPONSE_TYPE.BLOB,bmp:Resource.XHR_RESPONSE_TYPE.BLOB,jpg:Resource.XHR_RESPONSE_TYPE.BLOB,jpeg:Resource.XHR_RESPONSE_TYPE.BLOB,tif:Resource.XHR_RESPONSE_TYPE.BLOB,tiff:Resource.XHR_RESPONSE_TYPE.BLOB,webp:Resource.XHR_RESPONSE_TYPE.BLOB,tga:Resource.XHR_RESPONSE_TYPE.BLOB,json:Resource.XHR_RESPONSE_TYPE.JSON,text:Resource.XHR_RESPONSE_TYPE.TEXT,txt:Resource.XHR_RESPONSE_TYPE.TEXT},Resource.setExtensionLoadType=function(e,t){setExtMap(Resource._loadTypeMap,e,t)},Resource.setExtensionXhrType=function(e,t){setExtMap(Resource._xhrTypeMap,e,t)};
},{"eventemitter3":20,"url":7}],25:[function(require,module,exports){
module.exports={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encodeBinary:function(e){for(var r,t="",n=new Array(4),a=0,h=0,o=0;a<e.length;){for(r=new Array(3),h=0;h<r.length;h++)a<e.length?r[h]=255&e.charCodeAt(a++):r[h]=0;switch(n[0]=r[0]>>2,n[1]=(3&r[0])<<4|r[1]>>4,n[2]=(15&r[1])<<2|r[2]>>6,n[3]=63&r[2],o=a-(e.length-1)){case 2:n[3]=64,n[2]=64;break;case 1:n[3]=64}for(h=0;h<n.length;h++)t+=this._keyStr.charAt(n[h])}return t}};
},{}],26:[function(require,module,exports){
module.exports=require("./Loader"),module.exports.Resource=require("./Resource"),module.exports.middleware={caching:{memory:require("./middlewares/caching/memory")},parsing:{blob:require("./middlewares/parsing/blob")}};
},{"./Loader":23,"./Resource":24,"./middlewares/caching/memory":27,"./middlewares/parsing/blob":28}],27:[function(require,module,exports){
var cache={};module.exports=function(){return function(c,e){cache[c.url]?(c.data=cache[c.url],c.complete()):(c.once("complete",function(){cache[this.url]=this.data}),e())}};
},{}],28:[function(require,module,exports){
var Resource=require("../../Resource"),b64=require("../../b64");window.URL=window.URL||window.webkitURL,module.exports=function(){return function(e,a){if(!e.data)return a();if(e.xhr&&e.xhrType===Resource.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof e.data){if(0===e.data.type.indexOf("image")){var t=URL.createObjectURL(e.data);e.blob=e.data,e.data=new Image,e.data.src=t,e.isImage=!0,e.data.onload=function(){URL.revokeObjectURL(t),e.data.onload=null,a()}}}else{var n=e.xhr.getResponseHeader("content-type");n&&0===n.indexOf("image")&&(e.data=new Image,e.data.src="data:"+n+";base64,"+b64.encodeBinary(e.xhr.responseText),e.isImage=!0,e.data.onload=function(){e.data.onload=null,a()})}else a()}};
},{"../../Resource":24,"../../b64":25}],29:[function(require,module,exports){
module.exports={"name":"pixi.js","version":"3.0.8","description":"Pixi.js is a fast lightweight 2D library that works across all devices.","author":{"name":"Mat Groves"},"contributors":[{"name":"Chad Engler","email":"chad@pantherdev.com"},{"name":"Richard Davey","email":"rdavey@gmail.com"}],"main":"./src/index.js","homepage":"http://goodboydigital.com/","bugs":{"url":"https://github.com/pixijs/pixi.js/issues"},"license":"MIT","repository":{"type":"git","url":"git+https://github.com/pixijs/pixi.js.git"},"scripts":{"start":"gulp && gulp watch","test":"gulp && testem ci","build":"gulp","docs":"jsdoc -c ./gulp/util/jsdoc.conf.json -R README.md"},"files":["bin/","src/","CONTRIBUTING.md","LICENSE","package.json","README.md"],"dependencies":{"async":"^1.4.2","brfs":"^1.4.1","earcut":"^2.0.2","eventemitter3":"^1.1.1","gulp-header":"^1.7.1","object-assign":"^4.0.1","resource-loader":"^1.6.2"},"devDependencies":{"browserify":"^11.1.0","chai":"^3.2.0","del":"^2.0.2","gulp":"^3.9.0","gulp-cached":"^1.1.0","gulp-concat":"^2.6.0","gulp-debug":"^2.1.0","gulp-jshint":"^1.11.2","gulp-mirror":"^0.4.0","gulp-plumber":"^1.0.1","gulp-rename":"^1.2.2","gulp-sourcemaps":"^1.5.2","gulp-uglify":"^1.4.1","gulp-util":"^3.0.6","jaguarjs-jsdoc":"git+https://github.com/davidshimjs/jaguarjs-jsdoc.git","jsdoc":"^3.3.2","jshint-summary":"^0.4.0","minimist":"^1.2.0","mocha":"^2.3.2","require-dir":"^0.3.0","run-sequence":"^1.1.2","testem":"^0.9.4","vinyl-buffer":"^1.0.0","vinyl-source-stream":"^1.1.0","watchify":"^3.4.0"},"browserify":{"transform":["brfs"]},"gitHead":"5d385885324e97369fd29b686e9e90eb4cefd14a","_id":"pixi.js@3.0.8","_shasum":"259dbe9739957587f160417dce7df9e1c5e47521","_from":"pixi.js@*","_npmVersion":"2.7.1","_nodeVersion":"0.12.4","_npmUser":{"name":"englercj","email":"englercj@live.com"},"maintainers":[{"name":"englercj","email":"englercj@live.com"}],"dist":{"shasum":"259dbe9739957587f160417dce7df9e1c5e47521","tarball":"http://registry.npmjs.org/pixi.js/-/pixi.js-3.0.8.tgz"},"directories":{},"_resolved":"https://registry.npmjs.org/pixi.js/-/pixi.js-3.0.8.tgz","readme":"ERROR: No README data found!"}
},{}],30:[function(require,module,exports){
var CONST={VERSION:require("../../package.json").version,PI_2:2*Math.PI,RAD_TO_DEG:180/Math.PI,DEG_TO_RAD:Math.PI/180,TARGET_FPMS:.06,RENDERER_TYPE:{UNKNOWN:0,WEBGL:1,CANVAS:2},BLEND_MODES:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},DRAW_MODES:{POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},SCALE_MODES:{DEFAULT:0,LINEAR:0,NEAREST:1},RETINA_PREFIX:/@(.+)x/,RESOLUTION:1,FILTER_RESOLUTION:1,DEFAULT_RENDER_OPTIONS:{view:null,resolution:1,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1},SHAPES:{POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},SPRITE_BATCH_SIZE:2e3};module.exports=CONST;
},{"../../package.json":29}],31:[function(require,module,exports){
function Container(){DisplayObject.call(this),this.children=[]}var math=require("../math"),DisplayObject=require("./DisplayObject"),RenderTexture=require("../textures/RenderTexture"),_tempMatrix=new math.Matrix;Container.prototype=Object.create(DisplayObject.prototype),Container.prototype.constructor=Container,module.exports=Container,Object.defineProperties(Container.prototype,{width:{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;0!==e?this.scale.x=t/e:this.scale.x=1,this._width=t}},height:{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;0!==e?this.scale.y=t/e:this.scale.y=1,this._height=t}}}),Container.prototype.onChildrenChange=function(){},Container.prototype.addChild=function(t){return this.addChildAt(t,this.children.length)},Container.prototype.addChildAt=function(t,e){if(t===this)return t;if(e>=0&&e<=this.children.length)return t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t),this.onChildrenChange(e),t.emit("added",this),t;throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length)},Container.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),i=this.getChildIndex(e);if(0>r||0>i)throw new Error("swapChildren: Both the supplied DisplayObjects must be children of the caller.");this.children[r]=e,this.children[i]=t,this.onChildrenChange(i>r?r:i)}},Container.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},Container.prototype.setChildIndex=function(t,e){if(0>e||e>=this.children.length)throw new Error("The supplied index is out of bounds");var r=this.getChildIndex(t);this.children.splice(r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},Container.prototype.getChildAt=function(t){if(0>t||t>=this.children.length)throw new Error("getChildAt: Supplied index "+t+" does not exist in the child list, or the supplied DisplayObject is not a child of the caller");return this.children[t]},Container.prototype.removeChild=function(t){var e=this.children.indexOf(t);if(-1!==e)return this.removeChildAt(e)},Container.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,this.children.splice(t,1),this.onChildrenChange(t),e.emit("removed",this),e},Container.prototype.removeChildren=function(t,e){var r,i,n=t||0,h="number"==typeof e?e:this.children.length,s=h-n;if(s>0&&h>=s){for(r=this.children.splice(n,s),i=0;i<r.length;++i)r[i].parent=null;for(this.onChildrenChange(t),i=0;i<r.length;++i)r[i].emit("removed",this);return r}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},Container.prototype.generateTexture=function(t,e,r){var i=this.getLocalBounds(),n=new RenderTexture(t,0|i.width,0|i.height,r,e);return _tempMatrix.tx=-i.x,_tempMatrix.ty=-i.y,n.render(this,_tempMatrix),n},Container.prototype.updateTransform=function(){if(this.visible){this.displayObjectUpdateTransform();for(var t=0,e=this.children.length;e>t;++t)this.children[t].updateTransform()}},Container.prototype.containerUpdateTransform=Container.prototype.updateTransform,Container.prototype.getBounds=function(){if(!this._currentBounds){if(0===this.children.length)return math.Rectangle.EMPTY;for(var t,e,r,i=1/0,n=1/0,h=-(1/0),s=-(1/0),o=!1,a=0,l=this.children.length;l>a;++a){var d=this.children[a];d.visible&&(o=!0,t=this.children[a].getBounds(),i=i<t.x?i:t.x,n=n<t.y?n:t.y,e=t.width+t.x,r=t.height+t.y,h=h>e?h:e,s=s>r?s:r)}if(!o)return math.Rectangle.EMPTY;var c=this._bounds;c.x=i,c.y=n,c.width=h-i,c.height=s-n,this._currentBounds=c}return this._currentBounds},Container.prototype.containerGetBounds=Container.prototype.getBounds,Container.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=math.Matrix.IDENTITY;for(var e=0,r=this.children.length;r>e;++e)this.children[e].updateTransform();return this.worldTransform=t,this._currentBounds=null,this.getBounds(math.Matrix.IDENTITY)},Container.prototype.renderWebGL=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){var e,r;if(this._mask||this._filters){for(t.currentRenderer.flush(),this._filters&&this._filters.length&&t.filterManager.pushFilter(this,this._filters),this._mask&&t.maskManager.pushMask(this,this._mask),t.currentRenderer.start(),this._renderWebGL(t),e=0,r=this.children.length;r>e;e++)this.children[e].renderWebGL(t);t.currentRenderer.flush(),this._mask&&t.maskManager.popMask(this,this._mask),this._filters&&t.filterManager.popFilter(),t.currentRenderer.start()}else for(this._renderWebGL(t),e=0,r=this.children.length;r>e;++e)this.children[e].renderWebGL(t)}},Container.prototype._renderWebGL=function(t){},Container.prototype._renderCanvas=function(t){},Container.prototype.renderCanvas=function(t){if(this.visible&&!(this.alpha<=0)&&this.renderable){this._mask&&t.maskManager.pushMask(this._mask,t),this._renderCanvas(t);for(var e=0,r=this.children.length;r>e;++e)this.children[e].renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},Container.prototype.destroy=function(t){if(DisplayObject.prototype.destroy.call(this),t)for(var e=0,r=this.children.length;r>e;++e)this.children[e].destroy(t);this.removeChildren(),this.children=null};
},{"../math":40,"../textures/RenderTexture":78,"./DisplayObject":32}],32:[function(require,module,exports){
function DisplayObject(){EventEmitter.call(this),this.position=new math.Point,this.scale=new math.Point(1,1),this.pivot=new math.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this.worldTransform=new math.Matrix,this.filterArea=null,this._sr=0,this._cr=1,this._bounds=new math.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null}var math=require("../math"),RenderTexture=require("../textures/RenderTexture"),EventEmitter=require("eventemitter3"),CONST=require("../const"),_tempMatrix=new math.Matrix,_tempDisplayObjectParent={worldTransform:new math.Matrix,worldAlpha:1,children:[]};DisplayObject.prototype=Object.create(EventEmitter.prototype),DisplayObject.prototype.constructor=DisplayObject,module.exports=DisplayObject,Object.defineProperties(DisplayObject.prototype,{x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},worldVisible:{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}},mask:{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.renderable=!0),this._mask=t,this._mask&&(this._mask.renderable=!1)}},filters:{get:function(){return this._filters&&this._filters.slice()},set:function(t){this._filters=t&&t.slice()}}}),DisplayObject.prototype.updateTransform=function(){var t,i,e,s,r,n,o=this.parent.worldTransform,a=this.worldTransform;this.rotation%CONST.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),t=this._cr*this.scale.x,i=this._sr*this.scale.x,e=-this._sr*this.scale.y,s=this._cr*this.scale.y,r=this.position.x,n=this.position.y,(this.pivot.x||this.pivot.y)&&(r-=this.pivot.x*t+this.pivot.y*e,n-=this.pivot.x*i+this.pivot.y*s),a.a=t*o.a+i*o.c,a.b=t*o.b+i*o.d,a.c=e*o.a+s*o.c,a.d=e*o.b+s*o.d,a.tx=r*o.a+n*o.c+o.tx,a.ty=r*o.b+n*o.d+o.ty):(t=this.scale.x,s=this.scale.y,r=this.position.x-this.pivot.x*t,n=this.position.y-this.pivot.y*s,a.a=t*o.a,a.b=t*o.b,a.c=s*o.c,a.d=s*o.d,a.tx=r*o.a+n*o.c+o.tx,a.ty=r*o.b+n*o.d+o.ty),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._currentBounds=null},DisplayObject.prototype.displayObjectUpdateTransform=DisplayObject.prototype.updateTransform,DisplayObject.prototype.getBounds=function(t){return math.Rectangle.EMPTY},DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(math.Matrix.IDENTITY)},DisplayObject.prototype.toGlobal=function(t){return this.parent?this.displayObjectUpdateTransform():(this.parent=_tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null),this.worldTransform.apply(t)},DisplayObject.prototype.toLocal=function(t,i){return i&&(t=i.toGlobal(t)),this.parent?this.displayObjectUpdateTransform():(this.parent=_tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null),this.worldTransform.applyInverse(t)},DisplayObject.prototype.renderWebGL=function(t){},DisplayObject.prototype.renderCanvas=function(t){},DisplayObject.prototype.generateTexture=function(t,i,e){var s=this.getLocalBounds(),r=new RenderTexture(t,0|s.width,0|s.height,i,e);return _tempMatrix.tx=-s.x,_tempMatrix.ty=-s.y,r.render(this,_tempMatrix),r},DisplayObject.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},DisplayObject.prototype.destroy=function(){this.position=null,this.scale=null,this.pivot=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.worldTransform=null,this.filterArea=null};
},{"../const":30,"../math":40,"../textures/RenderTexture":78,"eventemitter3":20}],33:[function(require,module,exports){
function Graphics(){Container.call(this),this.fillAlpha=1,this.lineWidth=0,this.lineColor=0,this.graphicsData=[],this.tint=16777215,this._prevTint=16777215,this.blendMode=CONST.BLEND_MODES.NORMAL,this.currentPath=null,this._webGL={},this.isMask=!1,this.boundsPadding=0,this._localBounds=new math.Rectangle(0,0,1,1),this.dirty=!0,this.glDirty=!1,this.boundsDirty=!0,this.cachedSpriteDirty=!1}var Container=require("../display/Container"),Texture=require("../textures/Texture"),CanvasBuffer=require("../renderers/canvas/utils/CanvasBuffer"),CanvasGraphics=require("../renderers/canvas/utils/CanvasGraphics"),GraphicsData=require("./GraphicsData"),math=require("../math"),CONST=require("../const"),tempPoint=new math.Point;Graphics.prototype=Object.create(Container.prototype),Graphics.prototype.constructor=Graphics,module.exports=Graphics,Graphics.prototype.clone=function(){var t=new Graphics;t.renderable=this.renderable,t.fillAlpha=this.fillAlpha,t.lineWidth=this.lineWidth,t.lineColor=this.lineColor,t.tint=this.tint,t.blendMode=this.blendMode,t.isMask=this.isMask,t.boundsPadding=this.boundsPadding,t.dirty=!0,t.glDirty=!0,t.cachedSpriteDirty=this.cachedSpriteDirty;for(var i=0;i<this.graphicsData.length;++i)t.graphicsData.push(this.graphicsData[i].clone());return t.currentPath=t.graphicsData[t.graphicsData.length-1],t.updateLocalBounds(),t},Graphics.prototype.lineStyle=function(t,i,r){if(this.lineWidth=t||0,this.lineColor=i||0,this.lineAlpha=void 0===r?1:r,this.currentPath)if(this.currentPath.shape.points.length){var h=new math.Polygon(this.currentPath.shape.points.slice(-2));h.closed=!1,this.drawShape(h)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha;return this},Graphics.prototype.moveTo=function(t,i){var r=new math.Polygon([t,i]);return r.closed=!1,this.drawShape(r),this},Graphics.prototype.lineTo=function(t,i){return this.currentPath.shape.points.push(t,i),this.dirty=!0,this},Graphics.prototype.quadraticCurveTo=function(t,i,r,h){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var s,e,a=20,n=this.currentPath.shape.points;0===n.length&&this.moveTo(0,0);for(var o=n[n.length-2],l=n[n.length-1],p=0,c=1;a>=c;++c)p=c/a,s=o+(t-o)*p,e=l+(i-l)*p,n.push(s+(t+(r-t)*p-s)*p,e+(i+(h-i)*p-e)*p);return this.dirty=this.boundsDirty=!0,this},Graphics.prototype.bezierCurveTo=function(t,i,r,h,s,e){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var a,n,o,l,p,c=20,u=this.currentPath.shape.points,d=u[u.length-2],g=u[u.length-1],y=0,f=1;c>=f;++f)y=f/c,a=1-y,n=a*a,o=n*a,l=y*y,p=l*y,u.push(o*d+3*n*y*t+3*a*l*r+p*s,o*g+3*n*y*i+3*a*l*h+p*e);return this.dirty=this.boundsDirty=!0,this},Graphics.prototype.arcTo=function(t,i,r,h,s){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,i):this.moveTo(t,i);var e=this.currentPath.shape.points,a=e[e.length-2],n=e[e.length-1],o=n-i,l=a-t,p=h-i,c=r-t,u=Math.abs(o*c-l*p);if(1e-8>u||0===s)(e[e.length-2]!==t||e[e.length-1]!==i)&&e.push(t,i);else{var d=o*o+l*l,g=p*p+c*c,y=o*p+l*c,f=s*Math.sqrt(d)/u,P=s*Math.sqrt(g)/u,v=f*y/d,C=P*y/g,b=f*c+P*l,G=f*p+P*o,w=l*(P+v),D=o*(P+v),m=c*(f+C),S=p*(f+C),T=Math.atan2(D-G,w-b),M=Math.atan2(S-G,m-b);this.arc(b+t,G+i,s,T,M,l*p>c*o)}return this.dirty=this.boundsDirty=!0,this},Graphics.prototype.arc=function(t,i,r,h,s,e){if(e=e||!1,h===s)return this;!e&&h>=s?s+=2*Math.PI:e&&s>=h&&(h+=2*Math.PI);var a=e?-1*(h-s):s-h,n=40*Math.ceil(Math.abs(a)/(2*Math.PI));if(0===a)return this;var o=t+Math.cos(h)*r,l=i+Math.sin(h)*r;this.currentPath?this.currentPath.shape.points.push(o,l):this.moveTo(o,l);for(var p=this.currentPath.shape.points,c=a/(2*n),u=2*c,d=Math.cos(c),g=Math.sin(c),y=n-1,f=y%1/y,P=0;y>=P;P++){var v=P+f*P,C=c+h+u*v,b=Math.cos(C),G=-Math.sin(C);p.push((d*b+g*G)*r+t,(d*-G+g*b)*r+i)}return this.dirty=this.boundsDirty=!0,this},Graphics.prototype.beginFill=function(t,i){return this.filling=!0,this.fillColor=t||0,this.fillAlpha=void 0===i?1:i,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},Graphics.prototype.drawRect=function(t,i,r,h){return this.drawShape(new math.Rectangle(t,i,r,h)),this},Graphics.prototype.drawRoundedRect=function(t,i,r,h,s){return this.drawShape(new math.RoundedRectangle(t,i,r,h,s)),this},Graphics.prototype.drawCircle=function(t,i,r){return this.drawShape(new math.Circle(t,i,r)),this},Graphics.prototype.drawEllipse=function(t,i,r,h){return this.drawShape(new math.Ellipse(t,i,r,h)),this},Graphics.prototype.drawPolygon=function(t){var i=t,r=!0;if(i instanceof math.Polygon&&(r=i.closed,i=i.points),!Array.isArray(i)){i=new Array(arguments.length);for(var h=0;h<i.length;++h)i[h]=arguments[h]}var s=new math.Polygon(i);return s.closed=r,this.drawShape(s),this},Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this},Graphics.prototype.generateTexture=function(t,i,r){i=i||1;var h=this.getLocalBounds(),s=new CanvasBuffer(h.width*i,h.height*i),e=Texture.fromCanvas(s.canvas,r);return e.baseTexture.resolution=i,s.context.scale(i,i),s.context.translate(-h.x,-h.y),CanvasGraphics.renderGraphics(this,s.context),e},Graphics.prototype._renderWebGL=function(t){this.glDirty&&(this.dirty=!0,this.glDirty=!1),t.setObjectRenderer(t.plugins.graphics),t.plugins.graphics.render(this)},Graphics.prototype._renderCanvas=function(t){if(this.isMask!==!0){this._prevTint!==this.tint&&(this.dirty=!0);var i=t.context,r=this.worldTransform,h=t.blendModes[this.blendMode];h!==i.globalCompositeOperation&&(i.globalCompositeOperation=h);var s=t.resolution;i.setTransform(r.a*s,r.b*s,r.c*s,r.d*s,r.tx*s,r.ty*s),CanvasGraphics.renderGraphics(this,i)}},Graphics.prototype.getBounds=function(t){if(!this._currentBounds){if(!this.renderable)return math.Rectangle.EMPTY;this.boundsDirty&&(this.updateLocalBounds(),this.glDirty=!0,this.cachedSpriteDirty=!0,this.boundsDirty=!1);var i=this._localBounds,r=i.x,h=i.width+i.x,s=i.y,e=i.height+i.y,a=t||this.worldTransform,n=a.a,o=a.b,l=a.c,p=a.d,c=a.tx,u=a.ty,d=n*h+l*e+c,g=p*e+o*h+u,y=n*r+l*e+c,f=p*e+o*r+u,P=n*r+l*s+c,v=p*s+o*r+u,C=n*h+l*s+c,b=p*s+o*h+u,G=d,w=g,D=d,m=g;D=D>y?y:D,D=D>P?P:D,D=D>C?C:D,m=m>f?f:m,m=m>v?v:m,m=m>b?b:m,G=y>G?y:G,G=P>G?P:G,G=C>G?C:G,w=f>w?f:w,w=v>w?v:w,w=b>w?b:w,this._bounds.x=D,this._bounds.width=G-D,this._bounds.y=m,this._bounds.height=w-m,this._currentBounds=this._bounds}return this._currentBounds},Graphics.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,tempPoint);for(var i=this.graphicsData,r=0;r<i.length;r++){var h=i[r];if(h.fill&&h.shape&&h.shape.contains(tempPoint.x,tempPoint.y))return!0}return!1},Graphics.prototype.updateLocalBounds=function(){var t=1/0,i=-(1/0),r=1/0,h=-(1/0);if(this.graphicsData.length)for(var s,e,a,n,o,l,p=0;p<this.graphicsData.length;p++){var c=this.graphicsData[p],u=c.type,d=c.lineWidth;if(s=c.shape,u===CONST.SHAPES.RECT||u===CONST.SHAPES.RREC)a=s.x-d/2,n=s.y-d/2,o=s.width+d,l=s.height+d,t=t>a?a:t,i=a+o>i?a+o:i,r=r>n?n:r,h=n+l>h?n+l:h;else if(u===CONST.SHAPES.CIRC)a=s.x,n=s.y,o=s.radius+d/2,l=s.radius+d/2,t=t>a-o?a-o:t,i=a+o>i?a+o:i,r=r>n-l?n-l:r,h=n+l>h?n+l:h;else if(u===CONST.SHAPES.ELIP)a=s.x,n=s.y,o=s.width+d/2,l=s.height+d/2,t=t>a-o?a-o:t,i=a+o>i?a+o:i,r=r>n-l?n-l:r,h=n+l>h?n+l:h;else{e=s.points;for(var g=0;g<e.length;g+=2)a=e[g],n=e[g+1],t=t>a-d?a-d:t,i=a+d>i?a+d:i,r=r>n-d?n-d:r,h=n+d>h?n+d:h}}else t=0,i=0,r=0,h=0;var y=this.boundsPadding;this._localBounds.x=t-y,this._localBounds.width=i-t+2*y,this._localBounds.y=r-y,this._localBounds.height=h-r+2*y},Graphics.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var i=new GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,t);return this.graphicsData.push(i),i.type===CONST.SHAPES.POLY&&(i.shape.closed=i.shape.closed||this.filling,this.currentPath=i),this.dirty=this.boundsDirty=!0,i},Graphics.prototype.destroy=function(){Container.prototype.destroy.apply(this,arguments);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();for(var i in this._webgl)for(var r=0;r<this._webgl[i].data.length;++r)this._webgl[i].data[r].destroy();this.graphicsData=null,this.currentPath=null,this._webgl=null,this._localBounds=null};
},{"../const":30,"../display/Container":31,"../math":40,"../renderers/canvas/utils/CanvasBuffer":52,"../renderers/canvas/utils/CanvasGraphics":53,"../textures/Texture":79,"./GraphicsData":34}],34:[function(require,module,exports){
function GraphicsData(i,t,h,l,s,a,o){this.lineWidth=i,this.lineColor=t,this.lineAlpha=h,this._lineTint=t,this.fillColor=l,this.fillAlpha=s,this._fillTint=l,this.fill=a,this.shape=o,this.type=o.type}GraphicsData.prototype.constructor=GraphicsData,module.exports=GraphicsData,GraphicsData.prototype.clone=function(){return new GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},GraphicsData.prototype.destroy=function(){this.shape=null};
},{}],35:[function(require,module,exports){
function GraphicsRenderer(e){ObjectRenderer.call(this,e),this.graphicsDataPool=[],this.primitiveShader=null,this.complexPrimitiveShader=null,this.maximumSimplePolySize=200}var utils=require("../../utils"),math=require("../../math"),CONST=require("../../const"),ObjectRenderer=require("../../renderers/webgl/utils/ObjectRenderer"),WebGLRenderer=require("../../renderers/webgl/WebGLRenderer"),WebGLGraphicsData=require("./WebGLGraphicsData"),earcut=require("earcut");GraphicsRenderer.prototype=Object.create(ObjectRenderer.prototype),GraphicsRenderer.prototype.constructor=GraphicsRenderer,module.exports=GraphicsRenderer,WebGLRenderer.registerPlugin("graphics",GraphicsRenderer),GraphicsRenderer.prototype.onContextChange=function(){},GraphicsRenderer.prototype.destroy=function(){ObjectRenderer.prototype.destroy.call(this);for(var e=0;e<this.graphicsDataPool.length;++e)this.graphicsDataPool[e].destroy();this.graphicsDataPool=null},GraphicsRenderer.prototype.render=function(e){var t,r=this.renderer,i=r.gl,a=r.shaderManager.plugins.primitiveShader;e.dirty&&this.updateGraphics(e);var s=e._webGL[i.id];r.blendModeManager.setBlendMode(e.blendMode);for(var h=0,n=s.data.length;n>h;h++)t=s.data[h],1===s.data[h].mode?(r.stencilManager.pushStencil(e,t),i.uniform1f(r.shaderManager.complexPrimitiveShader.uniforms.alpha._location,e.worldAlpha*t.alpha),i.drawElements(i.TRIANGLE_FAN,4,i.UNSIGNED_SHORT,2*(t.indices.length-4)),r.stencilManager.popStencil(e,t)):(a=r.shaderManager.primitiveShader,r.shaderManager.setShader(a),i.uniformMatrix3fv(a.uniforms.translationMatrix._location,!1,e.worldTransform.toArray(!0)),i.uniformMatrix3fv(a.uniforms.projectionMatrix._location,!1,r.currentRenderTarget.projectionMatrix.toArray(!0)),i.uniform3fv(a.uniforms.tint._location,utils.hex2rgb(e.tint)),i.uniform1f(a.uniforms.alpha._location,e.worldAlpha),i.bindBuffer(i.ARRAY_BUFFER,t.buffer),i.vertexAttribPointer(a.attributes.aVertexPosition,2,i.FLOAT,!1,24,0),i.vertexAttribPointer(a.attributes.aColor,4,i.FLOAT,!1,24,8),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer),i.drawElements(i.TRIANGLE_STRIP,t.indices.length,i.UNSIGNED_SHORT,0)),r.drawCount++},GraphicsRenderer.prototype.updateGraphics=function(e){var t=this.renderer.gl,r=e._webGL[t.id];r||(r=e._webGL[t.id]={lastIndex:0,data:[],gl:t}),e.dirty=!1;var i;if(e.clearDirty){for(e.clearDirty=!1,i=0;i<r.data.length;i++){var a=r.data[i];a.reset(),this.graphicsDataPool.push(a)}r.data=[],r.lastIndex=0}var s;for(i=r.lastIndex;i<e.graphicsData.length;i++){var h=e.graphicsData[i];if(h.type===CONST.SHAPES.POLY){if(h.points=h.shape.points.slice(),h.shape.closed&&(h.points[0]!==h.points[h.points.length-2]||h.points[1]!==h.points[h.points.length-1])&&h.points.push(h.points[0],h.points[1]),h.fill&&h.points.length>=6)if(h.points.length<2*this.maximumSimplePolySize){s=this.switchMode(r,0);var n=this.buildPoly(h,s);n||(s=this.switchMode(r,1),this.buildComplexPoly(h,s))}else s=this.switchMode(r,1),this.buildComplexPoly(h,s);h.lineWidth>0&&(s=this.switchMode(r,0),this.buildLine(h,s))}else s=this.switchMode(r,0),h.type===CONST.SHAPES.RECT?this.buildRectangle(h,s):h.type===CONST.SHAPES.CIRC||h.type===CONST.SHAPES.ELIP?this.buildCircle(h,s):h.type===CONST.SHAPES.RREC&&this.buildRoundedRectangle(h,s);r.lastIndex++}for(i=0;i<r.data.length;i++)s=r.data[i],s.dirty&&s.upload()},GraphicsRenderer.prototype.switchMode=function(e,t){var r;return e.data.length?(r=e.data[e.data.length-1],(r.points.length>32e4||r.mode!==t||1===t)&&(r=this.graphicsDataPool.pop()||new WebGLGraphicsData(e.gl),r.mode=t,e.data.push(r))):(r=this.graphicsDataPool.pop()||new WebGLGraphicsData(e.gl),r.mode=t,e.data.push(r)),r.dirty=!0,r},GraphicsRenderer.prototype.buildRectangle=function(e,t){var r=e.shape,i=r.x,a=r.y,s=r.width,h=r.height;if(e.fill){var n=utils.hex2rgb(e.fillColor),o=e.fillAlpha,p=n[0]*o,l=n[1]*o,u=n[2]*o,d=t.points,c=t.indices,f=d.length/6;d.push(i,a),d.push(p,l,u,o),d.push(i+s,a),d.push(p,l,u,o),d.push(i,a+h),d.push(p,l,u,o),d.push(i+s,a+h),d.push(p,l,u,o),c.push(f,f,f+1,f+2,f+3,f+3)}if(e.lineWidth){var g=e.points;e.points=[i,a,i+s,a,i+s,a+h,i,a+h,i,a],this.buildLine(e,t),e.points=g}},GraphicsRenderer.prototype.buildRoundedRectangle=function(e,t){var r=e.shape,i=r.x,a=r.y,s=r.width,h=r.height,n=r.radius,o=[];if(o.push(i,a+n),this.quadraticBezierCurve(i,a+h-n,i,a+h,i+n,a+h,o),this.quadraticBezierCurve(i+s-n,a+h,i+s,a+h,i+s,a+h-n,o),this.quadraticBezierCurve(i+s,a+n,i+s,a,i+s-n,a,o),this.quadraticBezierCurve(i+n,a,i,a,i,a+n+1e-10,o),e.fill){var p=utils.hex2rgb(e.fillColor),l=e.fillAlpha,u=p[0]*l,d=p[1]*l,c=p[2]*l,f=t.points,g=t.indices,b=f.length/6,v=earcut(o,null,2),R=0;for(R=0;R<v.length;R+=3)g.push(v[R]+b),g.push(v[R]+b),g.push(v[R+1]+b),g.push(v[R+2]+b),g.push(v[R+2]+b);for(R=0;R<o.length;R++)f.push(o[R],o[++R],u,d,c,l)}if(e.lineWidth){var y=e.points;e.points=o,this.buildLine(e,t),e.points=y}},GraphicsRenderer.prototype.quadraticBezierCurve=function(e,t,r,i,a,s,h){function n(e,t,r){var i=t-e;return e+i*r}for(var o,p,l,u,d,c,f=20,g=h||[],b=0,v=0;f>=v;v++)b=v/f,o=n(e,r,b),p=n(t,i,b),l=n(r,a,b),u=n(i,s,b),d=n(o,l,b),c=n(p,u,b),g.push(d,c);return g},GraphicsRenderer.prototype.buildCircle=function(e,t){var r,i,a=e.shape,s=a.x,h=a.y;e.type===CONST.SHAPES.CIRC?(r=a.radius,i=a.radius):(r=a.width,i=a.height);var n=Math.floor(30*Math.sqrt(a.radius))||Math.floor(15*Math.sqrt(a.width+a.height)),o=2*Math.PI/n,p=0;if(e.fill){var l=utils.hex2rgb(e.fillColor),u=e.fillAlpha,d=l[0]*u,c=l[1]*u,f=l[2]*u,g=t.points,b=t.indices,v=g.length/6;for(b.push(v),p=0;n+1>p;p++)g.push(s,h,d,c,f,u),g.push(s+Math.sin(o*p)*r,h+Math.cos(o*p)*i,d,c,f,u),b.push(v++,v++);b.push(v-1)}if(e.lineWidth){var R=e.points;for(e.points=[],p=0;n+1>p;p++)e.points.push(s+Math.sin(o*p)*r,h+Math.cos(o*p)*i);this.buildLine(e,t),e.points=R}},GraphicsRenderer.prototype.buildLine=function(e,t){var r=0,i=e.points;if(0!==i.length){var a=new math.Point(i[0],i[1]),s=new math.Point(i[i.length-2],i[i.length-1]);if(a.x===s.x&&a.y===s.y){i=i.slice(),i.pop(),i.pop(),s=new math.Point(i[i.length-2],i[i.length-1]);var h=s.x+.5*(a.x-s.x),n=s.y+.5*(a.y-s.y);i.unshift(h,n),i.push(h,n)}var o,p,l,u,d,c,f,g,b,v,R,y,m,G,x,M,S,C,P,A,w,L,E,q=t.points,O=t.indices,T=i.length/2,D=i.length,N=q.length/6,_=e.lineWidth/2,I=utils.hex2rgb(e.lineColor),W=e.lineAlpha,B=I[0]*W,j=I[1]*W,H=I[2]*W;for(l=i[0],u=i[1],d=i[2],c=i[3],b=-(u-c),v=l-d,E=Math.sqrt(b*b+v*v),b/=E,v/=E,b*=_,v*=_,q.push(l-b,u-v,B,j,H,W),q.push(l+b,u+v,B,j,H,W),r=1;T-1>r;r++)l=i[2*(r-1)],u=i[2*(r-1)+1],d=i[2*r],c=i[2*r+1],f=i[2*(r+1)],g=i[2*(r+1)+1],b=-(u-c),v=l-d,E=Math.sqrt(b*b+v*v),b/=E,v/=E,b*=_,v*=_,R=-(c-g),y=d-f,E=Math.sqrt(R*R+y*y),R/=E,y/=E,R*=_,y*=_,x=-v+u-(-v+c),M=-b+d-(-b+l),S=(-b+l)*(-v+c)-(-b+d)*(-v+u),C=-y+g-(-y+c),P=-R+d-(-R+f),A=(-R+f)*(-y+c)-(-R+d)*(-y+g),w=x*P-C*M,Math.abs(w)<.1?(w+=10.1,q.push(d-b,c-v,B,j,H,W),q.push(d+b,c+v,B,j,H,W)):(o=(M*A-P*S)/w,p=(C*S-x*A)/w,L=(o-d)*(o-d)+(p-c)+(p-c),L>19600?(m=b-R,G=v-y,E=Math.sqrt(m*m+G*G),m/=E,G/=E,m*=_,G*=_,q.push(d-m,c-G),q.push(B,j,H,W),q.push(d+m,c+G),q.push(B,j,H,W),q.push(d-m,c-G),q.push(B,j,H,W),D++):(q.push(o,p),q.push(B,j,H,W),q.push(d-(o-d),c-(p-c)),q.push(B,j,H,W)));for(l=i[2*(T-2)],u=i[2*(T-2)+1],d=i[2*(T-1)],c=i[2*(T-1)+1],b=-(u-c),v=l-d,E=Math.sqrt(b*b+v*v),b/=E,v/=E,b*=_,v*=_,q.push(d-b,c-v),q.push(B,j,H,W),q.push(d+b,c+v),q.push(B,j,H,W),O.push(N),r=0;D>r;r++)O.push(N++);O.push(N-1)}},GraphicsRenderer.prototype.buildComplexPoly=function(e,t){var r=e.points.slice();if(!(r.length<6)){var i=t.indices;t.points=r,t.alpha=e.fillAlpha,t.color=utils.hex2rgb(e.fillColor);for(var a,s,h=1/0,n=-(1/0),o=1/0,p=-(1/0),l=0;l<r.length;l+=2)a=r[l],s=r[l+1],h=h>a?a:h,n=a>n?a:n,o=o>s?s:o,p=s>p?s:p;r.push(h,o,n,o,n,p,h,p);var u=r.length/2;for(l=0;u>l;l++)i.push(l)}},GraphicsRenderer.prototype.buildPoly=function(e,t){var r=e.points;if(!(r.length<6)){var i=t.points,a=t.indices,s=r.length/2,h=utils.hex2rgb(e.fillColor),n=e.fillAlpha,o=h[0]*n,p=h[1]*n,l=h[2]*n,u=earcut(r,null,2);if(!u)return!1;var d=i.length/6,c=0;for(c=0;c<u.length;c+=3)a.push(u[c]+d),a.push(u[c]+d),a.push(u[c+1]+d),a.push(u[c+2]+d),a.push(u[c+2]+d);for(c=0;s>c;c++)i.push(r[2*c],r[2*c+1],o,p,l,n);return!0}};
},{"../../const":30,"../../math":40,"../../renderers/webgl/WebGLRenderer":56,"../../renderers/webgl/utils/ObjectRenderer":70,"../../utils":84,"./WebGLGraphicsData":36,"earcut":19}],36:[function(require,module,exports){
function WebGLGraphicsData(t){this.gl=t,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0,this.glPoints=null,this.glIndices=null}WebGLGraphicsData.prototype.constructor=WebGLGraphicsData,module.exports=WebGLGraphicsData,WebGLGraphicsData.prototype.reset=function(){this.points.length=0,this.indices.length=0},WebGLGraphicsData.prototype.upload=function(){var t=this.gl;this.glPoints=new Float32Array(this.points),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,this.glPoints,t.STATIC_DRAW),this.glIndices=new Uint16Array(this.indices),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.glIndices,t.STATIC_DRAW),this.dirty=!1},WebGLGraphicsData.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.gl.deleteBuffer(this.buffer),this.gl.deleteBuffer(this.indexBuffer),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null};
},{}],37:[function(require,module,exports){
var core=module.exports=Object.assign(require("./const"),require("./math"),{utils:require("./utils"),ticker:require("./ticker"),DisplayObject:require("./display/DisplayObject"),Container:require("./display/Container"),Sprite:require("./sprites/Sprite"),ParticleContainer:require("./particles/ParticleContainer"),SpriteRenderer:require("./sprites/webgl/SpriteRenderer"),ParticleRenderer:require("./particles/webgl/ParticleRenderer"),Text:require("./text/Text"),Graphics:require("./graphics/Graphics"),GraphicsData:require("./graphics/GraphicsData"),GraphicsRenderer:require("./graphics/webgl/GraphicsRenderer"),Texture:require("./textures/Texture"),BaseTexture:require("./textures/BaseTexture"),RenderTexture:require("./textures/RenderTexture"),VideoBaseTexture:require("./textures/VideoBaseTexture"),TextureUvs:require("./textures/TextureUvs"),CanvasRenderer:require("./renderers/canvas/CanvasRenderer"),CanvasGraphics:require("./renderers/canvas/utils/CanvasGraphics"),CanvasBuffer:require("./renderers/canvas/utils/CanvasBuffer"),WebGLRenderer:require("./renderers/webgl/WebGLRenderer"),ShaderManager:require("./renderers/webgl/managers/ShaderManager"),Shader:require("./renderers/webgl/shaders/Shader"),ObjectRenderer:require("./renderers/webgl/utils/ObjectRenderer"),RenderTarget:require("./renderers/webgl/utils/RenderTarget"),AbstractFilter:require("./renderers/webgl/filters/AbstractFilter"),FXAAFilter:require("./renderers/webgl/filters/FXAAFilter"),SpriteMaskFilter:require("./renderers/webgl/filters/SpriteMaskFilter"),autoDetectRenderer:function(e,r,i,t){return e=e||800,r=r||600,!t&&core.utils.isWebGLSupported()?new core.WebGLRenderer(e,r,i):new core.CanvasRenderer(e,r,i)}});
},{"./const":30,"./display/Container":31,"./display/DisplayObject":32,"./graphics/Graphics":33,"./graphics/GraphicsData":34,"./graphics/webgl/GraphicsRenderer":35,"./math":40,"./particles/ParticleContainer":46,"./particles/webgl/ParticleRenderer":48,"./renderers/canvas/CanvasRenderer":51,"./renderers/canvas/utils/CanvasBuffer":52,"./renderers/canvas/utils/CanvasGraphics":53,"./renderers/webgl/WebGLRenderer":56,"./renderers/webgl/filters/AbstractFilter":57,"./renderers/webgl/filters/FXAAFilter":58,"./renderers/webgl/filters/SpriteMaskFilter":59,"./renderers/webgl/managers/ShaderManager":63,"./renderers/webgl/shaders/Shader":68,"./renderers/webgl/utils/ObjectRenderer":70,"./renderers/webgl/utils/RenderTarget":72,"./sprites/Sprite":74,"./sprites/webgl/SpriteRenderer":75,"./text/Text":76,"./textures/BaseTexture":77,"./textures/RenderTexture":78,"./textures/Texture":79,"./textures/TextureUvs":80,"./textures/VideoBaseTexture":81,"./ticker":83,"./utils":84}],38:[function(require,module,exports){
function Matrix(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}var Point=require("./Point");Matrix.prototype.constructor=Matrix,module.exports=Matrix,Matrix.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},Matrix.prototype.toArray=function(t,i){this.array||(this.array=new Float32Array(9));var s=i||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s},Matrix.prototype.apply=function(t,i){i=i||new Point;var s=t.x,h=t.y;return i.x=this.a*s+this.c*h+this.tx,i.y=this.b*s+this.d*h+this.ty,i},Matrix.prototype.applyInverse=function(t,i){i=i||new Point;var s=1/(this.a*this.d+this.c*-this.b),h=t.x,r=t.y;return i.x=this.d*s*h+-this.c*s*r+(this.ty*this.c-this.tx*this.d)*s,i.y=this.a*s*r+-this.b*s*h+(-this.ty*this.a+this.tx*this.b)*s,i},Matrix.prototype.translate=function(t,i){return this.tx+=t,this.ty+=i,this},Matrix.prototype.scale=function(t,i){return this.a*=t,this.d*=i,this.c*=t,this.b*=i,this.tx*=t,this.ty*=i,this},Matrix.prototype.rotate=function(t){var i=Math.cos(t),s=Math.sin(t),h=this.a,r=this.c,a=this.tx;return this.a=h*i-this.b*s,this.b=h*s+this.b*i,this.c=r*i-this.d*s,this.d=r*s+this.d*i,this.tx=a*i-this.ty*s,this.ty=a*s+this.ty*i,this},Matrix.prototype.append=function(t){var i=this.a,s=this.b,h=this.c,r=this.d;return this.a=t.a*i+t.b*h,this.b=t.a*s+t.b*r,this.c=t.c*i+t.d*h,this.d=t.c*s+t.d*r,this.tx=t.tx*i+t.ty*h+this.tx,this.ty=t.tx*s+t.ty*r+this.ty,this},Matrix.prototype.prepend=function(t){var i=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var s=this.a,h=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=h*t.a+this.d*t.c,this.d=h*t.b+this.d*t.d}return this.tx=i*t.a+this.ty*t.c+t.tx,this.ty=i*t.b+this.ty*t.d+t.ty,this},Matrix.prototype.invert=function(){var t=this.a,i=this.b,s=this.c,h=this.d,r=this.tx,a=t*h-i*s;return this.a=h/a,this.b=-i/a,this.c=-s/a,this.d=t/a,this.tx=(s*this.ty-h*r)/a,this.ty=-(t*this.ty-i*r)/a,this},Matrix.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Matrix.prototype.clone=function(){var t=new Matrix;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},Matrix.prototype.copy=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},Matrix.IDENTITY=new Matrix,Matrix.TEMP_MATRIX=new Matrix;
},{"./Point":39}],39:[function(require,module,exports){
function Point(t,o){this.x=t||0,this.y=o||0}Point.prototype.constructor=Point,module.exports=Point,Point.prototype.clone=function(){return new Point(this.x,this.y)},Point.prototype.copy=function(t){this.set(t.x,t.y)},Point.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},Point.prototype.set=function(t,o){this.x=t||0,this.y=o||(0!==o?this.x:0)};
},{}],40:[function(require,module,exports){
module.exports={Point:require("./Point"),Matrix:require("./Matrix"),Circle:require("./shapes/Circle"),Ellipse:require("./shapes/Ellipse"),Polygon:require("./shapes/Polygon"),Rectangle:require("./shapes/Rectangle"),RoundedRectangle:require("./shapes/RoundedRectangle")};
},{"./Matrix":38,"./Point":39,"./shapes/Circle":41,"./shapes/Ellipse":42,"./shapes/Polygon":43,"./shapes/Rectangle":44,"./shapes/RoundedRectangle":45}],41:[function(require,module,exports){
function Circle(t,i,r){this.x=t||0,this.y=i||0,this.radius=r||0,this.type=CONST.SHAPES.CIRC}var Rectangle=require("./Rectangle"),CONST=require("../../const");Circle.prototype.constructor=Circle,module.exports=Circle,Circle.prototype.clone=function(){return new Circle(this.x,this.y,this.radius)},Circle.prototype.contains=function(t,i){if(this.radius<=0)return!1;var r=this.x-t,e=this.y-i,s=this.radius*this.radius;return r*=r,e*=e,s>=r+e},Circle.prototype.getBounds=function(){return new Rectangle(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)};
},{"../../const":30,"./Rectangle":44}],42:[function(require,module,exports){
function Ellipse(t,i,e,h){this.x=t||0,this.y=i||0,this.width=e||0,this.height=h||0,this.type=CONST.SHAPES.ELIP}var Rectangle=require("./Rectangle"),CONST=require("../../const");Ellipse.prototype.constructor=Ellipse,module.exports=Ellipse,Ellipse.prototype.clone=function(){return new Ellipse(this.x,this.y,this.width,this.height)},Ellipse.prototype.contains=function(t,i){if(this.width<=0||this.height<=0)return!1;var e=(t-this.x)/this.width,h=(i-this.y)/this.height;return e*=e,h*=h,1>=e+h},Ellipse.prototype.getBounds=function(){return new Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)};
},{"../../const":30,"./Rectangle":44}],43:[function(require,module,exports){
function Polygon(o){var t=o;if(!Array.isArray(t)){t=new Array(arguments.length);for(var n=0;n<t.length;++n)t[n]=arguments[n]}if(t[0]instanceof Point){for(var r=[],i=0,s=t.length;s>i;i++)r.push(t[i].x,t[i].y);t=r}this.closed=!0,this.points=t,this.type=CONST.SHAPES.POLY}var Point=require("../Point"),CONST=require("../../const");Polygon.prototype.constructor=Polygon,module.exports=Polygon,Polygon.prototype.clone=function(){return new Polygon(this.points.slice())},Polygon.prototype.contains=function(o,t){for(var n=!1,r=this.points.length/2,i=0,s=r-1;r>i;s=i++){var e=this.points[2*i],p=this.points[2*i+1],l=this.points[2*s],y=this.points[2*s+1],h=p>t!=y>t&&(l-e)*(t-p)/(y-p)+e>o;h&&(n=!n)}return n};
},{"../../const":30,"../Point":39}],44:[function(require,module,exports){
function Rectangle(t,e,i,h){this.x=t||0,this.y=e||0,this.width=i||0,this.height=h||0,this.type=CONST.SHAPES.RECT}var CONST=require("../../const");Rectangle.prototype.constructor=Rectangle,module.exports=Rectangle,Rectangle.EMPTY=new Rectangle(0,0,0,0),Rectangle.prototype.clone=function(){return new Rectangle(this.x,this.y,this.width,this.height)},Rectangle.prototype.contains=function(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height?!0:!1};
},{"../../const":30}],45:[function(require,module,exports){
function RoundedRectangle(t,e,i,h,n){this.x=t||0,this.y=e||0,this.width=i||0,this.height=h||0,this.radius=n||20,this.type=CONST.SHAPES.RREC}var CONST=require("../../const");RoundedRectangle.prototype.constructor=RoundedRectangle,module.exports=RoundedRectangle,RoundedRectangle.prototype.clone=function(){return new RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)},RoundedRectangle.prototype.contains=function(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height?!0:!1};
},{"../../const":30}],46:[function(require,module,exports){
function ParticleContainer(t,e,r){Container.call(this),r=r||15e3,t=t||15e3;var i=16384;r>i&&(r=i),r>t&&(r=t),this._properties=[!1,!0,!1,!1,!1],this._maxSize=t,this._batchSize=r,this._buffers=null,this._bufferToUpdate=0,this.interactiveChildren=!1,this.blendMode=CONST.BLEND_MODES.NORMAL,this.roundPixels=!0,this.setProperties(e)}var Container=require("../display/Container"),CONST=require("../const");ParticleContainer.prototype=Object.create(Container.prototype),ParticleContainer.prototype.constructor=ParticleContainer,module.exports=ParticleContainer,ParticleContainer.prototype.setProperties=function(t){t&&(this._properties[0]="scale"in t?!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="alpha"in t?!!t.alpha:this._properties[4])},ParticleContainer.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},ParticleContainer.prototype.renderWebGL=function(t){this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(t.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},ParticleContainer.prototype.onChildrenChange=function(t){var e=Math.floor(t/this._batchSize);e<this._bufferToUpdate&&(this._bufferToUpdate=e)},ParticleContainer.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var e=t.context,r=this.worldTransform,i=!0,o=0,s=0,a=0,n=0;e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var h=0;h<this.children.length;++h){var p=this.children[h];if(p.visible){var l=p.texture.frame;if(e.globalAlpha=this.worldAlpha*p.alpha,p.rotation%(2*Math.PI)===0)i&&(e.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty),i=!1),o=p.anchor.x*(-l.width*p.scale.x)+p.position.x+.5,s=p.anchor.y*(-l.height*p.scale.y)+p.position.y+.5,a=l.width*p.scale.x,n=l.height*p.scale.y;else{i||(i=!0),p.displayObjectUpdateTransform();var c=p.worldTransform;t.roundPixels?e.setTransform(c.a,c.b,c.c,c.d,0|c.tx,0|c.ty):e.setTransform(c.a,c.b,c.c,c.d,c.tx,c.ty),o=p.anchor.x*-l.width+.5,s=p.anchor.y*-l.height+.5,a=l.width,n=l.height}e.drawImage(p.texture.baseTexture.source,l.x,l.y,l.width,l.height,o,s,a,n)}}}},ParticleContainer.prototype.destroy=function(){if(Container.prototype.destroy.apply(this,arguments),this._buffers)for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._properties=null,this._buffers=null};
},{"../const":30,"../display/Container":31}],47:[function(require,module,exports){
function ParticleBuffer(t,i,e,r){this.gl=t,this.vertSize=2,this.vertByteSize=4*this.vertSize,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var s=0;s<i.length;s++){var a=i[s];e[s]?this.dynamicProperties.push(a):this.staticProperties.push(a)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.initBuffers()}ParticleBuffer.prototype.constructor=ParticleBuffer,module.exports=ParticleBuffer,ParticleBuffer.prototype.initBuffers=function(){var t,i,e=this.gl,r=0;for(this.dynamicStride=0,t=0;t<this.dynamicProperties.length;t++)i=this.dynamicProperties[t],i.offset=r,r+=i.size,this.dynamicStride+=i.size;this.dynamicData=new Float32Array(this.size*this.dynamicStride*4),this.dynamicBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.dynamicBuffer),e.bufferData(e.ARRAY_BUFFER,this.dynamicData,e.DYNAMIC_DRAW);var s=0;for(this.staticStride=0,t=0;t<this.staticProperties.length;t++)i=this.staticProperties[t],i.offset=s,s+=i.size,this.staticStride+=i.size;this.staticData=new Float32Array(this.size*this.staticStride*4),this.staticBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.staticBuffer),e.bufferData(e.ARRAY_BUFFER,this.staticData,e.DYNAMIC_DRAW)},ParticleBuffer.prototype.uploadDynamic=function(t,i,e){for(var r=this.gl,s=0;s<this.dynamicProperties.length;s++){var a=this.dynamicProperties[s];a.uploadFunction(t,i,e,this.dynamicData,this.dynamicStride,a.offset)}r.bindBuffer(r.ARRAY_BUFFER,this.dynamicBuffer),r.bufferSubData(r.ARRAY_BUFFER,0,this.dynamicData)},ParticleBuffer.prototype.uploadStatic=function(t,i,e){for(var r=this.gl,s=0;s<this.staticProperties.length;s++){var a=this.staticProperties[s];a.uploadFunction(t,i,e,this.staticData,this.staticStride,a.offset)}r.bindBuffer(r.ARRAY_BUFFER,this.staticBuffer),r.bufferSubData(r.ARRAY_BUFFER,0,this.staticData)},ParticleBuffer.prototype.bind=function(){var t,i,e=this.gl;for(e.bindBuffer(e.ARRAY_BUFFER,this.dynamicBuffer),t=0;t<this.dynamicProperties.length;t++)i=this.dynamicProperties[t],e.vertexAttribPointer(i.attribute,i.size,e.FLOAT,!1,4*this.dynamicStride,4*i.offset);for(e.bindBuffer(e.ARRAY_BUFFER,this.staticBuffer),t=0;t<this.staticProperties.length;t++)i=this.staticProperties[t],e.vertexAttribPointer(i.attribute,i.size,e.FLOAT,!1,4*this.staticStride,4*i.offset)},ParticleBuffer.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicData=null,this.gl.deleteBuffer(this.dynamicBuffer),this.staticProperties=null,this.staticData=null,this.gl.deleteBuffer(this.staticBuffer)};
},{}],48:[function(require,module,exports){
function ParticleRenderer(e){ObjectRenderer.call(this,e);var r=98304;this.indices=new Uint16Array(r);for(var t=0,i=0;r>t;t+=6,i+=4)this.indices[t+0]=i+0,this.indices[t+1]=i+1,this.indices[t+2]=i+2,this.indices[t+3]=i+0,this.indices[t+4]=i+2,this.indices[t+5]=i+3;this.shader=null,this.indexBuffer=null,this.properties=null,this.tempMatrix=new math.Matrix}var ObjectRenderer=require("../../renderers/webgl/utils/ObjectRenderer"),WebGLRenderer=require("../../renderers/webgl/WebGLRenderer"),ParticleShader=require("./ParticleShader"),ParticleBuffer=require("./ParticleBuffer"),math=require("../../math");ParticleRenderer.prototype=Object.create(ObjectRenderer.prototype),ParticleRenderer.prototype.constructor=ParticleRenderer,module.exports=ParticleRenderer,WebGLRenderer.registerPlugin("particle",ParticleRenderer),ParticleRenderer.prototype.onContextChange=function(){var e=this.renderer.gl;this.shader=new ParticleShader(this.renderer.shaderManager),this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,uploadFunction:this.uploadAlpha,offset:0}]},ParticleRenderer.prototype.start=function(){var e=this.renderer.gl;e.activeTexture(e.TEXTURE0),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var r=this.shader;this.renderer.shaderManager.setShader(r)},ParticleRenderer.prototype.render=function(e){var r=e.children,t=r.length,i=e._maxSize,a=e._batchSize;if(0!==t){t>i&&(t=i),e._buffers||(e._buffers=this.generateBuffers(e)),this.renderer.blendModeManager.setBlendMode(e.blendMode);var n=this.renderer.gl,o=e.worldTransform.copy(this.tempMatrix);o.prepend(this.renderer.currentRenderTarget.projectionMatrix),n.uniformMatrix3fv(this.shader.uniforms.projectionMatrix._location,!1,o.toArray(!0)),n.uniform1f(this.shader.uniforms.uAlpha._location,e.worldAlpha);var s=r[0]._texture.baseTexture;if(s._glTextures[n.id])n.bindTexture(n.TEXTURE_2D,s._glTextures[n.id]);else{if(!this.renderer.updateTexture(s))return;e._properties[0]&&e._properties[3]||(e._bufferToUpdate=0)}for(var d=0,h=0;t>d;d+=a,h+=1){var u=t-d;u>a&&(u=a);var l=e._buffers[h];l.uploadDynamic(r,d,u),e._bufferToUpdate===h&&(l.uploadStatic(r,d,u),e._bufferToUpdate=h+1),l.bind(this.shader),n.drawElements(n.TRIANGLES,6*u,n.UNSIGNED_SHORT,0),this.renderer.drawCount++}}},ParticleRenderer.prototype.generateBuffers=function(e){var r,t=this.renderer.gl,i=[],a=e._maxSize,n=e._batchSize,o=e._properties;for(r=0;a>r;r+=n)i.push(new ParticleBuffer(t,this.properties,o,n));return i},ParticleRenderer.prototype.uploadVertices=function(e,r,t,i,a,n){for(var o,s,d,h,u,l,f,c,p,R=0;t>R;R++)o=e[r+R],s=o._texture,h=o.scale.x,u=o.scale.y,s.trim?(d=s.trim,f=d.x-o.anchor.x*d.width,l=f+s.crop.width,p=d.y-o.anchor.y*d.height,c=p+s.crop.height):(l=s._frame.width*(1-o.anchor.x),f=s._frame.width*-o.anchor.x,c=s._frame.height*(1-o.anchor.y),p=s._frame.height*-o.anchor.y),i[n]=f*h,i[n+1]=p*u,i[n+a]=l*h,i[n+a+1]=p*u,i[n+2*a]=l*h,i[n+2*a+1]=c*u,i[n+3*a]=f*h,i[n+3*a+1]=c*u,n+=4*a},ParticleRenderer.prototype.uploadPosition=function(e,r,t,i,a,n){for(var o=0;t>o;o++){var s=e[r+o].position;i[n]=s.x,i[n+1]=s.y,i[n+a]=s.x,i[n+a+1]=s.y,i[n+2*a]=s.x,i[n+2*a+1]=s.y,i[n+3*a]=s.x,i[n+3*a+1]=s.y,n+=4*a}},ParticleRenderer.prototype.uploadRotation=function(e,r,t,i,a,n){for(var o=0;t>o;o++){var s=e[r+o].rotation;i[n]=s,i[n+a]=s,i[n+2*a]=s,i[n+3*a]=s,n+=4*a}},ParticleRenderer.prototype.uploadUvs=function(e,r,t,i,a,n){for(var o=0;t>o;o++){var s=e[r+o]._texture._uvs;s?(i[n]=s.x0,i[n+1]=s.y0,i[n+a]=s.x1,i[n+a+1]=s.y1,i[n+2*a]=s.x2,i[n+2*a+1]=s.y2,i[n+3*a]=s.x3,i[n+3*a+1]=s.y3,n+=4*a):(i[n]=0,i[n+1]=0,i[n+a]=0,i[n+a+1]=0,i[n+2*a]=0,i[n+2*a+1]=0,i[n+3*a]=0,i[n+3*a+1]=0,n+=4*a)}},ParticleRenderer.prototype.uploadAlpha=function(e,r,t,i,a,n){for(var o=0;t>o;o++){var s=e[r+o].alpha;i[n]=s,i[n+a]=s,i[n+2*a]=s,i[n+3*a]=s,n+=4*a}},ParticleRenderer.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),ObjectRenderer.prototype.destroy.apply(this,arguments),this.shader.destroy(),this.indices=null,this.tempMatrix=null};
},{"../../math":40,"../../renderers/webgl/WebGLRenderer":56,"../../renderers/webgl/utils/ObjectRenderer":70,"./ParticleBuffer":47,"./ParticleShader":49}],49:[function(require,module,exports){
function ParticleShader(o){TextureShader.call(this,o,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void){","   vec2 v = aVertexPosition;","   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","uniform float uAlpha;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor * uAlpha;","  if (color.a == 0.0) discard;","  gl_FragColor = color;","}"].join("\n"),{uAlpha:{type:"1f",value:1}},{aPositionCoord:0,aRotation:0})}var TextureShader=require("../../renderers/webgl/shaders/TextureShader");ParticleShader.prototype=Object.create(TextureShader.prototype),ParticleShader.prototype.constructor=ParticleShader,module.exports=ParticleShader;
},{"../../renderers/webgl/shaders/TextureShader":69}],50:[function(require,module,exports){
function SystemRenderer(e,t,i,r){if(EventEmitter.call(this),utils.sayHello(e),r)for(var s in CONST.DEFAULT_RENDER_OPTIONS)"undefined"==typeof r[s]&&(r[s]=CONST.DEFAULT_RENDER_OPTIONS[s]);else r=CONST.DEFAULT_RENDER_OPTIONS;this.type=CONST.RENDERER_TYPE.UNKNOWN,this.width=t||800,this.height=i||600,this.view=r.view||document.createElement("canvas"),this.resolution=r.resolution,this.transparent=r.transparent,this.autoResize=r.autoResize||!1,this.blendModes=null,this.preserveDrawingBuffer=r.preserveDrawingBuffer,this.clearBeforeRender=r.clearBeforeRender,this.roundPixels=r.roundPixels,this._backgroundColor=0,this._backgroundColorRgb=[0,0,0],this._backgroundColorString="#000000",this.backgroundColor=r.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent={worldTransform:new math.Matrix,worldAlpha:1,children:[]},this._lastObjectRendered=this._tempDisplayObjectParent}var utils=require("../utils"),math=require("../math"),CONST=require("../const"),EventEmitter=require("eventemitter3");SystemRenderer.prototype=Object.create(EventEmitter.prototype),SystemRenderer.prototype.constructor=SystemRenderer,module.exports=SystemRenderer,Object.defineProperties(SystemRenderer.prototype,{backgroundColor:{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._backgroundColorString=utils.hex2string(e),utils.hex2rgb(e,this._backgroundColorRgb)}}}),SystemRenderer.prototype.resize=function(e,t){this.width=e*this.resolution,this.height=t*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")},SystemRenderer.prototype.destroy=function(e){e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=CONST.RENDERER_TYPE.UNKNOWN,this.width=0,this.height=0,this.view=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgb=null,this._backgroundColorString=null};
},{"../const":30,"../math":40,"../utils":84,"eventemitter3":20}],51:[function(require,module,exports){
function CanvasRenderer(e,t,s){s=s||{},SystemRenderer.call(this,"Canvas",e,t,s),this.type=CONST.RENDERER_TYPE.CANVAS,this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.maskManager=new CanvasMaskManager,this.smoothProperty="imageSmoothingEnabled",this.context.imageSmoothingEnabled||(this.context.webkitImageSmoothingEnabled?this.smoothProperty="webkitImageSmoothingEnabled":this.context.mozImageSmoothingEnabled?this.smoothProperty="mozImageSmoothingEnabled":this.context.oImageSmoothingEnabled?this.smoothProperty="oImageSmoothingEnabled":this.context.msImageSmoothingEnabled&&(this.smoothProperty="msImageSmoothingEnabled")),this.initPlugins(),this._mapBlendModes(),this._tempDisplayObjectParent={worldTransform:new math.Matrix,worldAlpha:1},this.resize(e,t)}var SystemRenderer=require("../SystemRenderer"),CanvasMaskManager=require("./utils/CanvasMaskManager"),utils=require("../../utils"),math=require("../../math"),CONST=require("../../const");CanvasRenderer.prototype=Object.create(SystemRenderer.prototype),CanvasRenderer.prototype.constructor=CanvasRenderer,module.exports=CanvasRenderer,utils.pluginTarget.mixin(CanvasRenderer),CanvasRenderer.prototype.render=function(e){var t=e.parent;this._lastObjectRendered=e,e.parent=this._tempDisplayObjectParent,e.updateTransform(),e.parent=t,this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.context.globalCompositeOperation=this.blendModes[CONST.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):(this.context.fillStyle=this._backgroundColorString,this.context.fillRect(0,0,this.width,this.height))),this.renderDisplayObject(e,this.context)},CanvasRenderer.prototype.destroy=function(e){this.destroyPlugins(),SystemRenderer.prototype.destroy.call(this,e),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},CanvasRenderer.prototype.renderDisplayObject=function(e,t){var s=this.context;this.context=t,e.renderCanvas(this),this.context=s},CanvasRenderer.prototype.resize=function(e,t){SystemRenderer.prototype.resize.call(this,e,t),this.smoothProperty&&(this.context[this.smoothProperty]=CONST.SCALE_MODES.DEFAULT===CONST.SCALE_MODES.LINEAR)},CanvasRenderer.prototype._mapBlendModes=function(){this.blendModes||(this.blendModes={},utils.canUseNewCanvasBlendModes()?(this.blendModes[CONST.BLEND_MODES.NORMAL]="source-over",this.blendModes[CONST.BLEND_MODES.ADD]="lighter",this.blendModes[CONST.BLEND_MODES.MULTIPLY]="multiply",this.blendModes[CONST.BLEND_MODES.SCREEN]="screen",this.blendModes[CONST.BLEND_MODES.OVERLAY]="overlay",this.blendModes[CONST.BLEND_MODES.DARKEN]="darken",this.blendModes[CONST.BLEND_MODES.LIGHTEN]="lighten",this.blendModes[CONST.BLEND_MODES.COLOR_DODGE]="color-dodge",this.blendModes[CONST.BLEND_MODES.COLOR_BURN]="color-burn",this.blendModes[CONST.BLEND_MODES.HARD_LIGHT]="hard-light",this.blendModes[CONST.BLEND_MODES.SOFT_LIGHT]="soft-light",this.blendModes[CONST.BLEND_MODES.DIFFERENCE]="difference",this.blendModes[CONST.BLEND_MODES.EXCLUSION]="exclusion",this.blendModes[CONST.BLEND_MODES.HUE]="hue",this.blendModes[CONST.BLEND_MODES.SATURATION]="saturate",this.blendModes[CONST.BLEND_MODES.COLOR]="color",this.blendModes[CONST.BLEND_MODES.LUMINOSITY]="luminosity"):(this.blendModes[CONST.BLEND_MODES.NORMAL]="source-over",this.blendModes[CONST.BLEND_MODES.ADD]="lighter",this.blendModes[CONST.BLEND_MODES.MULTIPLY]="source-over",this.blendModes[CONST.BLEND_MODES.SCREEN]="source-over",this.blendModes[CONST.BLEND_MODES.OVERLAY]="source-over",this.blendModes[CONST.BLEND_MODES.DARKEN]="source-over",this.blendModes[CONST.BLEND_MODES.LIGHTEN]="source-over",this.blendModes[CONST.BLEND_MODES.COLOR_DODGE]="source-over",this.blendModes[CONST.BLEND_MODES.COLOR_BURN]="source-over",this.blendModes[CONST.BLEND_MODES.HARD_LIGHT]="source-over",this.blendModes[CONST.BLEND_MODES.SOFT_LIGHT]="source-over",this.blendModes[CONST.BLEND_MODES.DIFFERENCE]="source-over",this.blendModes[CONST.BLEND_MODES.EXCLUSION]="source-over",this.blendModes[CONST.BLEND_MODES.HUE]="source-over",this.blendModes[CONST.BLEND_MODES.SATURATION]="source-over",this.blendModes[CONST.BLEND_MODES.COLOR]="source-over",this.blendModes[CONST.BLEND_MODES.LUMINOSITY]="source-over"))};
},{"../../const":30,"../../math":40,"../../utils":84,"../SystemRenderer":50,"./utils/CanvasMaskManager":54}],52:[function(require,module,exports){
function CanvasBuffer(t,n){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=t,this.canvas.height=n}CanvasBuffer.prototype.constructor=CanvasBuffer,module.exports=CanvasBuffer,Object.defineProperties(CanvasBuffer.prototype,{width:{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t}},height:{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t}}}),CanvasBuffer.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},CanvasBuffer.prototype.resize=function(t,n){this.canvas.width=t,this.canvas.height=n},CanvasBuffer.prototype.destroy=function(){this.context=null,this.canvas=null};
},{}],53:[function(require,module,exports){
var CONST=require("../../../const"),CanvasGraphics={};module.exports=CanvasGraphics,CanvasGraphics.renderGraphics=function(l,i){var e=l.worldAlpha;l.dirty&&(this.updateGraphicsTint(l),l.dirty=!1);for(var t=0;t<l.graphicsData.length;t++){var a=l.graphicsData[t],r=a.shape,o=a._fillTint,h=a._lineTint;if(i.lineWidth=a.lineWidth,a.type===CONST.SHAPES.POLY){i.beginPath();var n=r.points;i.moveTo(n[0],n[1]);for(var s=1;s<n.length/2;s++)i.lineTo(n[2*s],n[2*s+1]);r.closed&&i.lineTo(n[0],n[1]),n[0]===n[n.length-2]&&n[1]===n[n.length-1]&&i.closePath(),a.fill&&(i.globalAlpha=a.fillAlpha*e,i.fillStyle="#"+("00000"+(0|o).toString(16)).substr(-6),i.fill()),a.lineWidth&&(i.globalAlpha=a.lineAlpha*e,i.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.stroke())}else if(a.type===CONST.SHAPES.RECT)(a.fillColor||0===a.fillColor)&&(i.globalAlpha=a.fillAlpha*e,i.fillStyle="#"+("00000"+(0|o).toString(16)).substr(-6),i.fillRect(r.x,r.y,r.width,r.height)),a.lineWidth&&(i.globalAlpha=a.lineAlpha*e,i.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.strokeRect(r.x,r.y,r.width,r.height));else if(a.type===CONST.SHAPES.CIRC)i.beginPath(),i.arc(r.x,r.y,r.radius,0,2*Math.PI),i.closePath(),a.fill&&(i.globalAlpha=a.fillAlpha*e,i.fillStyle="#"+("00000"+(0|o).toString(16)).substr(-6),i.fill()),a.lineWidth&&(i.globalAlpha=a.lineAlpha*e,i.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.stroke());else if(a.type===CONST.SHAPES.ELIP){var p=2*r.width,T=2*r.height,S=r.x-p/2,g=r.y-T/2;i.beginPath();var v=.5522848,C=p/2*v,f=T/2*v,u=S+p,c=g+T,d=S+p/2,b=g+T/2;i.moveTo(S,b),i.bezierCurveTo(S,b-f,d-C,g,d,g),i.bezierCurveTo(d+C,g,u,b-f,u,b),i.bezierCurveTo(u,b+f,d+C,c,d,c),i.bezierCurveTo(d-C,c,S,b+f,S,b),i.closePath(),a.fill&&(i.globalAlpha=a.fillAlpha*e,i.fillStyle="#"+("00000"+(0|o).toString(16)).substr(-6),i.fill()),a.lineWidth&&(i.globalAlpha=a.lineAlpha*e,i.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.stroke())}else if(a.type===CONST.SHAPES.RREC){var y=r.x,A=r.y,P=r.width,E=r.height,O=r.radius,k=Math.min(P,E)/2|0;O=O>k?k:O,i.beginPath(),i.moveTo(y,A+O),i.lineTo(y,A+E-O),i.quadraticCurveTo(y,A+E,y+O,A+E),i.lineTo(y+P-O,A+E),i.quadraticCurveTo(y+P,A+E,y+P,A+E-O),i.lineTo(y+P,A+O),i.quadraticCurveTo(y+P,A,y+P-O,A),i.lineTo(y+O,A),i.quadraticCurveTo(y,A,y,A+O),i.closePath(),(a.fillColor||0===a.fillColor)&&(i.globalAlpha=a.fillAlpha*e,i.fillStyle="#"+("00000"+(0|o).toString(16)).substr(-6),i.fill()),a.lineWidth&&(i.globalAlpha=a.lineAlpha*e,i.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.stroke())}}},CanvasGraphics.renderGraphicsMask=function(l,i){var e=l.graphicsData.length;if(0!==e){i.beginPath();for(var t=0;e>t;t++){var a=l.graphicsData[t],r=a.shape;if(a.type===CONST.SHAPES.POLY){var o=r.points;i.moveTo(o[0],o[1]);for(var h=1;h<o.length/2;h++)i.lineTo(o[2*h],o[2*h+1]);o[0]===o[o.length-2]&&o[1]===o[o.length-1]&&i.closePath()}else if(a.type===CONST.SHAPES.RECT)i.rect(r.x,r.y,r.width,r.height),i.closePath();else if(a.type===CONST.SHAPES.CIRC)i.arc(r.x,r.y,r.radius,0,2*Math.PI),i.closePath();else if(a.type===CONST.SHAPES.ELIP){var n=2*r.width,s=2*r.height,p=r.x-n/2,T=r.y-s/2,S=.5522848,g=n/2*S,v=s/2*S,C=p+n,f=T+s,u=p+n/2,c=T+s/2;i.moveTo(p,c),i.bezierCurveTo(p,c-v,u-g,T,u,T),i.bezierCurveTo(u+g,T,C,c-v,C,c),i.bezierCurveTo(C,c+v,u+g,f,u,f),i.bezierCurveTo(u-g,f,p,c+v,p,c),i.closePath()}else if(a.type===CONST.SHAPES.RREC){var d=r.x,b=r.y,y=r.width,A=r.height,P=r.radius,E=Math.min(y,A)/2|0;P=P>E?E:P,i.moveTo(d,b+P),i.lineTo(d,b+A-P),i.quadraticCurveTo(d,b+A,d+P,b+A),i.lineTo(d+y-P,b+A),i.quadraticCurveTo(d+y,b+A,d+y,b+A-P),i.lineTo(d+y,b+P),i.quadraticCurveTo(d+y,b,d+y-P,b),i.lineTo(d+P,b),i.quadraticCurveTo(d,b,d,b+P),i.closePath()}}}},CanvasGraphics.updateGraphicsTint=function(l){if(16777215!==l.tint||l._prevTint!==l.tint){l._prevTint=l.tint;for(var i=(l.tint>>16&255)/255,e=(l.tint>>8&255)/255,t=(255&l.tint)/255,a=0;a<l.graphicsData.length;a++){var r=l.graphicsData[a],o=0|r.fillColor,h=0|r.lineColor;r._fillTint=((o>>16&255)/255*i*255<<16)+((o>>8&255)/255*e*255<<8)+(255&o)/255*t*255,r._lineTint=((h>>16&255)/255*i*255<<16)+((h>>8&255)/255*e*255<<8)+(255&h)/255*t*255}}};
},{"../../../const":30}],54:[function(require,module,exports){
function CanvasMaskManager(){}var CanvasGraphics=require("./CanvasGraphics");CanvasMaskManager.prototype.constructor=CanvasMaskManager,module.exports=CanvasMaskManager,CanvasMaskManager.prototype.pushMask=function(a,n){n.context.save();var r=a.alpha,s=a.worldTransform,t=n.resolution;n.context.setTransform(s.a*t,s.b*t,s.c*t,s.d*t,s.tx*t,s.ty*t),a.texture||(CanvasGraphics.renderGraphicsMask(a,n.context),n.context.clip()),a.worldAlpha=r},CanvasMaskManager.prototype.popMask=function(a){a.context.restore()},CanvasMaskManager.prototype.destroy=function(){};
},{"./CanvasGraphics":53}],55:[function(require,module,exports){
var utils=require("../../../utils"),CanvasTinter={};module.exports=CanvasTinter,CanvasTinter.getTintedTexture=function(t,e){var i=t.texture;e=CanvasTinter.roundColor(e);var a="#"+("00000"+(0|e).toString(16)).substr(-6);if(i.tintCache=i.tintCache||{},i.tintCache[a])return i.tintCache[a];var n=CanvasTinter.canvas||document.createElement("canvas");if(CanvasTinter.tintMethod(i,e,n),CanvasTinter.convertTintToImage){var r=new Image;r.src=n.toDataURL(),i.tintCache[a]=r}else i.tintCache[a]=n,CanvasTinter.canvas=null;return n},CanvasTinter.tintWithMultiply=function(t,e,i){var a=i.getContext("2d"),n=t.baseTexture.resolution,r=t.crop.clone();r.x*=n,r.y*=n,r.width*=n,r.height*=n,i.width=r.width,i.height=r.height,a.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),a.fillRect(0,0,r.width,r.height),a.globalCompositeOperation="multiply",a.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height),a.globalCompositeOperation="destination-atop",a.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)},CanvasTinter.tintWithOverlay=function(t,e,i){var a=i.getContext("2d"),n=t.baseTexture.resolution,r=t.crop.clone();r.x*=n,r.y*=n,r.width*=n,r.height*=n,i.width=r.width,i.height=r.height,a.globalCompositeOperation="copy",a.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),a.fillRect(0,0,r.width,r.height),a.globalCompositeOperation="destination-atop",a.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)},CanvasTinter.tintWithPerPixel=function(t,e,i){var a=i.getContext("2d"),n=t.baseTexture.resolution,r=t.crop.clone();r.x*=n,r.y*=n,r.width*=n,r.height*=n,i.width=r.width,i.height=r.height,a.globalCompositeOperation="copy",a.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height);for(var h=utils.hex2rgb(e),o=h[0],s=h[1],l=h[2],g=a.getImageData(0,0,r.width,r.height),u=g.data,C=0;C<u.length;C+=4)u[C+0]*=o,u[C+1]*=s,u[C+2]*=l;a.putImageData(g,0,0)},CanvasTinter.roundColor=function(t){var e=CanvasTinter.cacheStepsPerColorChannel,i=utils.hex2rgb(t);return i[0]=Math.min(255,i[0]/e*e),i[1]=Math.min(255,i[1]/e*e),i[2]=Math.min(255,i[2]/e*e),utils.rgb2hex(i)},CanvasTinter.cacheStepsPerColorChannel=8,CanvasTinter.convertTintToImage=!1,CanvasTinter.canUseMultiply=utils.canUseNewCanvasBlendModes(),CanvasTinter.tintMethod=CanvasTinter.canUseMultiply?CanvasTinter.tintWithMultiply:CanvasTinter.tintWithPerPixel;
},{"../../../utils":84}],56:[function(require,module,exports){
function WebGLRenderer(e,t,r){r=r||{},SystemRenderer.call(this,"WebGL",e,t,r),this.type=CONST.RENDERER_TYPE.WEBGL,this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.handleContextLost,!1),this.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1),this._useFXAA=!!r.forceFXAA&&r.antialias,this._FXAAFilter=null,this._contextOptions={alpha:this.transparent,antialias:r.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:r.preserveDrawingBuffer},this.drawCount=0,this.shaderManager=new ShaderManager(this),this.maskManager=new MaskManager(this),this.stencilManager=new StencilManager(this),this.filterManager=new FilterManager(this),this.blendModeManager=new BlendModeManager(this),this.currentRenderTarget=null,this.currentRenderer=new ObjectRenderer(this),this.initPlugins(),this._createContext(),this._initContext(),this._mapGlModes(),this._renderTargetStack=[]}var SystemRenderer=require("../SystemRenderer"),ShaderManager=require("./managers/ShaderManager"),MaskManager=require("./managers/MaskManager"),StencilManager=require("./managers/StencilManager"),FilterManager=require("./managers/FilterManager"),BlendModeManager=require("./managers/BlendModeManager"),RenderTarget=require("./utils/RenderTarget"),ObjectRenderer=require("./utils/ObjectRenderer"),FXAAFilter=require("./filters/FXAAFilter"),utils=require("../../utils"),CONST=require("../../const");WebGLRenderer.prototype=Object.create(SystemRenderer.prototype),WebGLRenderer.prototype.constructor=WebGLRenderer,module.exports=WebGLRenderer,utils.pluginTarget.mixin(WebGLRenderer),WebGLRenderer.glContextId=0,WebGLRenderer.prototype._createContext=function(){var e=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(this.gl=e,!e)throw new Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=WebGLRenderer.glContextId++,e.id=this.glContextId,e.renderer=this},WebGLRenderer.prototype._initContext=function(){var e=this.gl;e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),this.renderTarget=new RenderTarget(e,this.width,this.height,null,this.resolution,!0),this.setRenderTarget(this.renderTarget),this.emit("context",e),this.resize(this.width,this.height),this._useFXAA||(this._useFXAA=this._contextOptions.antialias&&!e.getContextAttributes().antialias),this._useFXAA&&(window.console.warn("FXAA antialiasing being used instead of native antialiasing"),this._FXAAFilter=[new FXAAFilter])},WebGLRenderer.prototype.render=function(e){if(!this.gl.isContextLost()){this.drawCount=0,this._lastObjectRendered=e,this._useFXAA&&(this._FXAAFilter[0].uniforms.resolution.value.x=this.width,this._FXAAFilter[0].uniforms.resolution.value.y=this.height,e.filterArea=this.renderTarget.size,e.filters=this._FXAAFilter);var t=e.parent;e.parent=this._tempDisplayObjectParent,e.updateTransform(),e.parent=t;var r=this.gl;this.setRenderTarget(this.renderTarget),this.clearBeforeRender&&(this.transparent?r.clearColor(0,0,0,0):r.clearColor(this._backgroundColorRgb[0],this._backgroundColorRgb[1],this._backgroundColorRgb[2],1),r.clear(r.COLOR_BUFFER_BIT)),this.renderDisplayObject(e,this.renderTarget)}},WebGLRenderer.prototype.renderDisplayObject=function(e,t,r){this.setRenderTarget(t),r&&t.clear(),this.filterManager.setFilterStack(t.filterStack),e.renderWebGL(this),this.currentRenderer.flush()},WebGLRenderer.prototype.setObjectRenderer=function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},WebGLRenderer.prototype.setRenderTarget=function(e){this.currentRenderTarget!==e&&(this.currentRenderTarget=e,this.currentRenderTarget.activate(),this.stencilManager.setMaskStack(e.stencilMaskStack))},WebGLRenderer.prototype.resize=function(e,t){SystemRenderer.prototype.resize.call(this,e,t),this.filterManager.resize(e,t),this.renderTarget.resize(e,t),this.currentRenderTarget===this.renderTarget&&(this.renderTarget.activate(),this.gl.viewport(0,0,this.width,this.height))},WebGLRenderer.prototype.updateTexture=function(e){if(e=e.baseTexture||e,e.hasLoaded){var t=this.gl;return e._glTextures[t.id]||(e._glTextures[t.id]=t.createTexture(),e.on("update",this.updateTexture,this),e.on("dispose",this.destroyTexture,this)),t.bindTexture(t.TEXTURE_2D,e._glTextures[t.id]),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultipliedAlpha),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e.source),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e.scaleMode===CONST.SCALE_MODES.LINEAR?t.LINEAR:t.NEAREST),e.mipmap&&e.isPowerOfTwo?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e.scaleMode===CONST.SCALE_MODES.LINEAR?t.LINEAR_MIPMAP_LINEAR:t.NEAREST_MIPMAP_NEAREST),t.generateMipmap(t.TEXTURE_2D)):t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e.scaleMode===CONST.SCALE_MODES.LINEAR?t.LINEAR:t.NEAREST),e.isPowerOfTwo?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),e._glTextures[t.id]}},WebGLRenderer.prototype.destroyTexture=function(e){e=e.baseTexture||e,e.hasLoaded&&e._glTextures[this.gl.id]&&this.gl.deleteTexture(e._glTextures[this.gl.id])},WebGLRenderer.prototype.handleContextLost=function(e){e.preventDefault()},WebGLRenderer.prototype.handleContextRestored=function(){this._initContext();for(var e in utils.BaseTextureCache)utils.BaseTextureCache[e]._glTextures.length=0},WebGLRenderer.prototype.destroy=function(e){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored);for(var t in utils.BaseTextureCache){var r=utils.BaseTextureCache[t];r.off("update",this.updateTexture,this),r.off("dispose",this.destroyTexture,this)}SystemRenderer.prototype.destroy.call(this,e),this.uid=0,this.shaderManager.destroy(),this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.blendModeManager.destroy(),this.shaderManager=null,this.maskManager=null,this.filterManager=null,this.blendModeManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.drawCount=0,this.gl.useProgram(null),this.gl=null},WebGLRenderer.prototype._mapGlModes=function(){var e=this.gl;this.blendModes||(this.blendModes={},this.blendModes[CONST.BLEND_MODES.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.ADD]=[e.SRC_ALPHA,e.DST_ALPHA],this.blendModes[CONST.BLEND_MODES.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.SCREEN]=[e.SRC_ALPHA,e.ONE],this.blendModes[CONST.BLEND_MODES.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA]),this.drawModes||(this.drawModes={},this.drawModes[CONST.DRAW_MODES.POINTS]=e.POINTS,this.drawModes[CONST.DRAW_MODES.LINES]=e.LINES,this.drawModes[CONST.DRAW_MODES.LINE_LOOP]=e.LINE_LOOP,this.drawModes[CONST.DRAW_MODES.LINE_STRIP]=e.LINE_STRIP,this.drawModes[CONST.DRAW_MODES.TRIANGLES]=e.TRIANGLES,this.drawModes[CONST.DRAW_MODES.TRIANGLE_STRIP]=e.TRIANGLE_STRIP,this.drawModes[CONST.DRAW_MODES.TRIANGLE_FAN]=e.TRIANGLE_FAN)};
},{"../../const":30,"../../utils":84,"../SystemRenderer":50,"./filters/FXAAFilter":58,"./managers/BlendModeManager":60,"./managers/FilterManager":61,"./managers/MaskManager":62,"./managers/ShaderManager":63,"./managers/StencilManager":64,"./utils/ObjectRenderer":70,"./utils/RenderTarget":72}],57:[function(require,module,exports){
function AbstractFilter(t,r,e){this.shaders=[],this.padding=0,this.uniforms=e||{},this.vertexSrc=t||DefaultShader.defaultVertexSrc,this.fragmentSrc=r||DefaultShader.defaultFragmentSrc}var DefaultShader=require("../shaders/TextureShader");AbstractFilter.prototype.constructor=AbstractFilter,module.exports=AbstractFilter,AbstractFilter.prototype.getShader=function(t){var r=t.gl,e=this.shaders[r.id];return e||(e=new DefaultShader(t.shaderManager,this.vertexSrc,this.fragmentSrc,this.uniforms,this.attributes),this.shaders[r.id]=e),e},AbstractFilter.prototype.applyFilter=function(t,r,e,a){var s=this.getShader(t);t.filterManager.applyFilter(s,r,e,a)},AbstractFilter.prototype.syncUniform=function(t){for(var r=0,e=this.shaders.length;e>r;++r)this.shaders[r].syncUniform(t)};
},{"../shaders/TextureShader":69}],58:[function(require,module,exports){
function FXAAFilter(){AbstractFilter.call(this,"\nprecision mediump float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform vec2 resolution;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvarying vec2 vResolution;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n            out vec2 v_rgbNW, out vec2 v_rgbNE,\n            out vec2 v_rgbSW, out vec2 v_rgbSE,\n            out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n   vResolution = resolution;\n\n   //compute the texture coords and send them to varyings\n   texcoords(aTextureCoord * resolution, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'precision lowp float;\n\n\n/**\nBasic FXAA implementation based on the code on geeks3d.com with the\nmodification that the texture2DLod stuff was removed since it\'s\nunsupported by WebGL.\n\n--\n\nFrom:\nhttps://github.com/mitsuhiko/webgl-meincraft\n\nCopyright (c) 2011 by Armin Ronacher.\n\nSome rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are\nmet:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n\n    * Redistributions in binary form must reproduce the above\n      copyright notice, this list of conditions and the following\n      disclaimer in the documentation and/or other materials provided\n      with the distribution.\n\n    * The names of the contributors may not be used to endorse or\n      promote products derived from this software without specific\n      prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\nOWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n#ifndef FXAA_REDUCE_MIN\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n    #define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n            vec2 v_rgbNW, vec2 v_rgbNE,\n            vec2 v_rgbSW, vec2 v_rgbSE,\n            vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n        texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vResolution;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform sampler2D uSampler;\n\n\nvoid main(void){\n\n    gl_FragColor = fxaa(uSampler, vTextureCoord * vResolution, vResolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n}\n',{resolution:{type:"v2",value:{x:1,y:1}}})}var AbstractFilter=require("./AbstractFilter");FXAAFilter.prototype=Object.create(AbstractFilter.prototype),FXAAFilter.prototype.constructor=FXAAFilter,module.exports=FXAAFilter,FXAAFilter.prototype.applyFilter=function(e,n,r){var o=e.filterManager,t=this.getShader(e);o.applyFilter(t,n,r)};
},{"./AbstractFilter":57}],59:[function(require,module,exports){
function SpriteMaskFilter(t){var r=new math.Matrix;AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform sampler2D mask;\n\nvoid main(void)\n{\n    // check clip! this will stop the mask bleeding out from the edges\n    vec2 text = abs( vMaskCoord - 0.5 );\n    text = step(0.5, text);\n    float clip = 1.0 - max(text.y, text.x);\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    original *= (masky.r * masky.a * alpha * clip);\n    gl_FragColor = original;\n}\n",{mask:{type:"sampler2D",value:t._texture},alpha:{type:"f",value:1},otherMatrix:{type:"mat3",value:r.toArray(!0)}}),this.maskSprite=t,this.maskMatrix=r}var AbstractFilter=require("./AbstractFilter"),math=require("../../../math");SpriteMaskFilter.prototype=Object.create(AbstractFilter.prototype),SpriteMaskFilter.prototype.constructor=SpriteMaskFilter,module.exports=SpriteMaskFilter,SpriteMaskFilter.prototype.applyFilter=function(t,r,e){var a=t.filterManager;this.uniforms.mask.value=this.maskSprite._texture,a.calculateMappedMatrix(r.frame,this.maskSprite,this.maskMatrix),this.uniforms.otherMatrix.value=this.maskMatrix.toArray(!0),this.uniforms.alpha.value=this.maskSprite.worldAlpha;var i=this.getShader(t);a.applyFilter(i,r,e)},Object.defineProperties(SpriteMaskFilter.prototype,{map:{get:function(){return this.uniforms.mask.value},set:function(t){this.uniforms.mask.value=t}},offset:{get:function(){return this.uniforms.offset.value},set:function(t){this.uniforms.offset.value=t}}});
},{"../../../math":40,"./AbstractFilter":57}],60:[function(require,module,exports){
function BlendModeManager(e){WebGLManager.call(this,e),this.currentBlendMode=99999}var WebGLManager=require("./WebGLManager");BlendModeManager.prototype=Object.create(WebGLManager.prototype),BlendModeManager.prototype.constructor=BlendModeManager,module.exports=BlendModeManager,BlendModeManager.prototype.setBlendMode=function(e){if(this.currentBlendMode===e)return!1;this.currentBlendMode=e;var r=this.renderer.blendModes[this.currentBlendMode];return this.renderer.gl.blendFunc(r[0],r[1]),!0};
},{"./WebGLManager":65}],61:[function(require,module,exports){
function FilterManager(e){WebGLManager.call(this,e),this.filterStack=[],this.filterStack.push({renderTarget:e.currentRenderTarget,filter:[],bounds:null}),this.texturePool=[],this.textureSize=new math.Rectangle(0,0,e.width,e.height),this.currentFrame=null}var WebGLManager=require("./WebGLManager"),RenderTarget=require("../utils/RenderTarget"),CONST=require("../../../const"),Quad=require("../utils/Quad"),math=require("../../../math");FilterManager.prototype=Object.create(WebGLManager.prototype),FilterManager.prototype.constructor=FilterManager,module.exports=FilterManager,FilterManager.prototype.onContextChange=function(){this.texturePool.length=0;var e=this.renderer.gl;this.quad=new Quad(e)},FilterManager.prototype.setFilterStack=function(e){this.filterStack=e},FilterManager.prototype.pushFilter=function(e,t){var r=e.filterArea?e.filterArea.clone():e.getBounds();r.x=0|r.x,r.y=0|r.y,r.width=0|r.width,r.height=0|r.height;var i=0|t[0].padding;if(r.x-=i,r.y-=i,r.width+=2*i,r.height+=2*i,this.renderer.currentRenderTarget.transform){var a=this.renderer.currentRenderTarget.transform;r.x+=a.tx,r.y+=a.ty,this.capFilterArea(r),r.x-=a.tx,r.y-=a.ty}else this.capFilterArea(r);if(r.width>0&&r.height>0){this.currentFrame=r;var n=this.getRenderTarget();this.renderer.setRenderTarget(n),n.clear(),this.filterStack.push({renderTarget:n,filter:t})}else this.filterStack.push({renderTarget:null,filter:t})},FilterManager.prototype.popFilter=function(){var e=this.filterStack.pop(),t=this.filterStack[this.filterStack.length-1],r=e.renderTarget;if(e.renderTarget){var i=t.renderTarget,a=this.renderer.gl;this.currentFrame=r.frame,this.quad.map(this.textureSize,r.frame),a.bindBuffer(a.ARRAY_BUFFER,this.quad.vertexBuffer),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.quad.indexBuffer);var n=e.filter;if(a.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aVertexPosition,2,a.FLOAT,!1,0,0),a.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aTextureCoord,2,a.FLOAT,!1,0,32),a.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aColor,4,a.FLOAT,!1,0,64),this.renderer.blendModeManager.setBlendMode(CONST.BLEND_MODES.NORMAL),1===n.length)n[0].uniforms.dimensions&&(n[0].uniforms.dimensions.value[0]=this.renderer.width,n[0].uniforms.dimensions.value[1]=this.renderer.height,n[0].uniforms.dimensions.value[2]=this.quad.vertices[0],n[0].uniforms.dimensions.value[3]=this.quad.vertices[5]),n[0].applyFilter(this.renderer,r,i),this.returnRenderTarget(r);else{for(var h=r,s=this.getRenderTarget(!0),o=0;o<n.length-1;o++){var u=n[o];u.uniforms.dimensions&&(u.uniforms.dimensions.value[0]=this.renderer.width,u.uniforms.dimensions.value[1]=this.renderer.height,u.uniforms.dimensions.value[2]=this.quad.vertices[0],u.uniforms.dimensions.value[3]=this.quad.vertices[5]),u.applyFilter(this.renderer,h,s);var d=h;h=s,s=d}n[n.length-1].applyFilter(this.renderer,h,i),this.returnRenderTarget(h),this.returnRenderTarget(s)}return e.filter}},FilterManager.prototype.getRenderTarget=function(e){var t=this.texturePool.pop()||new RenderTarget(this.renderer.gl,this.textureSize.width,this.textureSize.height,CONST.SCALE_MODES.LINEAR,this.renderer.resolution*CONST.FILTER_RESOLUTION);return t.frame=this.currentFrame,e&&t.clear(!0),t},FilterManager.prototype.returnRenderTarget=function(e){this.texturePool.push(e)},FilterManager.prototype.applyFilter=function(e,t,r,i){var a=this.renderer.gl;this.renderer.setRenderTarget(r),i&&r.clear(),this.renderer.shaderManager.setShader(e),e.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(!0),e.syncUniforms(),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,t.texture),a.drawElements(a.TRIANGLES,6,a.UNSIGNED_SHORT,0),this.renderer.drawCount++},FilterManager.prototype.calculateMappedMatrix=function(e,t,r){var i=t.worldTransform.copy(math.Matrix.TEMP_MATRIX),a=t._texture.baseTexture,n=r.identity(),h=this.textureSize.height/this.textureSize.width;n.translate(e.x/this.textureSize.width,e.y/this.textureSize.height),n.scale(1,h);var s=this.textureSize.width/a.width,o=this.textureSize.height/a.height;return i.tx/=a.width*s,i.ty/=a.width*s,i.invert(),n.prepend(i),n.scale(1,1/h),n.scale(s,o),n.translate(t.anchor.x,t.anchor.y),n},FilterManager.prototype.capFilterArea=function(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0),e.x+e.width>this.textureSize.width&&(e.width=this.textureSize.width-e.x),e.y+e.height>this.textureSize.height&&(e.height=this.textureSize.height-e.y)},FilterManager.prototype.resize=function(e,t){this.textureSize.width=e,this.textureSize.height=t;for(var r=0;r<this.texturePool.length;r++)this.texturePool[r].resize(e,t)},FilterManager.prototype.destroy=function(){this.quad.destroy(),WebGLManager.prototype.destroy.call(this),this.filterStack=null,this.offsetY=0;for(var e=0;e<this.texturePool.length;e++)this.texturePool[e].destroy();this.texturePool=null};
},{"../../../const":30,"../../../math":40,"../utils/Quad":71,"../utils/RenderTarget":72,"./WebGLManager":65}],62:[function(require,module,exports){
function MaskManager(a){WebGLManager.call(this,a),this.stencilStack=[],this.reverse=!0,this.count=0,this.alphaMaskPool=[]}var WebGLManager=require("./WebGLManager"),AlphaMaskFilter=require("../filters/SpriteMaskFilter");MaskManager.prototype=Object.create(WebGLManager.prototype),MaskManager.prototype.constructor=MaskManager,module.exports=MaskManager,MaskManager.prototype.pushMask=function(a,e){e.texture?this.pushSpriteMask(a,e):this.pushStencilMask(a,e)},MaskManager.prototype.popMask=function(a,e){e.texture?this.popSpriteMask(a,e):this.popStencilMask(a,e)},MaskManager.prototype.pushSpriteMask=function(a,e){var t=this.alphaMaskPool.pop();t||(t=[new AlphaMaskFilter(e)]),t[0].maskSprite=e,this.renderer.filterManager.pushFilter(a,t)},MaskManager.prototype.popSpriteMask=function(){var a=this.renderer.filterManager.popFilter();this.alphaMaskPool.push(a)},MaskManager.prototype.pushStencilMask=function(a,e){this.renderer.stencilManager.pushMask(e)},MaskManager.prototype.popStencilMask=function(a,e){this.renderer.stencilManager.popMask(e)};
},{"../filters/SpriteMaskFilter":59,"./WebGLManager":65}],63:[function(require,module,exports){
function ShaderManager(t){WebGLManager.call(this,t),this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.stack=[],this._currentId=-1,this.currentShader=null}var WebGLManager=require("./WebGLManager"),TextureShader=require("../shaders/TextureShader"),ComplexPrimitiveShader=require("../shaders/ComplexPrimitiveShader"),PrimitiveShader=require("../shaders/PrimitiveShader"),utils=require("../../../utils");ShaderManager.prototype=Object.create(WebGLManager.prototype),ShaderManager.prototype.constructor=ShaderManager,utils.pluginTarget.mixin(ShaderManager),module.exports=ShaderManager,ShaderManager.prototype.onContextChange=function(){this.initPlugins();var t=this.renderer.gl;this.maxAttibs=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.attribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.defaultShader=new TextureShader(this),this.primitiveShader=new PrimitiveShader(this),this.complexPrimitiveShader=new ComplexPrimitiveShader(this)},ShaderManager.prototype.setAttribs=function(t){var e;for(e=0;e<this.tempAttribState.length;e++)this.tempAttribState[e]=!1;for(var r in t)this.tempAttribState[t[r]]=!0;var i=this.renderer.gl;for(e=0;e<this.attribState.length;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.attribState[e]?i.enableVertexAttribArray(e):i.disableVertexAttribArray(e))},ShaderManager.prototype.setShader=function(t){return this._currentId===t.uid?!1:(this._currentId=t.uid,this.currentShader=t,this.renderer.gl.useProgram(t.program),this.setAttribs(t.attributes),!0)},ShaderManager.prototype.destroy=function(){this.primitiveShader.destroy(),this.complexPrimitiveShader.destroy(),WebGLManager.prototype.destroy.call(this),this.destroyPlugins(),this.attribState=null,this.tempAttribState=null};
},{"../../../utils":84,"../shaders/ComplexPrimitiveShader":66,"../shaders/PrimitiveShader":67,"../shaders/TextureShader":69,"./WebGLManager":65}],64:[function(require,module,exports){
function WebGLMaskManager(e){WebGLManager.call(this,e),this.stencilMaskStack=null}var WebGLManager=require("./WebGLManager"),utils=require("../../../utils");WebGLMaskManager.prototype=Object.create(WebGLManager.prototype),WebGLMaskManager.prototype.constructor=WebGLMaskManager,module.exports=WebGLMaskManager,WebGLMaskManager.prototype.setMaskStack=function(e){this.stencilMaskStack=e;var r=this.renderer.gl;0===e.stencilStack.length?r.disable(r.STENCIL_TEST):r.enable(r.STENCIL_TEST)},WebGLMaskManager.prototype.pushStencil=function(e,r){this.renderer.currentRenderTarget.attachStencilBuffer();var t=this.renderer.gl,n=this.stencilMaskStack;this.bindGraphics(e,r),0===n.stencilStack.length&&(t.enable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),n.reverse=!0,n.count=0),n.stencilStack.push(r);var i=n.count;t.colorMask(!1,!1,!1,!1),t.stencilFunc(t.ALWAYS,0,255),t.stencilOp(t.KEEP,t.KEEP,t.INVERT),1===r.mode?(t.drawElements(t.TRIANGLE_FAN,r.indices.length-4,t.UNSIGNED_SHORT,0),n.reverse?(t.stencilFunc(t.EQUAL,255-i,255),t.stencilOp(t.KEEP,t.KEEP,t.DECR)):(t.stencilFunc(t.EQUAL,i,255),t.stencilOp(t.KEEP,t.KEEP,t.INCR)),t.drawElements(t.TRIANGLE_FAN,4,t.UNSIGNED_SHORT,2*(r.indices.length-4)),n.reverse?t.stencilFunc(t.EQUAL,255-(i+1),255):t.stencilFunc(t.EQUAL,i+1,255),n.reverse=!n.reverse):(n.reverse?(t.stencilFunc(t.EQUAL,i,255),t.stencilOp(t.KEEP,t.KEEP,t.INCR)):(t.stencilFunc(t.EQUAL,255-i,255),t.stencilOp(t.KEEP,t.KEEP,t.DECR)),t.drawElements(t.TRIANGLE_STRIP,r.indices.length,t.UNSIGNED_SHORT,0),n.reverse?t.stencilFunc(t.EQUAL,i+1,255):t.stencilFunc(t.EQUAL,255-(i+1),255)),t.colorMask(!0,!0,!0,!0),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),n.count++},WebGLMaskManager.prototype.bindGraphics=function(e,r){var t,n=this.renderer.gl;1===r.mode?(t=this.renderer.shaderManager.complexPrimitiveShader,this.renderer.shaderManager.setShader(t),n.uniformMatrix3fv(t.uniforms.translationMatrix._location,!1,e.worldTransform.toArray(!0)),n.uniformMatrix3fv(t.uniforms.projectionMatrix._location,!1,this.renderer.currentRenderTarget.projectionMatrix.toArray(!0)),n.uniform3fv(t.uniforms.tint._location,utils.hex2rgb(e.tint)),n.uniform3fv(t.uniforms.color._location,r.color),n.uniform1f(t.uniforms.alpha._location,e.worldAlpha),n.bindBuffer(n.ARRAY_BUFFER,r.buffer),n.vertexAttribPointer(t.attributes.aVertexPosition,2,n.FLOAT,!1,8,0),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r.indexBuffer)):(t=this.renderer.shaderManager.primitiveShader,this.renderer.shaderManager.setShader(t),n.uniformMatrix3fv(t.uniforms.translationMatrix._location,!1,e.worldTransform.toArray(!0)),n.uniformMatrix3fv(t.uniforms.projectionMatrix._location,!1,this.renderer.currentRenderTarget.projectionMatrix.toArray(!0)),n.uniform3fv(t.uniforms.tint._location,utils.hex2rgb(e.tint)),n.uniform1f(t.uniforms.alpha._location,e.worldAlpha),n.bindBuffer(n.ARRAY_BUFFER,r.buffer),n.vertexAttribPointer(t.attributes.aVertexPosition,2,n.FLOAT,!1,24,0),n.vertexAttribPointer(t.attributes.aColor,4,n.FLOAT,!1,24,8),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r.indexBuffer))},WebGLMaskManager.prototype.popStencil=function(e,r){var t=this.renderer.gl,n=this.stencilMaskStack;if(n.stencilStack.pop(),n.count--,0===n.stencilStack.length)t.disable(t.STENCIL_TEST);else{var i=n.count;this.bindGraphics(e,r),t.colorMask(!1,!1,!1,!1),1===r.mode?(n.reverse=!n.reverse,n.reverse?(t.stencilFunc(t.EQUAL,255-(i+1),255),t.stencilOp(t.KEEP,t.KEEP,t.INCR)):(t.stencilFunc(t.EQUAL,i+1,255),t.stencilOp(t.KEEP,t.KEEP,t.DECR)),t.drawElements(t.TRIANGLE_FAN,4,t.UNSIGNED_SHORT,2*(r.indices.length-4)),t.stencilFunc(t.ALWAYS,0,255),t.stencilOp(t.KEEP,t.KEEP,t.INVERT),t.drawElements(t.TRIANGLE_FAN,r.indices.length-4,t.UNSIGNED_SHORT,0),this.renderer.drawCount+=2,n.reverse?t.stencilFunc(t.EQUAL,i,255):t.stencilFunc(t.EQUAL,255-i,255)):(n.reverse?(t.stencilFunc(t.EQUAL,i+1,255),t.stencilOp(t.KEEP,t.KEEP,t.DECR)):(t.stencilFunc(t.EQUAL,255-(i+1),255),t.stencilOp(t.KEEP,t.KEEP,t.INCR)),t.drawElements(t.TRIANGLE_STRIP,r.indices.length,t.UNSIGNED_SHORT,0),this.renderer.drawCount++,n.reverse?t.stencilFunc(t.EQUAL,i,255):t.stencilFunc(t.EQUAL,255-i,255)),t.colorMask(!0,!0,!0,!0),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}},WebGLMaskManager.prototype.destroy=function(){WebGLManager.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},WebGLMaskManager.prototype.pushMask=function(e){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),e.dirty&&this.renderer.plugins.graphics.updateGraphics(e,this.renderer.gl),e._webGL[this.renderer.gl.id].data.length&&this.pushStencil(e,e._webGL[this.renderer.gl.id].data[0])},WebGLMaskManager.prototype.popMask=function(e){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.popStencil(e,e._webGL[this.renderer.gl.id].data[0])};
},{"../../../utils":84,"./WebGLManager":65}],65:[function(require,module,exports){
function WebGLManager(e){this.renderer=e,this.renderer.on("context",this.onContextChange,this)}WebGLManager.prototype.constructor=WebGLManager,module.exports=WebGLManager,WebGLManager.prototype.onContextChange=function(){},WebGLManager.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null};
},{}],66:[function(require,module,exports){
function ComplexPrimitiveShader(o){Shader.call(this,o,["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},color:{type:"3f",value:[0,0,0]},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0})}var Shader=require("./Shader");ComplexPrimitiveShader.prototype=Object.create(Shader.prototype),ComplexPrimitiveShader.prototype.constructor=ComplexPrimitiveShader,module.exports=ComplexPrimitiveShader;
},{"./Shader":68}],67:[function(require,module,exports){
function PrimitiveShader(t){Shader.call(this,t,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aColor:0})}var Shader=require("./Shader");PrimitiveShader.prototype=Object.create(Shader.prototype),PrimitiveShader.prototype.constructor=PrimitiveShader,module.exports=PrimitiveShader;
},{"./Shader":68}],68:[function(require,module,exports){
function Shader(r,e,a,t,i){if(!e||!a)throw new Error("Pixi.js Error. Shader requires vertexSrc and fragmentSrc");this.uid=utils.uid(),this.gl=r.renderer.gl,this.shaderManager=r,this.program=null,this.uniforms=t||{},this.attributes=i||{},this.textureCount=1,this.vertexSrc=e,this.fragmentSrc=a,this.init()}var utils=require("../../../utils");Shader.prototype.constructor=Shader,module.exports=Shader,Shader.prototype.init=function(){this.compile(),this.gl.useProgram(this.program),this.cacheUniformLocations(Object.keys(this.uniforms)),this.cacheAttributeLocations(Object.keys(this.attributes))},Shader.prototype.cacheUniformLocations=function(r){for(var e=0;e<r.length;++e)this.uniforms[r[e]]._location=this.gl.getUniformLocation(this.program,r[e])},Shader.prototype.cacheAttributeLocations=function(r){for(var e=0;e<r.length;++e)this.attributes[r[e]]=this.gl.getAttribLocation(this.program,r[e])},Shader.prototype.compile=function(){var r=this.gl,e=this._glCompile(r.VERTEX_SHADER,this.vertexSrc),a=this._glCompile(r.FRAGMENT_SHADER,this.fragmentSrc),t=r.createProgram();return r.attachShader(t,e),r.attachShader(t,a),r.linkProgram(t),r.getProgramParameter(t,r.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",r.getProgramParameter(t,r.VALIDATE_STATUS)),console.error("gl.getError()",r.getError()),""!==r.getProgramInfoLog(t)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(t)),r.deleteProgram(t),t=null),r.deleteShader(e),r.deleteShader(a),this.program=t},Shader.prototype.syncUniform=function(r){var e,a,t=r._location,i=r.value,o=this.gl;switch(r.type){case"b":case"bool":case"boolean":o.uniform1i(t,i?1:0);break;case"i":case"1i":o.uniform1i(t,i);break;case"f":case"1f":o.uniform1f(t,i);break;case"2f":o.uniform2f(t,i[0],i[1]);break;case"3f":o.uniform3f(t,i[0],i[1],i[2]);break;case"4f":o.uniform4f(t,i[0],i[1],i[2],i[3]);break;case"v2":o.uniform2f(t,i.x,i.y);break;case"v3":o.uniform3f(t,i.x,i.y,i.z);break;case"v4":o.uniform4f(t,i.x,i.y,i.z,i.w);break;case"1iv":o.uniform1iv(t,i);break;case"2iv":o.uniform2iv(t,i);break;case"3iv":o.uniform3iv(t,i);break;case"4iv":o.uniform4iv(t,i);break;case"1fv":o.uniform1fv(t,i);break;case"2fv":o.uniform2fv(t,i);break;case"3fv":o.uniform3fv(t,i);break;case"4fv":o.uniform4fv(t,i);break;case"m2":case"mat2":case"Matrix2fv":o.uniformMatrix2fv(t,r.transpose,i);break;case"m3":case"mat3":case"Matrix3fv":o.uniformMatrix3fv(t,r.transpose,i);break;case"m4":case"mat4":case"Matrix4fv":o.uniformMatrix4fv(t,r.transpose,i);break;case"c":"number"==typeof i&&(i=utils.hex2rgb(i)),o.uniform3f(t,i[0],i[1],i[2]);break;case"iv1":o.uniform1iv(t,i);break;case"iv":o.uniform3iv(t,i);break;case"fv1":o.uniform1fv(t,i);break;case"fv":o.uniform3fv(t,i);break;case"v2v":for(r._array||(r._array=new Float32Array(2*i.length)),e=0,a=i.length;a>e;++e)r._array[2*e]=i[e].x,r._array[2*e+1]=i[e].y;o.uniform2fv(t,r._array);break;case"v3v":for(r._array||(r._array=new Float32Array(3*i.length)),e=0,a=i.length;a>e;++e)r._array[3*e]=i[e].x,r._array[3*e+1]=i[e].y,r._array[3*e+2]=i[e].z;o.uniform3fv(t,r._array);break;case"v4v":for(r._array||(r._array=new Float32Array(4*i.length)),e=0,a=i.length;a>e;++e)r._array[4*e]=i[e].x,r._array[4*e+1]=i[e].y,r._array[4*e+2]=i[e].z,r._array[4*e+3]=i[e].w;o.uniform4fv(t,r._array);break;case"t":case"sampler2D":if(!r.value||!r.value.baseTexture.hasLoaded)break;o.activeTexture(o["TEXTURE"+this.textureCount]);var s=r.value.baseTexture._glTextures[o.id];s||(this.initSampler2D(r),s=r.value.baseTexture._glTextures[o.id]),o.bindTexture(o.TEXTURE_2D,s),o.uniform1i(r._location,this.textureCount),this.textureCount++;break;default:console.warn("Pixi.js Shader Warning: Unknown uniform type: "+r.type)}},Shader.prototype.syncUniforms=function(){this.textureCount=1;for(var r in this.uniforms)this.syncUniform(this.uniforms[r])},Shader.prototype.initSampler2D=function(r){var e=this.gl,a=r.value.baseTexture;if(a.hasLoaded)if(r.textureData){var t=r.textureData;a._glTextures[e.id]=e.createTexture(),e.bindTexture(e.TEXTURE_2D,a._glTextures[e.id]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultipliedAlpha),e.texImage2D(e.TEXTURE_2D,0,t.luminance?e.LUMINANCE:e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t.magFilter?t.magFilter:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.wrapS?t.wrapS:e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,t.wrapS?t.wrapS:e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,t.wrapT?t.wrapT:e.CLAMP_TO_EDGE)}else this.shaderManager.renderer.updateTexture(a)},Shader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.gl=null,this.uniforms=null,this.attributes=null,this.vertexSrc=null,this.fragmentSrc=null},Shader.prototype._glCompile=function(r,e){var a=this.gl.createShader(r);return this.gl.shaderSource(a,e),this.gl.compileShader(a),this.gl.getShaderParameter(a,this.gl.COMPILE_STATUS)?a:(console.log(this.gl.getShaderInfoLog(a)),null)};
},{"../../../utils":84}],69:[function(require,module,exports){
function TextureShader(e,r,o,t,a){var i={uSampler:{type:"sampler2D",value:0},projectionMatrix:{type:"mat3",value:new Float32Array([1,0,0,0,1,0,0,0,1])}};if(t)for(var u in t)i[u]=t[u];var v={aVertexPosition:0,aTextureCoord:0,aColor:0};if(a)for(var l in a)v[l]=a[l];r=r||TextureShader.defaultVertexSrc,o=o||TextureShader.defaultFragmentSrc,Shader.call(this,e,r,o,i,v)}var Shader=require("./Shader");TextureShader.prototype=Object.create(Shader.prototype),TextureShader.prototype.constructor=TextureShader,module.exports=TextureShader,TextureShader.defaultVertexSrc=["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"].join("\n"),TextureShader.defaultFragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"].join("\n");
},{"./Shader":68}],70:[function(require,module,exports){
function ObjectRenderer(e){WebGLManager.call(this,e)}var WebGLManager=require("../managers/WebGLManager");ObjectRenderer.prototype=Object.create(WebGLManager.prototype),ObjectRenderer.prototype.constructor=ObjectRenderer,module.exports=ObjectRenderer,ObjectRenderer.prototype.start=function(){},ObjectRenderer.prototype.stop=function(){this.flush()},ObjectRenderer.prototype.flush=function(){},ObjectRenderer.prototype.render=function(e){};
},{"../managers/WebGLManager":65}],71:[function(require,module,exports){
function Quad(t){this.gl=t,this.vertices=new Float32Array([0,0,200,0,200,200,0,200]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]),this.indices=new Uint16Array([0,1,2,0,3,2]),this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,128,t.DYNAMIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),this.upload()}Quad.prototype.constructor=Quad,Quad.prototype.map=function(t,e){var i=0,s=0;this.uvs[0]=i,this.uvs[1]=s,this.uvs[2]=i+e.width/t.width,this.uvs[3]=s,this.uvs[4]=i+e.width/t.width,this.uvs[5]=s+e.height/t.height,this.uvs[6]=i,this.uvs[7]=s+e.height/t.height,i=e.x,s=e.y,this.vertices[0]=i,this.vertices[1]=s,this.vertices[2]=i+e.width,this.vertices[3]=s,this.vertices[4]=i+e.width,this.vertices[5]=s+e.height,this.vertices[6]=i,this.vertices[7]=s+e.height,this.upload()},Quad.prototype.upload=function(){var t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices),t.bufferSubData(t.ARRAY_BUFFER,32,this.uvs),t.bufferSubData(t.ARRAY_BUFFER,64,this.colors)},Quad.prototype.destroy=function(){var t=this.gl;t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.indexBuffer)},module.exports=Quad;
},{}],72:[function(require,module,exports){
var math=require("../../../math"),utils=require("../../../utils"),CONST=require("../../../const"),StencilMaskStack=require("./StencilMaskStack"),RenderTarget=function(e,t,r,i,s,a){if(this.gl=e,this.frameBuffer=null,this.texture=null,this.size=new math.Rectangle(0,0,1,1),this.resolution=s||CONST.RESOLUTION,this.projectionMatrix=new math.Matrix,this.transform=null,this.frame=null,this.stencilBuffer=null,this.stencilMaskStack=new StencilMaskStack,this.filterStack=[{renderTarget:this,filter:[],bounds:this.size}],this.scaleMode=i||CONST.SCALE_MODES.DEFAULT,this.root=a,!this.root){this.frameBuffer=e.createFramebuffer(),this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i===CONST.SCALE_MODES.LINEAR?e.LINEAR:e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i===CONST.SCALE_MODES.LINEAR?e.LINEAR:e.NEAREST);var E=utils.isPowerOfTwo(t,r);E?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture,0)}this.resize(t,r)};RenderTarget.prototype.constructor=RenderTarget,module.exports=RenderTarget,RenderTarget.prototype.clear=function(e){var t=this.gl;e&&t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)},RenderTarget.prototype.attachStencilBuffer=function(){if(!this.stencilBuffer&&!this.root){var e=this.gl;this.stencilBuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this.stencilBuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,this.stencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,this.size.width*this.resolution,this.size.height*this.resolution)}},RenderTarget.prototype.activate=function(){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer);var t=this.frame||this.size;this.calculateProjection(t),this.transform&&this.projectionMatrix.append(this.transform),e.viewport(0,0,t.width*this.resolution,t.height*this.resolution)},RenderTarget.prototype.calculateProjection=function(e){var t=this.projectionMatrix;t.identity(),this.root?(t.a=1/e.width*2,t.d=-1/e.height*2,t.tx=-1-e.x*t.a,t.ty=1-e.y*t.d):(t.a=1/e.width*2,t.d=1/e.height*2,t.tx=-1-e.x*t.a,t.ty=-1-e.y*t.d)},RenderTarget.prototype.resize=function(e,t){if(e=0|e,t=0|t,this.size.width!==e||this.size.height!==t){if(this.size.width=e,this.size.height=t,!this.root){var r=this.gl;r.bindTexture(r.TEXTURE_2D,this.texture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e*this.resolution,t*this.resolution,0,r.RGBA,r.UNSIGNED_BYTE,null),this.stencilBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,this.stencilBuffer),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,e*this.resolution,t*this.resolution))}var i=this.frame||this.size;this.calculateProjection(i)}},RenderTarget.prototype.destroy=function(){var e=this.gl;e.deleteRenderbuffer(this.stencilBuffer),e.deleteFramebuffer(this.frameBuffer),e.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null};
},{"../../../const":30,"../../../math":40,"../../../utils":84,"./StencilMaskStack":73}],73:[function(require,module,exports){
function StencilMaskStack(){this.stencilStack=[],this.reverse=!0,this.count=0}StencilMaskStack.prototype.constructor=StencilMaskStack,module.exports=StencilMaskStack;
},{}],74:[function(require,module,exports){
function Sprite(t){Container.call(this),this.anchor=new math.Point,this._texture=null,this._width=0,this._height=0,this.tint=16777215,this.blendMode=CONST.BLEND_MODES.NORMAL,this.shader=null,this.cachedTint=16777215,this.texture=t||Texture.EMPTY}var math=require("../math"),Texture=require("../textures/Texture"),Container=require("../display/Container"),CanvasTinter=require("../renderers/canvas/utils/CanvasTinter"),utils=require("../utils"),CONST=require("../const"),tempPoint=new math.Point;Sprite.prototype=Object.create(Container.prototype),Sprite.prototype.constructor=Sprite,module.exports=Sprite,Object.defineProperties(Sprite.prototype,{width:{get:function(){return Math.abs(this.scale.x)*this.texture._frame.width},set:function(t){this.scale.x=utils.sign(this.scale.x)*t/this.texture._frame.width,this._width=t}},height:{get:function(){return Math.abs(this.scale.y)*this.texture._frame.height},set:function(t){this.scale.y=utils.sign(this.scale.y)*t/this.texture._frame.height,this._height=t}},texture:{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,this.cachedTint=16777215,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}}),Sprite.prototype._onTextureUpdate=function(){this._width&&(this.scale.x=utils.sign(this.scale.x)*this._width/this.texture.frame.width),this._height&&(this.scale.y=utils.sign(this.scale.y)*this._height/this.texture.frame.height)},Sprite.prototype._renderWebGL=function(t){t.setObjectRenderer(t.plugins.sprite),t.plugins.sprite.render(this)},Sprite.prototype.getBounds=function(t){if(!this._currentBounds){var e,i,r,h,s=this._texture._frame.width,o=this._texture._frame.height,n=s*(1-this.anchor.x),a=s*-this.anchor.x,u=o*(1-this.anchor.y),c=o*-this.anchor.y,d=t||this.worldTransform,x=d.a,p=d.b,l=d.c,m=d.d,_=d.tx,f=d.ty;if(0===p&&0===l)0>x&&(x*=-1),0>m&&(m*=-1),e=x*a+_,i=x*n+_,r=m*c+f,h=m*u+f;else{var y=x*a+l*c+_,g=m*c+p*a+f,w=x*n+l*c+_,T=m*c+p*n+f,b=x*n+l*u+_,S=m*u+p*n+f,v=x*a+l*u+_,C=m*u+p*a+f;e=y,e=e>w?w:e,e=e>b?b:e,e=e>v?v:e,r=g,r=r>T?T:r,r=r>S?S:r,r=r>C?C:r,i=y,i=w>i?w:i,i=b>i?b:i,i=v>i?v:i,h=g,h=T>h?T:h,h=S>h?S:h,h=C>h?C:h}if(this.children.length){var P=this.containerGetBounds();n=P.x,a=P.x+P.width,u=P.y,c=P.y+P.height,e=n>e?e:n,r=u>r?r:u,i=i>a?i:a,h=h>c?h:c}var O=this._bounds;O.x=e,O.width=i-e,O.y=r,O.height=h-r,this._currentBounds=O}return this._currentBounds},Sprite.prototype.getLocalBounds=function(){return this._bounds.x=-this._texture._frame.width*this.anchor.x,this._bounds.y=-this._texture._frame.height*this.anchor.y,this._bounds.width=this._texture._frame.width,this._bounds.height=this._texture._frame.height,this._bounds},Sprite.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,tempPoint);var e,i=this._texture._frame.width,r=this._texture._frame.height,h=-i*this.anchor.x;return tempPoint.x>h&&tempPoint.x<h+i&&(e=-r*this.anchor.y,tempPoint.y>e&&tempPoint.y<e+r)?!0:!1},Sprite.prototype._renderCanvas=function(t){if(!(this.texture.crop.width<=0||this.texture.crop.height<=0)){var e=t.blendModes[this.blendMode];if(e!==t.context.globalCompositeOperation&&(t.context.globalCompositeOperation=e),this.texture.valid){var i,r,h,s,o=this._texture,n=this.worldTransform;t.context.globalAlpha=this.worldAlpha;var a=o.baseTexture.scaleMode===CONST.SCALE_MODES.LINEAR;if(t.smoothProperty&&t.context[t.smoothProperty]!==a&&(t.context[t.smoothProperty]=a),o.rotate){var u=n.a,c=n.b;n.a=-n.c,n.b=-n.d,n.c=u,n.d=c,h=o.crop.height,s=o.crop.width,i=o.trim?o.trim.y-this.anchor.y*o.trim.height:this.anchor.y*-o._frame.height,r=o.trim?o.trim.x-this.anchor.x*o.trim.width:this.anchor.x*-o._frame.width}else h=o.crop.width,s=o.crop.height,i=o.trim?o.trim.x-this.anchor.x*o.trim.width:this.anchor.x*-o._frame.width,r=o.trim?o.trim.y-this.anchor.y*o.trim.height:this.anchor.y*-o._frame.height;t.roundPixels?(t.context.setTransform(n.a,n.b,n.c,n.d,n.tx*t.resolution|0,n.ty*t.resolution|0),i=0|i,r=0|r):t.context.setTransform(n.a,n.b,n.c,n.d,n.tx*t.resolution,n.ty*t.resolution);var d=o.baseTexture.resolution;16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=CanvasTinter.getTintedTexture(this,this.tint)),t.context.drawImage(this.tintedTexture,0,0,h*d,s*d,i*t.resolution,r*t.resolution,h*t.resolution,s*t.resolution)):t.context.drawImage(o.baseTexture.source,o.crop.x*d,o.crop.y*d,h*d,s*d,i*t.resolution,r*t.resolution,h*t.resolution,s*t.resolution)}}},Sprite.prototype.destroy=function(t,e){Container.prototype.destroy.call(this),this.anchor=null,t&&this._texture.destroy(e),this._texture=null,this.shader=null},Sprite.fromFrame=function(t){var e=utils.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return new Sprite(e)},Sprite.fromImage=function(t,e,i){return new Sprite(Texture.fromImage(t,e,i))};
},{"../const":30,"../display/Container":31,"../math":40,"../renderers/canvas/utils/CanvasTinter":55,"../textures/Texture":79,"../utils":84}],75:[function(require,module,exports){
function SpriteRenderer(e){ObjectRenderer.call(this,e),this.vertSize=5,this.vertByteSize=4*this.vertSize,this.size=CONST.SPRITE_BATCH_SIZE;var r=4*this.size*this.vertByteSize,t=6*this.size;this.vertices=new ArrayBuffer(r),this.positions=new Float32Array(this.vertices),this.colors=new Uint32Array(this.vertices),this.indices=new Uint16Array(t);for(var i=0,s=0;t>i;i+=6,s+=4)this.indices[i+0]=s+0,this.indices[i+1]=s+1,this.indices[i+2]=s+2,this.indices[i+3]=s+0,this.indices[i+4]=s+2,this.indices[i+5]=s+3;this.currentBatchSize=0,this.sprites=[],this.shader=null}var ObjectRenderer=require("../../renderers/webgl/utils/ObjectRenderer"),WebGLRenderer=require("../../renderers/webgl/WebGLRenderer"),CONST=require("../../const");SpriteRenderer.prototype=Object.create(ObjectRenderer.prototype),SpriteRenderer.prototype.constructor=SpriteRenderer,module.exports=SpriteRenderer,WebGLRenderer.registerPlugin("sprite",SpriteRenderer),SpriteRenderer.prototype.onContextChange=function(){var e=this.renderer.gl;this.shader=this.renderer.shaderManager.defaultShader,this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW),this.currentBlendMode=99999},SpriteRenderer.prototype.render=function(e){var r=e._texture;this.currentBatchSize>=this.size&&this.flush();var t=r._uvs;if(t){var i,s,n,h,d=e.anchor.x,a=e.anchor.y;if(r.trim&&void 0===e.tileScale){var o=r.trim;s=o.x-d*o.width,i=s+r.crop.width,h=o.y-a*o.height,n=h+r.crop.height}else i=r._frame.width*(1-d),s=r._frame.width*-d,n=r._frame.height*(1-a),h=r._frame.height*-a;var u=this.currentBatchSize*this.vertByteSize,c=e.worldTransform,f=c.a,l=c.b,R=c.c,B=c.d,p=c.tx,S=c.ty,v=this.colors,x=this.positions;this.renderer.roundPixels?(x[u]=f*s+R*h+p|0,x[u+1]=B*h+l*s+S|0,x[u+5]=f*i+R*h+p|0,x[u+6]=B*h+l*i+S|0,x[u+10]=f*i+R*n+p|0,x[u+11]=B*n+l*i+S|0,x[u+15]=f*s+R*n+p|0,x[u+16]=B*n+l*s+S|0):(x[u]=f*s+R*h+p,x[u+1]=B*h+l*s+S,x[u+5]=f*i+R*h+p,x[u+6]=B*h+l*i+S,x[u+10]=f*i+R*n+p,x[u+11]=B*n+l*i+S,x[u+15]=f*s+R*n+p,x[u+16]=B*n+l*s+S),x[u+2]=t.x0,x[u+3]=t.y0,x[u+7]=t.x1,x[u+8]=t.y1,x[u+12]=t.x2,x[u+13]=t.y2,x[u+17]=t.x3,x[u+18]=t.y3;var b=e.tint;v[u+4]=v[u+9]=v[u+14]=v[u+19]=(b>>16)+(65280&b)+((255&b)<<16)+(255*e.worldAlpha<<24),this.sprites[this.currentBatchSize++]=e}},SpriteRenderer.prototype.flush=function(){if(0!==this.currentBatchSize){var e,r=this.renderer.gl;if(this.currentBatchSize>.5*this.size)r.bufferSubData(r.ARRAY_BUFFER,0,this.vertices);else{var t=this.positions.subarray(0,this.currentBatchSize*this.vertByteSize);r.bufferSubData(r.ARRAY_BUFFER,0,t)}for(var i,s,n,h,d=0,a=0,o=null,u=this.renderer.blendModeManager.currentBlendMode,c=null,f=!1,l=!1,R=0,B=this.currentBatchSize;B>R;R++)h=this.sprites[R],i=h._texture.baseTexture,s=h.blendMode,n=h.shader||this.shader,f=u!==s,l=c!==n,(o!==i||f||l)&&(this.renderBatch(o,d,a),a=R,d=0,o=i,f&&(u=s,this.renderer.blendModeManager.setBlendMode(u)),l&&(c=n,e=c.shaders?c.shaders[r.id]:c,e||(e=c.getShader(this.renderer)),this.renderer.shaderManager.setShader(e),e.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(!0),e.syncUniforms(),r.activeTexture(r.TEXTURE0))),d++;this.renderBatch(o,d,a),this.currentBatchSize=0}},SpriteRenderer.prototype.renderBatch=function(e,r,t){if(0!==r){var i=this.renderer.gl;e._glTextures[i.id]?i.bindTexture(i.TEXTURE_2D,e._glTextures[i.id]):this.renderer.updateTexture(e),i.drawElements(i.TRIANGLES,6*r,i.UNSIGNED_SHORT,6*t*2),this.renderer.drawCount++}},SpriteRenderer.prototype.start=function(){var e=this.renderer.gl;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var r=this.vertByteSize;e.vertexAttribPointer(this.shader.attributes.aVertexPosition,2,e.FLOAT,!1,r,0),e.vertexAttribPointer(this.shader.attributes.aTextureCoord,2,e.FLOAT,!1,r,8),e.vertexAttribPointer(this.shader.attributes.aColor,4,e.UNSIGNED_BYTE,!0,r,16)},SpriteRenderer.prototype.destroy=function(){this.renderer.gl.deleteBuffer(this.vertexBuffer),this.renderer.gl.deleteBuffer(this.indexBuffer),ObjectRenderer.prototype.destroy.call(this),this.shader.destroy(),this.renderer=null,this.vertices=null,this.positions=null,this.colors=null,this.indices=null,this.vertexBuffer=null,this.indexBuffer=null,this.sprites=null,this.shader=null};
},{"../../const":30,"../../renderers/webgl/WebGLRenderer":56,"../../renderers/webgl/utils/ObjectRenderer":70}],76:[function(require,module,exports){
function Text(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||CONST.RESOLUTION,this._text=null,this._style=null;var s=Texture.fromCanvas(this.canvas);s.trim=new math.Rectangle,Sprite.call(this,s),this.text=t,this.style=e}var Sprite=require("../sprites/Sprite"),Texture=require("../textures/Texture"),math=require("../math"),utils=require("../utils"),CONST=require("../const");Text.prototype=Object.create(Sprite.prototype),Text.prototype.constructor=Text,module.exports=Text,Text.fontPropertiesCache={},Text.fontPropertiesCanvas=document.createElement("canvas"),Text.fontPropertiesContext=Text.fontPropertiesCanvas.getContext("2d"),Object.defineProperties(Text.prototype,{width:{get:function(){return this.dirty&&this.updateText(),this.scale.x*this._texture._frame.width},set:function(t){this.scale.x=t/this._texture._frame.width,this._width=t}},height:{get:function(){return this.dirty&&this.updateText(),this.scale.y*this._texture._frame.height},set:function(t){this.scale.y=t/this._texture._frame.height,this._height=t}},style:{get:function(){return this._style},set:function(t){t=t||{},"number"==typeof t.fill&&(t.fill=utils.hex2string(t.fill)),"number"==typeof t.stroke&&(t.stroke=utils.hex2string(t.stroke)),"number"==typeof t.dropShadowColor&&(t.dropShadowColor=utils.hex2string(t.dropShadowColor)),t.font=t.font||"bold 20pt Arial",t.fill=t.fill||"black",t.align=t.align||"left",t.stroke=t.stroke||"black",t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.wordWrapWidth=t.wordWrapWidth||100,t.dropShadow=t.dropShadow||!1,t.dropShadowColor=t.dropShadowColor||"#000000",t.dropShadowAngle=t.dropShadowAngle||Math.PI/6,t.dropShadowDistance=t.dropShadowDistance||5,t.padding=t.padding||0,t.textBaseline=t.textBaseline||"alphabetic",t.lineJoin=t.lineJoin||"miter",t.miterLimit=t.miterLimit||10,this._style=t,this.dirty=!0}},text:{get:function(){return this._text},set:function(t){t=t.toString()||" ",this._text!==t&&(this._text=t,this.dirty=!0)}}}),Text.prototype.updateText=function(){var t=this._style;this.context.font=t.font;for(var e=t.wordWrap?this.wordWrap(this._text):this._text,i=e.split(/(?:\r\n|\r|\n)/),s=new Array(i.length),r=0,o=this.determineFontProperties(t.font),n=0;n<i.length;n++){var h=this.context.measureText(i[n]).width;s[n]=h,r=Math.max(r,h)}var a=r+t.strokeThickness;t.dropShadow&&(a+=t.dropShadowDistance),this.canvas.width=(a+this.context.lineWidth)*this.resolution;var l=this.style.lineHeight||o.fontSize+t.strokeThickness,d=l*i.length;t.dropShadow&&(d+=t.dropShadowDistance),this.canvas.height=(d+2*this._style.padding)*this.resolution,this.context.scale(this.resolution,this.resolution),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=t.font,this.context.strokeStyle=t.stroke,this.context.lineWidth=t.strokeThickness,this.context.textBaseline=t.textBaseline,this.context.lineJoin=t.lineJoin,this.context.miterLimit=t.miterLimit;var c,p;if(t.dropShadow){this.context.fillStyle=t.dropShadowColor;var x=Math.cos(t.dropShadowAngle)*t.dropShadowDistance,u=Math.sin(t.dropShadowAngle)*t.dropShadowDistance;for(n=0;n<i.length;n++)c=t.strokeThickness/2,p=t.strokeThickness/2+n*l+o.ascent,"right"===t.align?c+=r-s[n]:"center"===t.align&&(c+=(r-s[n])/2),t.fill&&this.context.fillText(i[n],c+x,p+u+this._style.padding)}for(this.context.fillStyle=t.fill,n=0;n<i.length;n++)c=t.strokeThickness/2,p=t.strokeThickness/2+n*l+o.ascent,"right"===t.align?c+=r-s[n]:"center"===t.align&&(c+=(r-s[n])/2),t.stroke&&t.strokeThickness&&this.context.strokeText(i[n],c,p+this._style.padding),t.fill&&this.context.fillText(i[n],c,p+this._style.padding);this.updateTexture()},Text.prototype.updateTexture=function(){var t=this._texture;t.baseTexture.hasLoaded=!0,t.baseTexture.resolution=this.resolution,t.baseTexture.width=this.canvas.width/this.resolution,t.baseTexture.height=this.canvas.height/this.resolution,t.crop.width=t._frame.width=this.canvas.width/this.resolution,t.crop.height=t._frame.height=this.canvas.height/this.resolution,t.trim.x=0,t.trim.y=-this._style.padding,t.trim.width=t._frame.width,t.trim.height=t._frame.height-2*this._style.padding,this._width=this.canvas.width/this.resolution,this._height=this.canvas.height/this.resolution,t.baseTexture.emit("update",t.baseTexture),this.dirty=!1},Text.prototype.renderWebGL=function(t){this.dirty&&this.updateText(),Sprite.prototype.renderWebGL.call(this,t)},Text.prototype._renderCanvas=function(t){this.dirty&&this.updateText(),Sprite.prototype._renderCanvas.call(this,t)},Text.prototype.determineFontProperties=function(t){var e=Text.fontPropertiesCache[t];if(!e){e={};var i=Text.fontPropertiesCanvas,s=Text.fontPropertiesContext;s.font=t;var r=Math.ceil(s.measureText("|MÉq").width),o=Math.ceil(s.measureText("M").width),n=2*o;o=1.4*o|0,i.width=r,i.height=n,s.fillStyle="#f00",s.fillRect(0,0,r,n),s.font=t,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText("|MÉq",0,o);var h,a,l=s.getImageData(0,0,r,n).data,d=l.length,c=4*r,p=0,x=!1;for(h=0;o>h;h++){for(a=0;c>a;a+=4)if(255!==l[p+a]){x=!0;break}if(x)break;p+=c}for(e.ascent=o-h,p=d-c,x=!1,h=n;h>o;h--){for(a=0;c>a;a+=4)if(255!==l[p+a]){x=!0;break}if(x)break;p-=c}e.descent=h-o,e.fontSize=e.ascent+e.descent,Text.fontPropertiesCache[t]=e}return e},Text.prototype.wordWrap=function(t){for(var e="",i=t.split("\n"),s=this._style.wordWrapWidth,r=0;r<i.length;r++){for(var o=s,n=i[r].split(" "),h=0;h<n.length;h++){var a=this.context.measureText(n[h]).width,l=a+this.context.measureText(" ").width;0===h||l>o?(h>0&&(e+="\n"),e+=n[h],o=s-a):(o-=l,e+=" "+n[h])}r<i.length-1&&(e+="\n")}return e},Text.prototype.getBounds=function(t){return this.dirty&&this.updateText(),Sprite.prototype.getBounds.call(this,t)},Text.prototype.destroy=function(t){this.context=null,this.canvas=null,this._style=null,this._texture.destroy(void 0===t?!0:t)};
},{"../const":30,"../math":40,"../sprites/Sprite":74,"../textures/Texture":79,"../utils":84}],77:[function(require,module,exports){
function BaseTexture(e,t,i){EventEmitter.call(this),this.uid=utils.uid(),this.resolution=i||1,this.width=100,this.height=100,this.realWidth=100,this.realHeight=100,this.scaleMode=t||CONST.SCALE_MODES.DEFAULT,this.hasLoaded=!1,this.isLoading=!1,this.source=null,this.premultipliedAlpha=!0,this.imageUrl=null,this.isPowerOfTwo=!1,this.mipmap=!1,this._glTextures=[],e&&this.loadSource(e)}var utils=require("../utils"),CONST=require("../const"),EventEmitter=require("eventemitter3");BaseTexture.prototype=Object.create(EventEmitter.prototype),BaseTexture.prototype.constructor=BaseTexture,module.exports=BaseTexture,BaseTexture.prototype.update=function(){this.realWidth=this.source.naturalWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.height,this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=utils.isPowerOfTwo(this.realWidth,this.realHeight),this.emit("update",this)},BaseTexture.prototype.loadSource=function(e){var t=this.isLoading;if(this.hasLoaded=!1,this.isLoading=!1,t&&this.source&&(this.source.onload=null,this.source.onerror=null),this.source=e,(this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this._sourceLoaded();else if(!e.getContext){this.isLoading=!0;var i=this;e.onload=function(){e.onload=null,e.onerror=null,i.isLoading&&(i.isLoading=!1,i._sourceLoaded(),i.emit("loaded",i))},e.onerror=function(){e.onload=null,e.onerror=null,i.isLoading&&(i.isLoading=!1,i.emit("error",i))},e.complete&&e.src&&(this.isLoading=!1,e.onload=null,e.onerror=null,e.width&&e.height?(this._sourceLoaded(),t&&this.emit("loaded",this)):t&&this.emit("error",this))}},BaseTexture.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},BaseTexture.prototype.destroy=function(){this.imageUrl?(delete utils.BaseTextureCache[this.imageUrl],delete utils.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&this.source._pixiId&&delete utils.BaseTextureCache[this.source._pixiId],this.source=null,this.dispose()},BaseTexture.prototype.dispose=function(){this.emit("dispose",this),this._glTextures.length=0},BaseTexture.prototype.updateSourceImage=function(e){this.source.src=e,this.loadSource(this.source)},BaseTexture.fromImage=function(e,t,i){var s=utils.BaseTextureCache[e];if(void 0===t&&0!==e.indexOf("data:")&&(t=!0),!s){var r=new Image;t&&(r.crossOrigin=""),s=new BaseTexture(r,i),s.imageUrl=e,r.src=e,utils.BaseTextureCache[e]=s,s.resolution=utils.getResolutionOfUrl(e)}return s},BaseTexture.fromCanvas=function(e,t){e._pixiId||(e._pixiId="canvas_"+utils.uid());var i=utils.BaseTextureCache[e._pixiId];return i||(i=new BaseTexture(e,t),utils.BaseTextureCache[e._pixiId]=i),i};
},{"../const":30,"../utils":84,"eventemitter3":20}],78:[function(require,module,exports){
function RenderTexture(e,r,t,i,n){if(!e)throw new Error("Unable to create RenderTexture, you must pass a renderer into the constructor.");r=r||100,t=t||100,n=n||CONST.RESOLUTION;var s=new BaseTexture;if(s.width=r,s.height=t,s.resolution=n,s.scaleMode=i||CONST.SCALE_MODES.DEFAULT,s.hasLoaded=!0,Texture.call(this,s,new math.Rectangle(0,0,r,t)),this.width=r,this.height=t,this.resolution=n,this.render=null,this.renderer=e,this.renderer.type===CONST.RENDERER_TYPE.WEBGL){var a=this.renderer.gl;this.textureBuffer=new RenderTarget(a,this.width,this.height,s.scaleMode,this.resolution),this.baseTexture._glTextures[a.id]=this.textureBuffer.texture,this.filterManager=new FilterManager(this.renderer),this.filterManager.onContextChange(),this.filterManager.resize(r,t),this.render=this.renderWebGL,this.renderer.currentRenderer.start(),this.renderer.currentRenderTarget.activate()}else this.render=this.renderCanvas,this.textureBuffer=new CanvasBuffer(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0,this._updateUvs()}var BaseTexture=require("./BaseTexture"),Texture=require("./Texture"),RenderTarget=require("../renderers/webgl/utils/RenderTarget"),FilterManager=require("../renderers/webgl/managers/FilterManager"),CanvasBuffer=require("../renderers/canvas/utils/CanvasBuffer"),math=require("../math"),CONST=require("../const"),tempMatrix=new math.Matrix;RenderTexture.prototype=Object.create(Texture.prototype),RenderTexture.prototype.constructor=RenderTexture,module.exports=RenderTexture,RenderTexture.prototype.resize=function(e,r,t){(e!==this.width||r!==this.height)&&(this.valid=e>0&&r>0,this.width=this._frame.width=this.crop.width=e,this.height=this._frame.height=this.crop.height=r,t&&(this.baseTexture.width=this.width,this.baseTexture.height=this.height),this.valid&&(this.textureBuffer.resize(this.width,this.height),this.filterManager&&this.filterManager.resize(this.width,this.height)))},RenderTexture.prototype.clear=function(){this.valid&&(this.renderer.type===CONST.RENDERER_TYPE.WEBGL&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},RenderTexture.prototype.renderWebGL=function(e,r,t,i){if(this.valid){if(i=void 0!==i?i:!0,this.textureBuffer.transform=r,this.textureBuffer.activate(),e.worldAlpha=1,i){e.worldTransform.identity(),e.currentBounds=null;var n,s,a=e.children;for(n=0,s=a.length;s>n;++n)a[n].updateTransform()}var h=this.renderer.filterManager;this.renderer.filterManager=this.filterManager,this.renderer.renderDisplayObject(e,this.textureBuffer,t),this.renderer.filterManager=h}},RenderTexture.prototype.renderCanvas=function(e,r,t,i){if(this.valid){i=!!i;var n=tempMatrix;n.identity(),r&&n.append(r),e.worldTransform=n;var s=e.worldTransform;e.worldAlpha=1;var a,h,u=e.children;for(a=0,h=u.length;h>a;++a)u[a].updateTransform();t&&this.textureBuffer.clear();var f=this.textureBuffer.context,d=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(e,f),this.renderer.resolution=d,e.worldTransform=s}},RenderTexture.prototype.destroy=function(){Texture.prototype.destroy.call(this,!0),this.textureBuffer.destroy(),this.filterManager&&this.filterManager.destroy(),this.renderer=null},RenderTexture.prototype.getImage=function(){var e=new Image;return e.src=this.getBase64(),e},RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()},RenderTexture.prototype.getCanvas=function(){if(this.renderer.type===CONST.RENDERER_TYPE.WEBGL){var e=this.renderer.gl,r=this.textureBuffer.size.width,t=this.textureBuffer.size.height,i=new Uint8Array(4*r*t);e.bindFramebuffer(e.FRAMEBUFFER,this.textureBuffer.frameBuffer),e.readPixels(0,0,r,t,e.RGBA,e.UNSIGNED_BYTE,i),e.bindFramebuffer(e.FRAMEBUFFER,null);var n=new CanvasBuffer(r,t),s=n.context.getImageData(0,0,r,t);return s.data.set(i),n.context.putImageData(s,0,0),n.canvas}return this.textureBuffer.canvas},RenderTexture.prototype.getPixels=function(){var e,r;if(this.renderer.type===CONST.RENDERER_TYPE.WEBGL){var t=this.renderer.gl;e=this.textureBuffer.size.width,r=this.textureBuffer.size.height;var i=new Uint8Array(4*e*r);return t.bindFramebuffer(t.FRAMEBUFFER,this.textureBuffer.frameBuffer),t.readPixels(0,0,e,r,t.RGBA,t.UNSIGNED_BYTE,i),t.bindFramebuffer(t.FRAMEBUFFER,null),i}return e=this.textureBuffer.canvas.width,r=this.textureBuffer.canvas.height,this.textureBuffer.canvas.getContext("2d").getImageData(0,0,e,r).data},RenderTexture.prototype.getPixel=function(e,r){if(this.renderer.type===CONST.RENDERER_TYPE.WEBGL){var t=this.renderer.gl,i=new Uint8Array(4);return t.bindFramebuffer(t.FRAMEBUFFER,this.textureBuffer.frameBuffer),t.readPixels(e,r,1,1,t.RGBA,t.UNSIGNED_BYTE,i),t.bindFramebuffer(t.FRAMEBUFFER,null),i}return this.textureBuffer.canvas.getContext("2d").getImageData(e,r,1,1).data};
},{"../const":30,"../math":40,"../renderers/canvas/utils/CanvasBuffer":52,"../renderers/webgl/managers/FilterManager":61,"../renderers/webgl/utils/RenderTarget":72,"./BaseTexture":77,"./Texture":79}],79:[function(require,module,exports){
function Texture(e,t,r,i,s){EventEmitter.call(this),this.noFrame=!1,t||(this.noFrame=!0,t=new math.Rectangle(0,0,1,1)),e instanceof Texture&&(e=e.baseTexture),this.baseTexture=e,this._frame=t,this.trim=i,this.valid=!1,this.requiresUpdate=!1,this._uvs=null,this.width=0,this.height=0,this.crop=r||t,this.rotate=!!s,e.hasLoaded?(this.noFrame&&(t=new math.Rectangle(0,0,e.width,e.height),e.on("update",this.onBaseTextureUpdated,this)),this.frame=t):e.once("loaded",this.onBaseTextureLoaded,this)}var BaseTexture=require("./BaseTexture"),VideoBaseTexture=require("./VideoBaseTexture"),TextureUvs=require("./TextureUvs"),EventEmitter=require("eventemitter3"),math=require("../math"),utils=require("../utils");Texture.prototype=Object.create(EventEmitter.prototype),Texture.prototype.constructor=Texture,module.exports=Texture,Object.defineProperties(Texture.prototype,{frame:{get:function(){return this._frame},set:function(e){if(this._frame=e,this.noFrame=!1,this.width=e.width,this.height=e.height,!this.trim&&!this.rotate&&(e.x+e.width>this.baseTexture.width||e.y+e.height>this.baseTexture.height))throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=e&&e.width&&e.height&&this.baseTexture.hasLoaded,this.trim?(this.width=this.trim.width,this.height=this.trim.height,this._frame.width=this.trim.width,this._frame.height=this.trim.height):this.crop=e,this.valid&&this._updateUvs()}}}),Texture.prototype.update=function(){this.baseTexture.update()},Texture.prototype.onBaseTextureLoaded=function(e){this.noFrame?this.frame=new math.Rectangle(0,0,e.width,e.height):this.frame=this._frame,this.emit("update",this)},Texture.prototype.onBaseTextureUpdated=function(e){this._frame.width=e.width,this._frame.height=e.height,this.emit("update",this)},Texture.prototype.destroy=function(e){this.baseTexture&&(e&&this.baseTexture.destroy(),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.crop=null,this.valid=!1,this.off("dispose",this.dispose,this),this.off("update",this.update,this)},Texture.prototype.clone=function(){return new Texture(this.baseTexture,this.frame,this.crop,this.trim,this.rotate)},Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new TextureUvs),this._uvs.set(this.crop,this.baseTexture,this.rotate)},Texture.fromImage=function(e,t,r){var i=utils.TextureCache[e];return i||(i=new Texture(BaseTexture.fromImage(e,t,r)),utils.TextureCache[e]=i),i},Texture.fromFrame=function(e){var t=utils.TextureCache[e];if(!t)throw new Error('The frameId "'+e+'" does not exist in the texture cache');return t},Texture.fromCanvas=function(e,t){return new Texture(BaseTexture.fromCanvas(e,t))},Texture.fromVideo=function(e,t){return"string"==typeof e?Texture.fromVideoUrl(e,t):new Texture(VideoBaseTexture.fromVideo(e,t))},Texture.fromVideoUrl=function(e,t){return new Texture(VideoBaseTexture.fromUrl(e,t))},Texture.addTextureToCache=function(e,t){utils.TextureCache[t]=e},Texture.removeTextureFromCache=function(e){var t=utils.TextureCache[e];return delete utils.TextureCache[e],delete utils.BaseTextureCache[e],t},Texture.EMPTY=new Texture(new BaseTexture);
},{"../math":40,"../utils":84,"./BaseTexture":77,"./TextureUvs":80,"./VideoBaseTexture":81,"eventemitter3":20}],80:[function(require,module,exports){
function TextureUvs(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1}module.exports=TextureUvs,TextureUvs.prototype.set=function(t,h,i){var s=h.width,x=h.height;i?(this.x0=(t.x+t.height)/s,this.y0=t.y/x,this.x1=(t.x+t.height)/s,this.y1=(t.y+t.width)/x,this.x2=t.x/s,this.y2=(t.y+t.width)/x,this.x3=t.x/s,this.y3=t.y/x):(this.x0=t.x/s,this.y0=t.y/x,this.x1=(t.x+t.width)/s,this.y1=t.y/x,this.x2=(t.x+t.width)/s,this.y2=(t.y+t.height)/x,this.x3=t.x/s,this.y3=(t.y+t.height)/x)};
},{}],81:[function(require,module,exports){
function VideoBaseTexture(e,t){if(!e)throw new Error("No video source element specified.");(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),BaseTexture.call(this,e,t),this.autoUpdate=!1,this._onUpdate=this._onUpdate.bind(this),this._onCanPlay=this._onCanPlay.bind(this),e.complete||(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this))),this.__loaded=!1}function createSource(e,t){t||(t="video/"+e.substr(e.lastIndexOf(".")+1));var i=document.createElement("source");return i.src=e,i.type=t,i}var BaseTexture=require("./BaseTexture"),utils=require("../utils");VideoBaseTexture.prototype=Object.create(BaseTexture.prototype),VideoBaseTexture.prototype.constructor=VideoBaseTexture,module.exports=VideoBaseTexture,VideoBaseTexture.prototype._onUpdate=function(){this.autoUpdate&&(window.requestAnimationFrame(this._onUpdate),this.update())},VideoBaseTexture.prototype._onPlayStart=function(){this.autoUpdate||(window.requestAnimationFrame(this._onUpdate),this.autoUpdate=!0)},VideoBaseTexture.prototype._onPlayStop=function(){this.autoUpdate=!1},VideoBaseTexture.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.source.play(),this.__loaded||(this.__loaded=!0,this.emit("loaded",this)))},VideoBaseTexture.prototype.destroy=function(){this.source&&this.source._pixiId&&(delete utils.BaseTextureCache[this.source._pixiId],delete this.source._pixiId),BaseTexture.prototype.destroy.call(this)},VideoBaseTexture.fromVideo=function(e,t){e._pixiId||(e._pixiId="video_"+utils.uid());var i=utils.BaseTextureCache[e._pixiId];return i||(i=new VideoBaseTexture(e,t),utils.BaseTextureCache[e._pixiId]=i),i},VideoBaseTexture.fromUrl=function(e,t){var i=document.createElement("video");if(Array.isArray(e))for(var o=0;o<e.length;++o)i.appendChild(createSource(e[o].src||e[o],e[o].mime));else i.appendChild(createSource(e.src||e,e.mime));return i.load(),i.play(),VideoBaseTexture.fromVideo(i,t)},VideoBaseTexture.fromUrls=VideoBaseTexture.fromUrl;
},{"../utils":84,"./BaseTexture":77}],82:[function(require,module,exports){
function Ticker(){var t=this;this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._emitter.listeners(TICK,!0)&&(t._requestId=requestAnimationFrame(t._tick)))},this._emitter=new EventEmitter,this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/CONST.TARGET_FPMS,this.lastTime=0,this.speed=1,this.started=!1}var CONST=require("../const"),EventEmitter=require("eventemitter3"),TICK="tick";Object.defineProperties(Ticker.prototype,{FPS:{get:function(){return 1e3/this.elapsedMS}},minFPS:{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(Math.max(0,t)/1e3,CONST.TARGET_FPMS);this._maxElapsedMS=1/e}}}),Ticker.prototype._requestIfNeeded=function(){null===this._requestId&&this._emitter.listeners(TICK,!0)&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},Ticker.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},Ticker.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},Ticker.prototype.add=function(t,e){return this._emitter.on(TICK,t,e),this._startIfPossible(),this},Ticker.prototype.addOnce=function(t,e){return this._emitter.once(TICK,t,e),this._startIfPossible(),this},Ticker.prototype.remove=function(t,e){return this._emitter.off(TICK,t,e),this._emitter.listeners(TICK,!0)||this._cancelIfNeeded(),this},Ticker.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},Ticker.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},Ticker.prototype.update=function(t){var e;t=t||performance.now(),e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),this.deltaTime=e*CONST.TARGET_FPMS*this.speed,this._emitter.emit(TICK,this.deltaTime),this.lastTime=t},module.exports=Ticker;
},{"../const":30,"eventemitter3":20}],83:[function(require,module,exports){
var Ticker=require("./Ticker"),shared=new Ticker;shared.autoStart=!0,module.exports={shared:shared,Ticker:Ticker};
},{"./Ticker":82}],84:[function(require,module,exports){
var CONST=require("../const"),utils=module.exports={_uid:0,_saidHello:!1,EventEmitter:require("eventemitter3"),pluginTarget:require("./pluginTarget"),async:require("async"),uid:function(){return++utils._uid},hex2rgb:function(e,n){return n=n||[],n[0]=(e>>16&255)/255,n[1]=(e>>8&255)/255,n[2]=(255&e)/255,n},hex2string:function(e){return e=e.toString(16),e="000000".substr(0,6-e.length)+e,"#"+e},rgb2hex:function(e){return(255*e[0]<<16)+(255*e[1]<<8)+255*e[2]},canUseNewCanvasBlendModes:function(){if("undefined"==typeof document)return!1;var e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",n="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",t=new Image;t.src=e+"AP804Oa6"+n;var r=new Image;r.src=e+"/wCKxvRF"+n;var a=document.createElement("canvas");a.width=6,a.height=1;var o=a.getContext("2d");o.globalCompositeOperation="multiply",o.drawImage(t,0,0),o.drawImage(r,2,0);var i=o.getImageData(2,0,1,1).data;return 255===i[0]&&0===i[1]&&0===i[2]},getNextPowerOfTwo:function(e){if(e>0&&0===(e&e-1))return e;for(var n=1;e>n;)n<<=1;return n},isPowerOfTwo:function(e,n){return e>0&&0===(e&e-1)&&n>0&&0===(n&n-1)},getResolutionOfUrl:function(e){var n=CONST.RETINA_PREFIX.exec(e);return n?parseFloat(n[1]):1},sayHello:function(e){if(!utils._saidHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var n=["\n %c %c %c Pixi.js "+CONST.VERSION+" - ✰ "+e+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,n)}else window.console&&window.console.log("Pixi.js "+CONST.VERSION+" - "+e+" - http://www.pixijs.com/");utils._saidHello=!0}},isWebGLSupported:function(){var e={stencil:!0};try{if(!window.WebGLRenderingContext)return!1;var n=document.createElement("canvas"),t=n.getContext("webgl",e)||n.getContext("experimental-webgl",e);return!(!t||!t.getContextAttributes().stencil)}catch(r){return!1}},sign:function(e){return e?0>e?-1:1:0},TextureCache:{},BaseTextureCache:{}};
},{"../const":30,"./pluginTarget":85,"async":18,"eventemitter3":20}],85:[function(require,module,exports){
function pluginTarget(i){i.__plugins={},i.registerPlugin=function(n,s){i.__plugins[n]=s},i.prototype.initPlugins=function(){this.plugins=this.plugins||{};for(var n in i.__plugins)this.plugins[n]=new i.__plugins[n](this)},i.prototype.destroyPlugins=function(){for(var i in this.plugins)this.plugins[i].destroy(),this.plugins[i]=null;this.plugins=null}}module.exports={mixin:function(i){pluginTarget(i)}};
},{}],86:[function(require,module,exports){
var core=require("./core"),mesh=require("./mesh"),extras=require("./extras"),filters=require("./filters");core.SpriteBatch=function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")},core.AssetLoader=function(){throw new ReferenceError("The loader system was overhauled in pixi v3, please see the new PIXI.loaders.Loader class.")},Object.defineProperties(core,{Stage:{get:function(){return console.warn("You do not need to use a PIXI Stage any more, you can simply render any container."),core.Container}},DisplayObjectContainer:{get:function(){return console.warn("DisplayObjectContainer has been shortened to Container, please use Container from now on."),core.Container}},Strip:{get:function(){return console.warn("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on."),mesh.Mesh}},Rope:{get:function(){return console.warn("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on."),mesh.Rope}},MovieClip:{get:function(){return console.warn("The MovieClip class has been moved to extras.MovieClip, please use extras.MovieClip from now on."),extras.MovieClip}},TilingSprite:{get:function(){return console.warn("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on."),extras.TilingSprite}},BitmapText:{get:function(){return console.warn("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on."),extras.BitmapText}},blendModes:{get:function(){return console.warn("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on."),core.BLEND_MODES}},scaleModes:{get:function(){return console.warn("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on."),core.SCALE_MODES}},BaseTextureCache:{get:function(){return console.warn("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on."),core.utils.BaseTextureCache}},TextureCache:{get:function(){return console.warn("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on."),core.utils.TextureCache}},math:{get:function(){return console.warn("The math namespace is deprecated, please access members already accessible on PIXI."),core}}}),core.Sprite.prototype.setTexture=function(e){this.texture=e,console.warn("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")},extras.BitmapText.prototype.setText=function(e){this.text=e,console.warn("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")},core.Text.prototype.setText=function(e){this.text=e,console.warn("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")},core.Text.prototype.setStyle=function(e){this.style=e,console.warn("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")},core.Texture.prototype.setFrame=function(e){this.frame=e,console.warn("setFrame is now deprecated, please use the frame property, e.g : myTexture.frame = frame;")},Object.defineProperties(filters,{AbstractFilter:{get:function(){return console.warn("filters.AbstractFilter is an undocumented alias, please use AbstractFilter from now on."),core.AbstractFilter}},FXAAFilter:{get:function(){return console.warn("filters.FXAAFilter is an undocumented alias, please use FXAAFilter from now on."),core.FXAAFilter}},SpriteMaskFilter:{get:function(){return console.warn("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on."),core.SpriteMaskFilter}}}),core.utils.uuid=function(){return console.warn("utils.uuid() is deprecated, please use utils.uid() from now on."),core.utils.uid()};
},{"./core":37,"./extras":93,"./filters":110,"./mesh":134}],87:[function(require,module,exports){
function BitmapText(t,e){core.Container.call(this),e=e||{},this.textWidth=0,this.textHeight=0,this._glyphs=[],this._font={tint:void 0!==e.tint?e.tint:16777215,align:e.align||"left",name:null,size:0},this.font=e.font,this._text=t,this.maxWidth=0,this.maxLineHeight=0,this.dirty=!1,this.updateText()}var core=require("../core");BitmapText.prototype=Object.create(core.Container.prototype),BitmapText.prototype.constructor=BitmapText,module.exports=BitmapText,Object.defineProperties(BitmapText.prototype,{tint:{get:function(){return this._font.tint},set:function(t){this._font.tint="number"==typeof t&&t>=0?t:16777215,this.dirty=!0}},align:{get:function(){return this._font.align},set:function(t){this._font.align=t||"left",this.dirty=!0}},font:{get:function(){return this._font},set:function(t){t&&("string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),this._font.size=t.length>=2?parseInt(t[0],10):BitmapText.fonts[this._font.name].size):(this._font.name=t.name,this._font.size="number"==typeof t.size?t.size:parseInt(t.size,10)),this.dirty=!0)}},text:{get:function(){return this._text},set:function(t){t=t.toString()||" ",this._text!==t&&(this._text=t,this.dirty=!0)}}}),BitmapText.prototype.updateText=function(){for(var t=BitmapText.fonts[this._font.name],e=new core.Point,i=null,n=[],s=0,o=0,h=[],r=0,a=this._font.size/t.size,p=-1,x=0,f=0;f<this.text.length;f++){var l=this.text.charCodeAt(f);if(p=/(\s)/.test(this.text.charAt(f))?f:p,/(?:\r\n|\r|\n)/.test(this.text.charAt(f)))h.push(s),o=Math.max(o,s),r++,e.x=0,e.y+=t.lineHeight,i=null;else if(-1!==p&&this.maxWidth>0&&e.x*a>this.maxWidth)n.splice(p,f-p),f=p,p=-1,h.push(s),o=Math.max(o,s),r++,e.x=0,e.y+=t.lineHeight,i=null;else{var u=t.chars[l];u&&(i&&u.kerning[i]&&(e.x+=u.kerning[i]),n.push({texture:u.texture,line:r,charCode:l,position:new core.Point(e.x+u.xOffset,e.y+u.yOffset)}),s=e.x+(u.texture.width+u.xOffset),e.x+=u.xAdvance,x=Math.max(x,u.yOffset+u.texture.height),i=l)}}h.push(s),o=Math.max(o,s);var c=[];for(f=0;r>=f;f++){var g=0;"right"===this._font.align?g=o-h[f]:"center"===this._font.align&&(g=(o-h[f])/2),c.push(g)}var m=n.length,d=this.tint;for(f=0;m>f;f++){var y=this._glyphs[f];y?y.texture=n[f].texture:(y=new core.Sprite(n[f].texture),this._glyphs.push(y)),y.position.x=(n[f].position.x+c[n[f].line])*a,y.position.y=n[f].position.y*a,y.scale.x=y.scale.y=a,y.tint=d,y.parent||this.addChild(y)}for(f=m;f<this._glyphs.length;++f)this.removeChild(this._glyphs[f]);this.textWidth=o*a,this.textHeight=(e.y+t.lineHeight)*a,this.maxLineHeight=x*a},BitmapText.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},BitmapText.prototype.getLocalBounds=function(){return this.validate(),core.Container.prototype.getLocalBounds.call(this)},BitmapText.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},BitmapText.fonts={};
},{"../core":37}],88:[function(require,module,exports){
function MovieClip(t){core.Sprite.call(this,t[0]instanceof core.Texture?t[0]:t[0].texture),this._textures=null,this._durations=null,this.textures=t,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this._currentTime=0,this.playing=!1}var core=require("../core");MovieClip.prototype=Object.create(core.Sprite.prototype),MovieClip.prototype.constructor=MovieClip,module.exports=MovieClip,Object.defineProperties(MovieClip.prototype,{totalFrames:{get:function(){return this._textures.length}},textures:{get:function(){return this._textures},set:function(t){if(t[0]instanceof core.Texture)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}}},currentFrame:{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return 0>t&&(t+=this._textures.length),t}}}),MovieClip.prototype.stop=function(){this.playing&&(this.playing=!1,core.ticker.shared.remove(this.update,this))},MovieClip.prototype.play=function(){this.playing||(this.playing=!0,core.ticker.shared.add(this.update,this))},MovieClip.prototype.gotoAndStop=function(t){this.stop(),this._currentTime=t,this._texture=this._textures[this.currentFrame]},MovieClip.prototype.gotoAndPlay=function(t){this._currentTime=t,this.play()},MovieClip.prototype.update=function(t){var e=this.animationSpeed*t;if(null!==this._durations){var i=this._currentTime%1*this._durations[this.currentFrame];for(i+=e/60*1e3;0>i;)this._currentTime--,i+=this._durations[this.currentFrame];var r=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*r,this._currentTime+=r;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):this._texture=this._textures[this.currentFrame]},MovieClip.prototype.destroy=function(){this.stop(),core.Sprite.prototype.destroy.call(this)},MovieClip.fromFrames=function(t){for(var e=[],i=0;i<t.length;++i)e.push(new core.Texture.fromFrame(t[i]));return new MovieClip(e)},MovieClip.fromImages=function(t){for(var e=[],i=0;i<t.length;++i)e.push(new core.Texture.fromImage(t[i]));return new MovieClip(e)};
},{"../core":37}],89:[function(require,module,exports){
function TilingSprite(t,e,i){core.Sprite.call(this,t),this.tileScale=new core.Point(1,1),this.tilePosition=new core.Point(0,0),this._width=e||100,this._height=i||100,this._uvs=new core.TextureUvs,this._canvasPattern=null,this.shader=new core.AbstractFilter(["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform mat3 projectionMatrix;","uniform vec4 uFrame;","uniform vec4 uTransform;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vec2 coord = aTextureCoord;","   coord -= uTransform.xy;","   coord /= uTransform.zw;","   vTextureCoord = coord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform vec4 uFrame;","uniform vec2 uPixelSize;","void main(void){","   vec2 coord = mod(vTextureCoord, uFrame.zw);","   coord = clamp(coord, uPixelSize, uFrame.zw - uPixelSize);","   coord += uFrame.xy;","   gl_FragColor =  texture2D(uSampler, coord) * vColor ;","}"].join("\n"),{uFrame:{type:"4fv",value:[0,0,1,1]},uTransform:{type:"4fv",value:[0,0,1,1]},uPixelSize:{type:"2fv",value:[1,1]}})}var core=require("../core"),tempPoint=new core.Point,CanvasTinter=require("../core/renderers/canvas/utils/CanvasTinter");TilingSprite.prototype=Object.create(core.Sprite.prototype),TilingSprite.prototype.constructor=TilingSprite,module.exports=TilingSprite,Object.defineProperties(TilingSprite.prototype,{width:{get:function(){return this._width},set:function(t){this._width=t}},height:{get:function(){return this._height},set:function(t){this._height=t}}}),TilingSprite.prototype._onTextureUpdate=function(){},TilingSprite.prototype._renderWebGL=function(t){var e=this._texture;if(e&&e._uvs){var i=e._uvs,r=e._frame.width,o=e._frame.height,n=e.baseTexture.width,s=e.baseTexture.height;e._uvs=this._uvs,e._frame.width=this.width,e._frame.height=this.height,this.shader.uniforms.uPixelSize.value[0]=1/n,this.shader.uniforms.uPixelSize.value[1]=1/s,this.shader.uniforms.uFrame.value[0]=i.x0,this.shader.uniforms.uFrame.value[1]=i.y0,this.shader.uniforms.uFrame.value[2]=i.x1-i.x0,this.shader.uniforms.uFrame.value[3]=i.y2-i.y0,this.shader.uniforms.uTransform.value[0]=this.tilePosition.x%(r*this.tileScale.x)/this._width,this.shader.uniforms.uTransform.value[1]=this.tilePosition.y%(o*this.tileScale.y)/this._height,this.shader.uniforms.uTransform.value[2]=n/this._width*this.tileScale.x,this.shader.uniforms.uTransform.value[3]=s/this._height*this.tileScale.y,t.setObjectRenderer(t.plugins.sprite),t.plugins.sprite.render(this),e._uvs=i,e._frame.width=r,e._frame.height=o}},TilingSprite.prototype._renderCanvas=function(t){var e=this._texture;if(e.baseTexture.hasLoaded){var i=t.context,r=this.worldTransform,o=t.resolution,n=e.baseTexture,s=this.tilePosition.x/this.tileScale.x%e._frame.width,a=this.tilePosition.y/this.tileScale.y%e._frame.height;if(!this._canvasPattern){var h=new core.CanvasBuffer(e._frame.width,e._frame.height);16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=CanvasTinter.getTintedTexture(this,this.tint)),h.context.drawImage(this.tintedTexture,0,0)):h.context.drawImage(n.source,-e._frame.x,-e._frame.y),this._canvasPattern=h.context.createPattern(h.canvas,"repeat")}i.globalAlpha=this.worldAlpha,i.setTransform(r.a*o,r.b*o,r.c*o,r.d*o,r.tx*o,r.ty*o),i.scale(this.tileScale.x,this.tileScale.y),i.translate(s+this.anchor.x*-this._width,a+this.anchor.y*-this._height);var l=t.blendModes[this.blendMode];l!==t.context.globalCompositeOperation&&(i.globalCompositeOperation=l),i.fillStyle=this._canvasPattern,i.fillRect(-s,-a,this._width/this.tileScale.x,this._height/this.tileScale.y)}},TilingSprite.prototype.getBounds=function(){var t,e,i,r,o=this._width,n=this._height,s=o*(1-this.anchor.x),a=o*-this.anchor.x,h=n*(1-this.anchor.y),l=n*-this.anchor.y,u=this.worldTransform,c=u.a,d=u.b,v=u.c,m=u.d,p=u.tx,f=u.ty,x=c*a+v*l+p,g=m*l+d*a+f,T=c*s+v*l+p,_=m*l+d*s+f,y=c*s+v*h+p,S=m*h+d*s+f,w=c*a+v*h+p,P=m*h+d*a+f;t=x,t=t>T?T:t,t=t>y?y:t,t=t>w?w:t,i=g,i=i>_?_:i,i=i>S?S:i,i=i>P?P:i,e=x,e=T>e?T:e,e=y>e?y:e,e=w>e?w:e,r=g,r=_>r?_:r,r=S>r?S:r,r=P>r?P:r;var C=this._bounds;return C.x=t,C.width=e-t,C.y=i,C.height=r-i,this._currentBounds=C,C},TilingSprite.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,tempPoint);var e,i=this._width,r=this._height,o=-i*this.anchor.x;return tempPoint.x>o&&tempPoint.x<o+i&&(e=-r*this.anchor.y,tempPoint.y>e&&tempPoint.y<e+r)?!0:!1},TilingSprite.prototype.destroy=function(){core.Sprite.prototype.destroy.call(this),this.tileScale=null,this._tileScaleOffset=null,this.tilePosition=null,this._uvs=null},TilingSprite.fromFrame=function(t,e,i){var r=core.utils.TextureCache[t];if(!r)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new TilingSprite(r,e,i)},TilingSprite.fromImage=function(t,e,i,r,o){return new TilingSprite(core.Texture.fromImage(t,r,o),e,i)};
},{"../core":37,"../core/renderers/canvas/utils/CanvasTinter":55}],90:[function(require,module,exports){
var core=require("../core"),DisplayObject=core.DisplayObject,_tempMatrix=new core.Matrix;DisplayObject.prototype._cacheAsBitmap=!1,DisplayObject.prototype._originalRenderWebGL=null,DisplayObject.prototype._originalRenderCanvas=null,DisplayObject.prototype._originalUpdateTransform=null,DisplayObject.prototype._originalHitTest=null,DisplayObject.prototype._originalDestroy=null,DisplayObject.prototype._cachedSprite=null,Object.defineProperties(DisplayObject.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._originalRenderWebGL=this.renderWebGL,this._originalRenderCanvas=this.renderCanvas,this._originalUpdateTransform=this.updateTransform,this._originalGetBounds=this.getBounds,this._originalDestroy=this.destroy,this._originalContainsPoint=this.containsPoint,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(this._cachedSprite&&this._destroyCachedDisplayObject(),this.renderWebGL=this._originalRenderWebGL,this.renderCanvas=this._originalRenderCanvas,this.getBounds=this._originalGetBounds,this.destroy=this._originalDestroy,this.updateTransform=this._originalUpdateTransform,this.containsPoint=this._originalContainsPoint))}}}),DisplayObject.prototype._renderCachedWebGL=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cachedSprite.worldAlpha=this.worldAlpha,t.setObjectRenderer(t.plugins.sprite),t.plugins.sprite.render(this._cachedSprite))},DisplayObject.prototype._initCachedDisplayObject=function(t){if(!this._cachedSprite){t.currentRenderer.flush();var e=this.getLocalBounds().clone();if(this._filters){var i=this._filters[0].padding;e.x-=i,e.y-=i,e.width+=2*i,e.height+=2*i}var r=t.currentRenderTarget,s=t.filterManager.filterStack,a=new core.RenderTexture(t,0|e.width,0|e.height),n=_tempMatrix;n.tx=-e.x,n.ty=-e.y,this.renderWebGL=this._originalRenderWebGL,a.render(this,n,!0,!0),t.setRenderTarget(r),t.filterManager.filterStack=s,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this.getBounds=this._getCachedBounds,this._cachedSprite=new core.Sprite(a),this._cachedSprite.worldTransform=this.worldTransform,this._cachedSprite.anchor.x=-(e.x/e.width),this._cachedSprite.anchor.y=-(e.y/e.height),this.updateTransform(),this.containsPoint=this._cachedSprite.containsPoint.bind(this._cachedSprite)}},DisplayObject.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cachedSprite.worldAlpha=this.worldAlpha,this._cachedSprite.renderCanvas(t))},DisplayObject.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cachedSprite){var e=this.getLocalBounds(),i=t.context,r=new core.RenderTexture(t,0|e.width,0|e.height),s=_tempMatrix;s.tx=-e.x,s.ty=-e.y,this.renderCanvas=this._originalRenderCanvas,r.render(this,s,!0),t.context=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.getBounds=this._getCachedBounds,this._cachedSprite=new core.Sprite(r),this._cachedSprite.worldTransform=this.worldTransform,this._cachedSprite.anchor.x=-(e.x/e.width),this._cachedSprite.anchor.y=-(e.y/e.height),this.updateTransform(),this.containsPoint=this._cachedSprite.containsPoint.bind(this._cachedSprite)}},DisplayObject.prototype._getCachedBounds=function(){return this._cachedSprite._currentBounds=null,this._cachedSprite.getBounds()},DisplayObject.prototype._destroyCachedDisplayObject=function(){this._cachedSprite._texture.destroy(),this._cachedSprite=null},DisplayObject.prototype._cacheAsBitmapDestroy=function(){this.cacheAsBitmap=!1,this._originalDestroy()};
},{"../core":37}],91:[function(require,module,exports){
var core=require("../core");core.DisplayObject.prototype.name=null,core.Container.prototype.getChildByName=function(e){for(var r=0;r<this.children.length;r++)if(this.children[r].name===e)return this.children[r];return null};
},{"../core":37}],92:[function(require,module,exports){
var core=require("../core");core.DisplayObject.prototype.getGlobalPosition=function(t){return t=t||new core.Point,this.parent?(this.displayObjectUpdateTransform(),t.x=this.worldTransform.tx,t.y=this.worldTransform.ty):(t.x=this.position.x,t.y=this.position.y),t};
},{"../core":37}],93:[function(require,module,exports){
require("./cacheAsBitmap"),require("./getChildByName"),require("./getGlobalPosition"),module.exports={MovieClip:require("./MovieClip"),TilingSprite:require("./TilingSprite"),BitmapText:require("./BitmapText")};
},{"./BitmapText":87,"./MovieClip":88,"./TilingSprite":89,"./cacheAsBitmap":90,"./getChildByName":91,"./getGlobalPosition":92}],94:[function(require,module,exports){
function AsciiFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nuniform vec4 dimensions;\nuniform float pixelSize;\nuniform sampler2D uSampler;\n\nfloat character(float n, vec2 p)\n{\n    p = floor(p*vec2(4.0, -4.0) + 2.5);\n    if (clamp(p.x, 0.0, 4.0) == p.x && clamp(p.y, 0.0, 4.0) == p.y)\n    {\n        if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;\n    }\n    return 0.0;\n}\n\nvoid main()\n{\n    vec2 uv = gl_FragCoord.xy;\n\n    vec3 col = texture2D(uSampler, floor( uv / pixelSize ) * pixelSize / dimensions.xy).rgb;\n\n    float gray = (col.r + col.g + col.b) / 3.0;\n\n    float n =  65536.0;             // .\n    if (gray > 0.2) n = 65600.0;    // :\n    if (gray > 0.3) n = 332772.0;   // *\n    if (gray > 0.4) n = 15255086.0; // o\n    if (gray > 0.5) n = 23385164.0; // &\n    if (gray > 0.6) n = 15252014.0; // 8\n    if (gray > 0.7) n = 13199452.0; // @\n    if (gray > 0.8) n = 11512810.0; // #\n\n    vec2 p = mod( uv / ( pixelSize * 0.5 ), 2.0) - vec2(1.0);\n    col = col * character(n, p);\n\n    gl_FragColor = vec4(col, 1.0);\n}\n",{dimensions:{type:"4fv",value:new Float32Array([0,0,0,0])},pixelSize:{type:"1f",value:8}})}var core=require("../../core");AsciiFilter.prototype=Object.create(core.AbstractFilter.prototype),AsciiFilter.prototype.constructor=AsciiFilter,module.exports=AsciiFilter,Object.defineProperties(AsciiFilter.prototype,{size:{get:function(){return this.uniforms.pixelSize.value},set:function(e){this.uniforms.pixelSize.value=e}}});
},{"../../core":37}],95:[function(require,module,exports){
function BloomFilter(){core.AbstractFilter.call(this),this.blurXFilter=new BlurXFilter,this.blurYFilter=new BlurYFilter,this.defaultFilter=new core.AbstractFilter}var core=require("../../core"),BlurXFilter=require("../blur/BlurXFilter"),BlurYFilter=require("../blur/BlurYFilter");BloomFilter.prototype=Object.create(core.AbstractFilter.prototype),BloomFilter.prototype.constructor=BloomFilter,module.exports=BloomFilter,BloomFilter.prototype.applyFilter=function(r,e,t){var l=r.filterManager.getRenderTarget(!0);this.defaultFilter.applyFilter(r,e,t),this.blurXFilter.applyFilter(r,e,l),r.blendModeManager.setBlendMode(core.BLEND_MODES.SCREEN),this.blurYFilter.applyFilter(r,l,t),r.blendModeManager.setBlendMode(core.BLEND_MODES.NORMAL),r.filterManager.returnRenderTarget(l)},Object.defineProperties(BloomFilter.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(r){this.blurXFilter.blur=this.blurYFilter.blur=r}},blurX:{get:function(){return this.blurXFilter.blur},set:function(r){this.blurXFilter.blur=r}},blurY:{get:function(){return this.blurYFilter.blur},set:function(r){this.blurYFilter.blur=r}}});
},{"../../core":37,"../blur/BlurXFilter":98,"../blur/BlurYFilter":99}],96:[function(require,module,exports){
function BlurDirFilter(r,e){core.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform float dirX;\nuniform float dirY;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[3];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[0] = aTextureCoord + vec2( (0.004 * strength) * dirX, (0.004 * strength) * dirY );\n    vBlurTexCoords[1] = aTextureCoord + vec2( (0.008 * strength) * dirX, (0.008 * strength) * dirY );\n    vBlurTexCoords[2] = aTextureCoord + vec2( (0.012 * strength) * dirX, (0.012 * strength) * dirY );\n\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[3];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vTextureCoord     ) * 0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0]) * 0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1]) * 0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2]) * 0.004431848411938341;\n}\n",{strength:{type:"1f",value:1},dirX:{type:"1f",value:r||0},dirY:{type:"1f",value:e||0}}),this.defaultFilter=new core.AbstractFilter,this.passes=1,this.dirX=r||0,this.dirY=e||0,this.strength=4}var core=require("../../core");BlurDirFilter.prototype=Object.create(core.AbstractFilter.prototype),BlurDirFilter.prototype.constructor=BlurDirFilter,module.exports=BlurDirFilter,BlurDirFilter.prototype.applyFilter=function(r,e,t,i){var o=this.getShader(r);if(this.uniforms.strength.value=this.strength/4/this.passes*(e.frame.width/e.size.width),1===this.passes)r.filterManager.applyFilter(o,e,t,i);else{var n=r.filterManager.getRenderTarget(!0);r.filterManager.applyFilter(o,e,n,i);for(var a=0;a<this.passes-2;a++)r.filterManager.applyFilter(o,n,n,i);r.filterManager.applyFilter(o,n,t,i),r.filterManager.returnRenderTarget(n)}},Object.defineProperties(BlurDirFilter.prototype,{blur:{get:function(){return this.strength},set:function(r){this.padding=.5*r,this.strength=r}},dirX:{get:function(){return this.dirX},set:function(r){this.uniforms.dirX.value=r}},dirY:{get:function(){return this.dirY},set:function(r){this.uniforms.dirY.value=r}}});
},{"../../core":37}],97:[function(require,module,exports){
function BlurFilter(){core.AbstractFilter.call(this),this.blurXFilter=new BlurXFilter,this.blurYFilter=new BlurYFilter}var core=require("../../core"),BlurXFilter=require("./BlurXFilter"),BlurYFilter=require("./BlurYFilter");BlurFilter.prototype=Object.create(core.AbstractFilter.prototype),BlurFilter.prototype.constructor=BlurFilter,module.exports=BlurFilter,BlurFilter.prototype.applyFilter=function(r,t,e){var l=r.filterManager.getRenderTarget(!0);this.blurXFilter.applyFilter(r,t,l),this.blurYFilter.applyFilter(r,l,e),r.filterManager.returnRenderTarget(l)},Object.defineProperties(BlurFilter.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(r){this.padding=.5*Math.abs(r),this.blurXFilter.blur=this.blurYFilter.blur=r}},passes:{get:function(){return this.blurXFilter.passes},set:function(r){this.blurXFilter.passes=this.blurYFilter.passes=r}},blurX:{get:function(){return this.blurXFilter.blur},set:function(r){this.blurXFilter.blur=r}},blurY:{get:function(){return this.blurYFilter.blur},set:function(r){this.blurYFilter.blur=r}}});
},{"../../core":37,"./BlurXFilter":98,"./BlurYFilter":99}],98:[function(require,module,exports){
function BlurXFilter(){core.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(-0.012 * strength, 0.0);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(-0.008 * strength, 0.0);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(-0.004 * strength, 0.0);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2( 0.004 * strength, 0.0);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2( 0.008 * strength, 0.0);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2( 0.012 * strength, 0.0);\n\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n}\n",{strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var core=require("../../core");BlurXFilter.prototype=Object.create(core.AbstractFilter.prototype),BlurXFilter.prototype.constructor=BlurXFilter,module.exports=BlurXFilter,BlurXFilter.prototype.applyFilter=function(r,e,t,o){var n=this.getShader(r);if(this.uniforms.strength.value=this.strength/4/this.passes*(e.frame.width/e.size.width),1===this.passes)r.filterManager.applyFilter(n,e,t,o);else{for(var l=r.filterManager.getRenderTarget(!0),a=e,i=l,u=0;u<this.passes-1;u++){r.filterManager.applyFilter(n,a,i,!0);var s=i;i=a,a=s}r.filterManager.applyFilter(n,a,t,o),r.filterManager.returnRenderTarget(l)}},Object.defineProperties(BlurXFilter.prototype,{blur:{get:function(){return this.strength},set:function(r){this.padding=.5*Math.abs(r),this.strength=r}}});
},{"../../core":37}],99:[function(require,module,exports){
function BlurYFilter(){core.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(0.0, -0.012 * strength);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(0.0, -0.008 * strength);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(0.0, -0.004 * strength);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2(0.0,  0.004 * strength);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2(0.0,  0.008 * strength);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2(0.0,  0.012 * strength);\n\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n}\n",{strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var core=require("../../core");BlurYFilter.prototype=Object.create(core.AbstractFilter.prototype),BlurYFilter.prototype.constructor=BlurYFilter,module.exports=BlurYFilter,BlurYFilter.prototype.applyFilter=function(r,e,t,o){var n=this.getShader(r);if(this.uniforms.strength.value=Math.abs(this.strength)/4/this.passes*(e.frame.height/e.size.height),1===this.passes)r.filterManager.applyFilter(n,e,t,o);else{for(var a=r.filterManager.getRenderTarget(!0),l=e,i=a,s=0;s<this.passes-1;s++){r.filterManager.applyFilter(n,l,i,!0);var u=i;i=l,l=u}r.filterManager.applyFilter(n,l,t,o),r.filterManager.returnRenderTarget(a)}},Object.defineProperties(BlurYFilter.prototype,{blur:{get:function(){return this.strength},set:function(r){this.padding=.5*Math.abs(r),this.strength=r}}});
},{"../../core":37}],100:[function(require,module,exports){
function SmartBlurFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 delta;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta * percent);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n",{delta:{type:"v2",value:{x:.1,y:0}}})}var core=require("../../core");SmartBlurFilter.prototype=Object.create(core.AbstractFilter.prototype),SmartBlurFilter.prototype.constructor=SmartBlurFilter,module.exports=SmartBlurFilter;
},{"../../core":37}],101:[function(require,module,exports){
function ColorMatrixFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[25];\n\nvoid main(void)\n{\n\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.r = (m[0] * c.r);\n        gl_FragColor.r += (m[1] * c.g);\n        gl_FragColor.r += (m[2] * c.b);\n        gl_FragColor.r += (m[3] * c.a);\n        gl_FragColor.r += m[4];\n\n    gl_FragColor.g = (m[5] * c.r);\n        gl_FragColor.g += (m[6] * c.g);\n        gl_FragColor.g += (m[7] * c.b);\n        gl_FragColor.g += (m[8] * c.a);\n        gl_FragColor.g += m[9];\n\n     gl_FragColor.b = (m[10] * c.r);\n        gl_FragColor.b += (m[11] * c.g);\n        gl_FragColor.b += (m[12] * c.b);\n        gl_FragColor.b += (m[13] * c.a);\n        gl_FragColor.b += m[14];\n\n     gl_FragColor.a = (m[15] * c.r);\n        gl_FragColor.a += (m[16] * c.g);\n        gl_FragColor.a += (m[17] * c.b);\n        gl_FragColor.a += (m[18] * c.a);\n        gl_FragColor.a += m[19];\n\n}\n",{m:{type:"1fv",value:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]}})}var core=require("../../core");ColorMatrixFilter.prototype=Object.create(core.AbstractFilter.prototype),ColorMatrixFilter.prototype.constructor=ColorMatrixFilter,module.exports=ColorMatrixFilter,ColorMatrixFilter.prototype._loadMatrix=function(r,o){o=!!o;var t=r;o&&(this._multiply(t,this.uniforms.m.value,r),t=this._colorMatrix(t)),this.uniforms.m.value=t},ColorMatrixFilter.prototype._multiply=function(r,o,t){return r[0]=o[0]*t[0]+o[1]*t[5]+o[2]*t[10]+o[3]*t[15],r[1]=o[0]*t[1]+o[1]*t[6]+o[2]*t[11]+o[3]*t[16],r[2]=o[0]*t[2]+o[1]*t[7]+o[2]*t[12]+o[3]*t[17],r[3]=o[0]*t[3]+o[1]*t[8]+o[2]*t[13]+o[3]*t[18],r[4]=o[0]*t[4]+o[1]*t[9]+o[2]*t[14]+o[3]*t[19],r[5]=o[5]*t[0]+o[6]*t[5]+o[7]*t[10]+o[8]*t[15],r[6]=o[5]*t[1]+o[6]*t[6]+o[7]*t[11]+o[8]*t[16],r[7]=o[5]*t[2]+o[6]*t[7]+o[7]*t[12]+o[8]*t[17],r[8]=o[5]*t[3]+o[6]*t[8]+o[7]*t[13]+o[8]*t[18],r[9]=o[5]*t[4]+o[6]*t[9]+o[7]*t[14]+o[8]*t[19],r[10]=o[10]*t[0]+o[11]*t[5]+o[12]*t[10]+o[13]*t[15],r[11]=o[10]*t[1]+o[11]*t[6]+o[12]*t[11]+o[13]*t[16],r[12]=o[10]*t[2]+o[11]*t[7]+o[12]*t[12]+o[13]*t[17],r[13]=o[10]*t[3]+o[11]*t[8]+o[12]*t[13]+o[13]*t[18],r[14]=o[10]*t[4]+o[11]*t[9]+o[12]*t[14]+o[13]*t[19],r[15]=o[15]*t[0]+o[16]*t[5]+o[17]*t[10]+o[18]*t[15],r[16]=o[15]*t[1]+o[16]*t[6]+o[17]*t[11]+o[18]*t[16],r[17]=o[15]*t[2]+o[16]*t[7]+o[17]*t[12]+o[18]*t[17],r[18]=o[15]*t[3]+o[16]*t[8]+o[17]*t[13]+o[18]*t[18],r[19]=o[15]*t[4]+o[16]*t[9]+o[17]*t[14]+o[18]*t[19],r},ColorMatrixFilter.prototype._colorMatrix=function(r){var o=new Float32Array(r);return o[4]/=255,o[9]/=255,o[14]/=255,o[19]/=255,o},ColorMatrixFilter.prototype.brightness=function(r,o){var t=[r,0,0,0,0,0,r,0,0,0,0,0,r,0,0,0,0,0,1,0];this._loadMatrix(t,o)},ColorMatrixFilter.prototype.greyscale=function(r,o){var t=[r,r,r,0,0,r,r,r,0,0,r,r,r,0,0,0,0,0,1,0];this._loadMatrix(t,o)},ColorMatrixFilter.prototype.grayscale=ColorMatrixFilter.prototype.greyscale,ColorMatrixFilter.prototype.blackAndWhite=function(r){var o=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(o,r)},ColorMatrixFilter.prototype.hue=function(r,o){r=(r||0)/180*Math.PI;var t=Math.cos(r),i=Math.sin(r),a=.213,l=.715,e=.072,n=[a+t*(1-a)+i*-a,l+t*-l+i*-l,e+t*-e+i*(1-e),0,0,a+t*-a+.143*i,l+t*(1-l)+.14*i,e+t*-e+i*-.283,0,0,a+t*-a+i*-(1-a),l+t*-l+i*l,e+t*(1-e)+i*e,0,0,0,0,0,1,0];this._loadMatrix(n,o)},ColorMatrixFilter.prototype.contrast=function(r,o){var t=(r||0)+1,i=-128*(t-1),a=[t,0,0,0,i,0,t,0,0,i,0,0,t,0,i,0,0,0,1,0];this._loadMatrix(a,o)},ColorMatrixFilter.prototype.saturate=function(r,o){var t=2*(r||0)/3+1,i=(t-1)*-.5,a=[t,i,i,0,0,i,t,i,0,0,i,i,t,0,0,0,0,0,1,0];this._loadMatrix(a,o)},ColorMatrixFilter.prototype.desaturate=function(r){this.saturate(-1)},ColorMatrixFilter.prototype.negative=function(r){var o=[0,1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0];this._loadMatrix(o,r)},ColorMatrixFilter.prototype.sepia=function(r){var o=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(o,r)},ColorMatrixFilter.prototype.technicolor=function(r){var o=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(o,r)},ColorMatrixFilter.prototype.polaroid=function(r){var o=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(o,r)},ColorMatrixFilter.prototype.toBGR=function(r){var o=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(o,r)},ColorMatrixFilter.prototype.kodachrome=function(r){var o=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(o,r)},ColorMatrixFilter.prototype.browni=function(r){var o=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(o,r)},ColorMatrixFilter.prototype.vintage=function(r){var o=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(o,r)},ColorMatrixFilter.prototype.colorTone=function(r,o,t,i,a){r=r||.2,o=o||.15,t=t||16770432,i=i||3375104;var l=(t>>16&255)/255,e=(t>>8&255)/255,n=(255&t)/255,p=(i>>16&255)/255,c=(i>>8&255)/255,g=(255&i)/255,x=[.3,.59,.11,0,0,l,e,n,r,0,p,c,g,o,0,l-p,e-c,n-g,0,0];this._loadMatrix(x,a)},ColorMatrixFilter.prototype.night=function(r,o){r=r||.1;var t=[-2*r,-r,0,0,0,-r,0,r,0,0,0,r,2*r,0,0,0,0,0,1,0];this._loadMatrix(t,o)},ColorMatrixFilter.prototype.predator=function(r,o){var t=[11.224130630493164*r,-4.794486999511719*r,-2.8746118545532227*r,0*r,.40342438220977783*r,-3.6330697536468506*r,9.193157196044922*r,-2.951810836791992*r,0*r,-1.316135048866272*r,-3.2184197902679443*r,-4.2375030517578125*r,7.476448059082031*r,0*r,.8044459223747253*r,0,0,0,1,0];this._loadMatrix(t,o)},ColorMatrixFilter.prototype.lsd=function(r){var o=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(o,r)},ColorMatrixFilter.prototype.reset=function(){var r=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(r,!1)},Object.defineProperties(ColorMatrixFilter.prototype,{matrix:{get:function(){return this.uniforms.m.value},set:function(r){this.uniforms.m.value=r}}});
},{"../../core":37}],102:[function(require,module,exports){
function ColorStepFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float step;\n\nvoid main(void)\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    color = floor(color * step) / step;\n\n    gl_FragColor = color;\n}\n",{step:{type:"1f",value:5}})}var core=require("../../core");ColorStepFilter.prototype=Object.create(core.AbstractFilter.prototype),ColorStepFilter.prototype.constructor=ColorStepFilter,module.exports=ColorStepFilter,Object.defineProperties(ColorStepFilter.prototype,{step:{get:function(){return this.uniforms.step.value},set:function(e){this.uniforms.step.value=e}}});
},{"../../core":37}],103:[function(require,module,exports){
function ConvolutionFilter(e,t,r){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying mediump vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 texelSize;\nuniform float matrix[9];\n\nvoid main(void)\n{\n   vec4 c11 = texture2D(uSampler, vTextureCoord - texelSize); // top left\n   vec4 c12 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - texelSize.y)); // top center\n   vec4 c13 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y - texelSize.y)); // top right\n\n   vec4 c21 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y)); // mid left\n   vec4 c22 = texture2D(uSampler, vTextureCoord); // mid center\n   vec4 c23 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y)); // mid right\n\n   vec4 c31 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y + texelSize.y)); // bottom left\n   vec4 c32 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + texelSize.y)); // bottom center\n   vec4 c33 = texture2D(uSampler, vTextureCoord + texelSize); // bottom right\n\n   gl_FragColor =\n       c11 * matrix[0] + c12 * matrix[1] + c13 * matrix[2] +\n       c21 * matrix[3] + c22 * matrix[4] + c23 * matrix[5] +\n       c31 * matrix[6] + c32 * matrix[7] + c33 * matrix[8];\n\n   gl_FragColor.a = c22.a;\n}\n",{matrix:{type:"1fv",value:new Float32Array(e)},texelSize:{type:"v2",value:{x:1/t,y:1/r}}})}var core=require("../../core");ConvolutionFilter.prototype=Object.create(core.AbstractFilter.prototype),ConvolutionFilter.prototype.constructor=ConvolutionFilter,module.exports=ConvolutionFilter,Object.defineProperties(ConvolutionFilter.prototype,{matrix:{get:function(){return this.uniforms.matrix.value},set:function(e){this.uniforms.matrix.value=new Float32Array(e)}},width:{get:function(){return 1/this.uniforms.texelSize.value.x},set:function(e){this.uniforms.texelSize.value.x=1/e}},height:{get:function(){return 1/this.uniforms.texelSize.value.y},set:function(e){this.uniforms.texelSize.value.y=1/e}}});
},{"../../core":37}],104:[function(require,module,exports){
function CrossHatchFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);\n\n    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\n    if (lum < 1.00)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.75)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.50)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.3)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n}\n")}var core=require("../../core");CrossHatchFilter.prototype=Object.create(core.AbstractFilter.prototype),CrossHatchFilter.prototype.constructor=CrossHatchFilter,module.exports=CrossHatchFilter;
},{"../../core":37}],105:[function(require,module,exports){
function DisplacementFilter(e,r){var t=new core.Matrix;e.renderable=!1,core.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vMapCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision mediump float;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nvoid main(void)\n{\n   vec4 map =  texture2D(mapSampler, vMapCoord);\n\n   map -= 0.5;\n   map.xy *= scale;\n\n   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y));\n}\n",{mapSampler:{type:"sampler2D",value:e.texture},otherMatrix:{type:"mat3",value:t.toArray(!0)},scale:{type:"v2",value:{x:1,y:1}}}),this.maskSprite=e,this.maskMatrix=t,(null===r||void 0===r)&&(r=20),this.scale=new core.Point(r,r)}var core=require("../../core");DisplacementFilter.prototype=Object.create(core.AbstractFilter.prototype),DisplacementFilter.prototype.constructor=DisplacementFilter,module.exports=DisplacementFilter,DisplacementFilter.prototype.applyFilter=function(e,r,t){var a=e.filterManager;a.calculateMappedMatrix(r.frame,this.maskSprite,this.maskMatrix),this.uniforms.otherMatrix.value=this.maskMatrix.toArray(!0),this.uniforms.scale.value.x=this.scale.x*(1/r.frame.width),this.uniforms.scale.value.y=this.scale.y*(1/r.frame.height);var o=this.getShader(e);a.applyFilter(o,r,t)},Object.defineProperties(DisplacementFilter.prototype,{map:{get:function(){return this.uniforms.mapSampler.value},set:function(e){this.uniforms.mapSampler.value=e}}});
},{"../../core":37}],106:[function(require,module,exports){
function DotScreenFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec4 dimensions;\nuniform sampler2D uSampler;\n\nuniform float angle;\nuniform float scale;\n\nfloat pattern()\n{\n   float s = sin(angle), c = cos(angle);\n   vec2 tex = vTextureCoord * dimensions.xy;\n   vec2 point = vec2(\n       c * tex.x - s * tex.y,\n       s * tex.x + c * tex.y\n   ) * scale;\n   return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvoid main()\n{\n   vec4 color = texture2D(uSampler, vTextureCoord);\n   float average = (color.r + color.g + color.b) / 3.0;\n   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);\n}\n",{scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}})}var core=require("../../core");DotScreenFilter.prototype=Object.create(core.AbstractFilter.prototype),DotScreenFilter.prototype.constructor=DotScreenFilter,module.exports=DotScreenFilter,Object.defineProperties(DotScreenFilter.prototype,{scale:{get:function(){return this.uniforms.scale.value},set:function(e){this.uniforms.scale.value=e}},angle:{get:function(){return this.uniforms.angle.value},set:function(e){this.uniforms.angle.value=e}}});
},{"../../core":37}],107:[function(require,module,exports){
function BlurYTintFilter(){core.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform vec2 offset;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition+offset), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(0.0, -0.012 * strength);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(0.0, -0.008 * strength);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(0.0, -0.004 * strength);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2(0.0,  0.004 * strength);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2(0.0,  0.008 * strength);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2(0.0,  0.012 * strength);\n\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform vec3 color;\nuniform float alpha;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    vec4 sum = vec4(0.0);\n\n    sum += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    sum += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    sum += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    sum += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    sum += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    sum += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    sum += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n\n    gl_FragColor = vec4( color.rgb * sum.a * alpha, sum.a * alpha );\n}\n",{blur:{type:"1f",value:1/512},color:{type:"c",value:[0,0,0]},alpha:{type:"1f",value:.7},offset:{type:"2f",value:[5,5]},strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var core=require("../../core");BlurYTintFilter.prototype=Object.create(core.AbstractFilter.prototype),BlurYTintFilter.prototype.constructor=BlurYTintFilter,module.exports=BlurYTintFilter,BlurYTintFilter.prototype.applyFilter=function(e,r,t,o){var n=this.getShader(e);if(this.uniforms.strength.value=this.strength/4/this.passes*(r.frame.height/r.size.height),1===this.passes)e.filterManager.applyFilter(n,r,t,o);else{for(var a=e.filterManager.getRenderTarget(!0),l=r,u=a,i=0;i<this.passes-1;i++){e.filterManager.applyFilter(n,l,u,o);var s=u;u=l,l=s}e.filterManager.applyFilter(n,l,t,o),e.filterManager.returnRenderTarget(a)}},Object.defineProperties(BlurYTintFilter.prototype,{blur:{get:function(){return this.strength},set:function(e){this.padding=.5*e,this.strength=e}}});
},{"../../core":37}],108:[function(require,module,exports){
function DropShadowFilter(){core.AbstractFilter.call(this),this.blurXFilter=new BlurXFilter,this.blurYTintFilter=new BlurYTintFilter,this.defaultFilter=new core.AbstractFilter,this.padding=30,this._dirtyPosition=!0,this._angle=45*Math.PI/180,this._distance=10,this.alpha=.75,this.hideObject=!1,this.blendMode=core.BLEND_MODES.MULTIPLY}var core=require("../../core"),BlurXFilter=require("../blur/BlurXFilter"),BlurYTintFilter=require("./BlurYTintFilter");DropShadowFilter.prototype=Object.create(core.AbstractFilter.prototype),DropShadowFilter.prototype.constructor=DropShadowFilter,module.exports=DropShadowFilter,DropShadowFilter.prototype.applyFilter=function(t,r,i){var e=t.filterManager.getRenderTarget(!0);this._dirtyPosition&&(this._dirtyPosition=!1,this.blurYTintFilter.uniforms.offset.value[0]=Math.sin(this._angle)*this._distance,this.blurYTintFilter.uniforms.offset.value[1]=Math.cos(this._angle)*this._distance),this.blurXFilter.applyFilter(t,r,e),t.blendModeManager.setBlendMode(this.blendMode),this.blurYTintFilter.applyFilter(t,e,i),t.blendModeManager.setBlendMode(core.BLEND_MODES.NORMAL),this.hideObject||this.defaultFilter.applyFilter(t,r,i),t.filterManager.returnRenderTarget(e)},Object.defineProperties(DropShadowFilter.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYTintFilter.blur=t}},blurX:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}},blurY:{get:function(){return this.blurYTintFilter.blur},set:function(t){this.blurYTintFilter.blur=t}},color:{get:function(){return core.utils.rgb2hex(this.blurYTintFilter.uniforms.color.value)},set:function(t){this.blurYTintFilter.uniforms.color.value=core.utils.hex2rgb(t)}},alpha:{get:function(){return this.blurYTintFilter.uniforms.alpha.value},set:function(t){this.blurYTintFilter.uniforms.alpha.value=t}},distance:{get:function(){return this._distance},set:function(t){this._dirtyPosition=!0,this._distance=t}},angle:{get:function(){return this._angle},set:function(t){this._dirtyPosition=!0,this._angle=t}}});
},{"../../core":37,"../blur/BlurXFilter":98,"./BlurYTintFilter":107}],109:[function(require,module,exports){
function GrayFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform float gray;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);\n}\n",{gray:{type:"1f",value:1}})}var core=require("../../core");GrayFilter.prototype=Object.create(core.AbstractFilter.prototype),GrayFilter.prototype.constructor=GrayFilter,module.exports=GrayFilter,Object.defineProperties(GrayFilter.prototype,{gray:{get:function(){return this.uniforms.gray.value},set:function(r){this.uniforms.gray.value=r}}});
},{"../../core":37}],110:[function(require,module,exports){
module.exports={AsciiFilter:require("./ascii/AsciiFilter"),BloomFilter:require("./bloom/BloomFilter"),BlurFilter:require("./blur/BlurFilter"),BlurXFilter:require("./blur/BlurXFilter"),BlurYFilter:require("./blur/BlurYFilter"),BlurDirFilter:require("./blur/BlurDirFilter"),ColorMatrixFilter:require("./color/ColorMatrixFilter"),ColorStepFilter:require("./color/ColorStepFilter"),ConvolutionFilter:require("./convolution/ConvolutionFilter"),CrossHatchFilter:require("./crosshatch/CrossHatchFilter"),DisplacementFilter:require("./displacement/DisplacementFilter"),DotScreenFilter:require("./dot/DotScreenFilter"),GrayFilter:require("./gray/GrayFilter"),DropShadowFilter:require("./dropshadow/DropShadowFilter"),InvertFilter:require("./invert/InvertFilter"),NoiseFilter:require("./noise/NoiseFilter"),PixelateFilter:require("./pixelate/PixelateFilter"),RGBSplitFilter:require("./rgb/RGBSplitFilter"),ShockwaveFilter:require("./shockwave/ShockwaveFilter"),SepiaFilter:require("./sepia/SepiaFilter"),SmartBlurFilter:require("./blur/SmartBlurFilter"),TiltShiftFilter:require("./tiltshift/TiltShiftFilter"),TiltShiftXFilter:require("./tiltshift/TiltShiftXFilter"),TiltShiftYFilter:require("./tiltshift/TiltShiftYFilter"),TwistFilter:require("./twist/TwistFilter")};
},{"./ascii/AsciiFilter":94,"./bloom/BloomFilter":95,"./blur/BlurDirFilter":96,"./blur/BlurFilter":97,"./blur/BlurXFilter":98,"./blur/BlurYFilter":99,"./blur/SmartBlurFilter":100,"./color/ColorMatrixFilter":101,"./color/ColorStepFilter":102,"./convolution/ConvolutionFilter":103,"./crosshatch/CrossHatchFilter":104,"./displacement/DisplacementFilter":105,"./dot/DotScreenFilter":106,"./dropshadow/DropShadowFilter":108,"./gray/GrayFilter":109,"./invert/InvertFilter":111,"./noise/NoiseFilter":112,"./pixelate/PixelateFilter":113,"./rgb/RGBSplitFilter":114,"./sepia/SepiaFilter":115,"./shockwave/ShockwaveFilter":116,"./tiltshift/TiltShiftFilter":118,"./tiltshift/TiltShiftXFilter":119,"./tiltshift/TiltShiftYFilter":120,"./twist/TwistFilter":121}],111:[function(require,module,exports){
function InvertFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform float invert;\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);\n}\n",{invert:{type:"1f",value:1}})}var core=require("../../core");InvertFilter.prototype=Object.create(core.AbstractFilter.prototype),InvertFilter.prototype.constructor=InvertFilter,module.exports=InvertFilter,Object.defineProperties(InvertFilter.prototype,{invert:{get:function(){return this.uniforms.invert.value},set:function(r){this.uniforms.invert.value=r}}});
},{"../../core":37}],112:[function(require,module,exports){
function NoiseFilter(){core.AbstractFilter.call(this,null,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float noise;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    float diff = (rand(vTextureCoord) - 0.5) * noise;\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    gl_FragColor = color;\n}\n",{noise:{type:"1f",value:.5}})}var core=require("../../core");NoiseFilter.prototype=Object.create(core.AbstractFilter.prototype),NoiseFilter.prototype.constructor=NoiseFilter,module.exports=NoiseFilter,Object.defineProperties(NoiseFilter.prototype,{noise:{get:function(){return this.uniforms.noise.value},set:function(e){this.uniforms.noise.value=e}}});
},{"../../core":37}],113:[function(require,module,exports){
function PixelateFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 dimensions;\nuniform vec2 pixelSize;\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord;\n\n    vec2 size = dimensions.xy / pixelSize;\n\n    vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;\n\n    gl_FragColor = texture2D(uSampler, color);\n}\n",{dimensions:{type:"4fv",value:new Float32Array([0,0,0,0])},pixelSize:{type:"v2",value:{x:10,y:10}}})}var core=require("../../core");PixelateFilter.prototype=Object.create(core.AbstractFilter.prototype),PixelateFilter.prototype.constructor=PixelateFilter,module.exports=PixelateFilter,Object.defineProperties(PixelateFilter.prototype,{size:{get:function(){return this.uniforms.pixelSize.value},set:function(e){this.uniforms.pixelSize.value=e}}});
},{"../../core":37}],114:[function(require,module,exports){
function RGBSplitFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 dimensions;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nvoid main(void)\n{\n   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;\n   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;\n   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;\n   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;\n}\n",{red:{type:"v2",value:{x:20,y:20}},green:{type:"v2",value:{x:-20,y:20}},blue:{type:"v2",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}})}var core=require("../../core");RGBSplitFilter.prototype=Object.create(core.AbstractFilter.prototype),RGBSplitFilter.prototype.constructor=RGBSplitFilter,module.exports=RGBSplitFilter,Object.defineProperties(RGBSplitFilter.prototype,{red:{get:function(){return this.uniforms.red.value},set:function(e){this.uniforms.red.value=e}},green:{get:function(){return this.uniforms.green.value},set:function(e){this.uniforms.green.value=e}},blue:{get:function(){return this.uniforms.blue.value},set:function(e){this.uniforms.blue.value=e}}});
},{"../../core":37}],115:[function(require,module,exports){
function SepiaFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float sepia;\n\nconst mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);\n}\n",{sepia:{type:"1f",value:1}})}var core=require("../../core");SepiaFilter.prototype=Object.create(core.AbstractFilter.prototype),SepiaFilter.prototype.constructor=SepiaFilter,module.exports=SepiaFilter,Object.defineProperties(SepiaFilter.prototype,{sepia:{get:function(){return this.uniforms.sepia.value},set:function(e){this.uniforms.sepia.value=e}}});
},{"../../core":37}],116:[function(require,module,exports){
function ShockwaveFilter(){core.AbstractFilter.call(this,null,"precision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nuniform vec2 center;\nuniform vec3 params; // 10.0, 0.8, 0.1\nuniform float time;\n\nvoid main()\n{\n    vec2 uv = vTextureCoord;\n    vec2 texCoord = uv;\n\n    float dist = distance(uv, center);\n\n    if ( (dist <= (time + params.z)) && (dist >= (time - params.z)) )\n    {\n        float diff = (dist - time);\n        float powDiff = 1.0 - pow(abs(diff*params.x), params.y);\n\n        float diffTime = diff  * powDiff;\n        vec2 diffUV = normalize(uv - center);\n        texCoord = uv + (diffUV * diffTime);\n    }\n\n    gl_FragColor = texture2D(uSampler, texCoord);\n}\n",{center:{type:"v2",value:{x:.5,y:.5}},params:{type:"v3",value:{x:10,y:.8,z:.1}},time:{type:"1f",value:0}})}var core=require("../../core");ShockwaveFilter.prototype=Object.create(core.AbstractFilter.prototype),ShockwaveFilter.prototype.constructor=ShockwaveFilter,module.exports=ShockwaveFilter,Object.defineProperties(ShockwaveFilter.prototype,{center:{get:function(){return this.uniforms.center.value},set:function(e){this.uniforms.center.value=e}},params:{get:function(){return this.uniforms.params.value},set:function(e){this.uniforms.params.value=e}},time:{get:function(){return this.uniforms.time.value},set:function(e){this.uniforms.time.value=e}}});
},{"../../core":37}],117:[function(require,module,exports){
function TiltShiftAxisFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float blur;\nuniform float gradientBlur;\nuniform vec2 start;\nuniform vec2 end;\nuniform vec2 delta;\nuniform vec2 texSize;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n",{blur:{type:"1f",value:100},gradientBlur:{type:"1f",value:600},start:{type:"v2",value:{x:0,y:window.innerHeight/2}},end:{type:"v2",value:{x:600,y:window.innerHeight/2}},delta:{type:"v2",value:{x:30,y:30}},texSize:{type:"v2",value:{x:window.innerWidth,y:window.innerHeight}}}),this.updateDelta()}var core=require("../../core");TiltShiftAxisFilter.prototype=Object.create(core.AbstractFilter.prototype),TiltShiftAxisFilter.prototype.constructor=TiltShiftAxisFilter,module.exports=TiltShiftAxisFilter,TiltShiftAxisFilter.prototype.updateDelta=function(){this.uniforms.delta.value.x=0,this.uniforms.delta.value.y=0},Object.defineProperties(TiltShiftAxisFilter.prototype,{blur:{get:function(){return this.uniforms.blur.value},set:function(t){this.uniforms.blur.value=t}},gradientBlur:{get:function(){return this.uniforms.gradientBlur.value},set:function(t){this.uniforms.gradientBlur.value=t}},start:{get:function(){return this.uniforms.start.value},set:function(t){this.uniforms.start.value=t,this.updateDelta()}},end:{get:function(){return this.uniforms.end.value},set:function(t){this.uniforms.end.value=t,this.updateDelta()}}});
},{"../../core":37}],118:[function(require,module,exports){
function TiltShiftFilter(){core.AbstractFilter.call(this),this.tiltShiftXFilter=new TiltShiftXFilter,this.tiltShiftYFilter=new TiltShiftYFilter}var core=require("../../core"),TiltShiftXFilter=require("./TiltShiftXFilter"),TiltShiftYFilter=require("./TiltShiftYFilter");TiltShiftFilter.prototype=Object.create(core.AbstractFilter.prototype),TiltShiftFilter.prototype.constructor=TiltShiftFilter,module.exports=TiltShiftFilter,TiltShiftFilter.prototype.applyFilter=function(t,i,e){var r=t.filterManager.getRenderTarget(!0);this.tiltShiftXFilter.applyFilter(t,i,r),this.tiltShiftYFilter.applyFilter(t,r,e),t.filterManager.returnRenderTarget(r)},Object.defineProperties(TiltShiftFilter.prototype,{blur:{get:function(){return this.tiltShiftXFilter.blur},set:function(t){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=t}},gradientBlur:{get:function(){return this.tiltShiftXFilter.gradientBlur},set:function(t){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=t}},start:{get:function(){return this.tiltShiftXFilter.start},set:function(t){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=t}},end:{get:function(){return this.tiltShiftXFilter.end},set:function(t){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=t}}});
},{"../../core":37,"./TiltShiftXFilter":119,"./TiltShiftYFilter":120}],119:[function(require,module,exports){
function TiltShiftXFilter(){TiltShiftAxisFilter.call(this)}var TiltShiftAxisFilter=require("./TiltShiftAxisFilter");TiltShiftXFilter.prototype=Object.create(TiltShiftAxisFilter.prototype),TiltShiftXFilter.prototype.constructor=TiltShiftXFilter,module.exports=TiltShiftXFilter,TiltShiftXFilter.prototype.updateDelta=function(){var t=this.uniforms.end.value.x-this.uniforms.start.value.x,i=this.uniforms.end.value.y-this.uniforms.start.value.y,e=Math.sqrt(t*t+i*i);this.uniforms.delta.value.x=t/e,this.uniforms.delta.value.y=i/e};
},{"./TiltShiftAxisFilter":117}],120:[function(require,module,exports){
function TiltShiftYFilter(){TiltShiftAxisFilter.call(this)}var TiltShiftAxisFilter=require("./TiltShiftAxisFilter");TiltShiftYFilter.prototype=Object.create(TiltShiftAxisFilter.prototype),TiltShiftYFilter.prototype.constructor=TiltShiftYFilter,module.exports=TiltShiftYFilter,TiltShiftYFilter.prototype.updateDelta=function(){var t=this.uniforms.end.value.x-this.uniforms.start.value.x,i=this.uniforms.end.value.y-this.uniforms.start.value.y,e=Math.sqrt(t*t+i*i);this.uniforms.delta.value.x=-i/e,this.uniforms.delta.value.y=t/e};
},{"./TiltShiftAxisFilter":117}],121:[function(require,module,exports){
function TwistFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\n\nvoid main(void)\n{\n   vec2 coord = vTextureCoord - offset;\n   float dist = length(coord);\n\n   if (dist < radius)\n   {\n       float ratio = (radius - dist) / radius;\n       float angleMod = ratio * ratio * angle;\n       float s = sin(angleMod);\n       float c = cos(angleMod);\n       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n   }\n\n   gl_FragColor = texture2D(uSampler, coord+offset);\n}\n",{radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"v2",value:{x:.5,y:.5}}})}var core=require("../../core");TwistFilter.prototype=Object.create(core.AbstractFilter.prototype),TwistFilter.prototype.constructor=TwistFilter,module.exports=TwistFilter,Object.defineProperties(TwistFilter.prototype,{offset:{get:function(){return this.uniforms.offset.value},set:function(t){this.uniforms.offset.value=t}},radius:{get:function(){return this.uniforms.radius.value},set:function(t){this.uniforms.radius.value=t}},angle:{get:function(){return this.uniforms.angle.value},set:function(t){this.uniforms.angle.value=t}}});
},{"../../core":37}],122:[function(require,module,exports){
(function (global){
require("./polyfill");var core=module.exports=require("./core");core.extras=require("./extras"),core.filters=require("./filters"),core.interaction=require("./interaction"),core.loaders=require("./loaders"),core.mesh=require("./mesh"),core.loader=new core.loaders.Loader,Object.assign(core,require("./deprecation")),global.PIXI=core;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./core":37,"./deprecation":86,"./extras":93,"./filters":110,"./interaction":125,"./loaders":128,"./mesh":134,"./polyfill":139}],123:[function(require,module,exports){
function InteractionData(){this.global=new core.Point,this.target=null,this.originalEvent=null}var core=require("../core");InteractionData.prototype.constructor=InteractionData,module.exports=InteractionData,InteractionData.prototype.getLocalPosition=function(t,o,n){return t.toLocal(n?n:this.global,o)};
},{"../core":37}],124:[function(require,module,exports){
function InteractionManager(t,e){e=e||{},this.renderer=t,this.autoPreventDefault=void 0!==e.autoPreventDefault?e.autoPreventDefault:!0,this.interactionFrequency=e.interactionFrequency||10,this.mouse=new InteractionData,this.eventData={stopped:!1,target:null,type:null,data:this.mouse,stopPropagation:function(){this.stopped=!0}},this.interactiveDataPool=[],this.interactionDOMElement=null,this.eventsAdded=!1,this.onMouseUp=this.onMouseUp.bind(this),this.processMouseUp=this.processMouseUp.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.processMouseDown=this.processMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.processMouseMove=this.processMouseMove.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.processMouseOverOut=this.processMouseOverOut.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.processTouchStart=this.processTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.processTouchEnd=this.processTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.processTouchMove=this.processTouchMove.bind(this),this.last=0,this.currentCursorStyle="inherit",this._tempPoint=new core.Point,this.resolution=1,this.setTargetElement(this.renderer.view,this.renderer.resolution)}var core=require("../core"),InteractionData=require("./InteractionData");Object.assign(core.DisplayObject.prototype,require("./interactiveTarget")),InteractionManager.prototype.constructor=InteractionManager,module.exports=InteractionManager,InteractionManager.prototype.setTargetElement=function(t,e){this.removeEvents(),this.interactionDOMElement=t,this.resolution=e||1,this.addEvents()},InteractionManager.prototype.addEvents=function(){this.interactionDOMElement&&(core.ticker.shared.add(this.update,this),window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"),window.document.addEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.addEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.addEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!0)},InteractionManager.prototype.removeEvents=function(){this.interactionDOMElement&&(core.ticker.shared.remove(this.update),window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""),window.document.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null,window.removeEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!1)},InteractionManager.prototype.update=function(t){if(this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement)){if(this.didMove)return void(this.didMove=!1);this.cursor="inherit",this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor)}},InteractionManager.prototype.dispatchEvent=function(t,e,o){o.stopped||(o.target=t,o.type=e,t.emit(e,o),t[e]&&t[e](o))},InteractionManager.prototype.mapPositionToPoint=function(t,e,o){var n=this.interactionDOMElement.getBoundingClientRect();t.x=(e-n.left)*(this.interactionDOMElement.width/n.width)/this.resolution,t.y=(o-n.top)*(this.interactionDOMElement.height/n.height)/this.resolution},InteractionManager.prototype.processInteractive=function(t,e,o,n,i){if(!e||!e.visible)return!1;var s=e.children,r=!1;if(i=i||e.interactive,e.interactiveChildren)for(var a=s.length-1;a>=0;a--)!r&&n?r=this.processInteractive(t,s[a],o,!0,i):this.processInteractive(t,s[a],o,!1,!1);return i&&(n&&(e.hitArea?(e.worldTransform.applyInverse(t,this._tempPoint),r=e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)):e.containsPoint&&(r=e.containsPoint(t))),e.interactive&&o(e,r)),r},InteractionManager.prototype.onMouseDown=function(t){this.mouse.originalEvent=t,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.autoPreventDefault&&this.mouse.originalEvent.preventDefault(),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseDown,!0)},InteractionManager.prototype.processMouseDown=function(t,e){var o=this.mouse.originalEvent,n=2===o.button||3===o.which;e&&(t[n?"_isRightDown":"_isLeftDown"]=!0,this.dispatchEvent(t,n?"rightdown":"mousedown",this.eventData))},InteractionManager.prototype.onMouseUp=function(t){this.mouse.originalEvent=t,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseUp,!0)},InteractionManager.prototype.processMouseUp=function(t,e){var o=this.mouse.originalEvent,n=2===o.button||3===o.which,i=n?"_isRightDown":"_isLeftDown";e?(this.dispatchEvent(t,n?"rightup":"mouseup",this.eventData),t[i]&&(t[i]=!1,this.dispatchEvent(t,n?"rightclick":"click",this.eventData))):t[i]&&(t[i]=!1,this.dispatchEvent(t,n?"rightupoutside":"mouseupoutside",this.eventData))},InteractionManager.prototype.onMouseMove=function(t){this.mouse.originalEvent=t,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.didMove=!0,this.cursor="inherit",this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseMove,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor)},InteractionManager.prototype.processMouseMove=function(t,e){this.dispatchEvent(t,"mousemove",this.eventData),this.processMouseOverOut(t,e)},InteractionManager.prototype.onMouseOut=function(t){this.mouse.originalEvent=t,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.interactionDOMElement.style.cursor="inherit",this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!1)},InteractionManager.prototype.processMouseOverOut=function(t,e){e?(t._over||(t._over=!0,this.dispatchEvent(t,"mouseover",this.eventData)),t.buttonMode&&(this.cursor=t.defaultCursor)):t._over&&(t._over=!1,this.dispatchEvent(t,"mouseout",this.eventData))},InteractionManager.prototype.onTouchStart=function(t){this.autoPreventDefault&&t.preventDefault();for(var e=t.changedTouches,o=e.length,n=0;o>n;n++){var i=e[n],s=this.getTouchData(i);s.originalEvent=t,this.eventData.data=s,this.eventData.stopped=!1,this.processInteractive(s.global,this.renderer._lastObjectRendered,this.processTouchStart,!0),this.returnTouchData(s)}},InteractionManager.prototype.processTouchStart=function(t,e){e&&(t._touchDown=!0,this.dispatchEvent(t,"touchstart",this.eventData))},InteractionManager.prototype.onTouchEnd=function(t){this.autoPreventDefault&&t.preventDefault();for(var e=t.changedTouches,o=e.length,n=0;o>n;n++){var i=e[n],s=this.getTouchData(i);s.originalEvent=t,this.eventData.data=s,this.eventData.stopped=!1,this.processInteractive(s.global,this.renderer._lastObjectRendered,this.processTouchEnd,!0),this.returnTouchData(s)}},InteractionManager.prototype.processTouchEnd=function(t,e){e?(this.dispatchEvent(t,"touchend",this.eventData),t._touchDown&&(t._touchDown=!1,this.dispatchEvent(t,"tap",this.eventData))):t._touchDown&&(t._touchDown=!1,this.dispatchEvent(t,"touchendoutside",this.eventData))},InteractionManager.prototype.onTouchMove=function(t){this.autoPreventDefault&&t.preventDefault();for(var e=t.changedTouches,o=e.length,n=0;o>n;n++){var i=e[n],s=this.getTouchData(i);s.originalEvent=t,this.eventData.data=s,this.eventData.stopped=!1,this.processInteractive(s.global,this.renderer._lastObjectRendered,this.processTouchMove,!0),this.returnTouchData(s)}},InteractionManager.prototype.processTouchMove=function(t,e){e=e,this.dispatchEvent(t,"touchmove",this.eventData)},InteractionManager.prototype.getTouchData=function(t){var e=this.interactiveDataPool.pop();return e||(e=new InteractionData),e.identifier=t.identifier,this.mapPositionToPoint(e.global,t.clientX,t.clientY),navigator.isCocoonJS&&(e.global.x=e.global.x/this.resolution,e.global.y=e.global.y/this.resolution),t.globalX=e.global.x,t.globalY=e.global.y,e},InteractionManager.prototype.returnTouchData=function(t){this.interactiveDataPool.push(t)},InteractionManager.prototype.destroy=function(){this.removeEvents(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactiveDataPool=null,this.interactionDOMElement=null,this.onMouseUp=null,this.processMouseUp=null,this.onMouseDown=null,this.processMouseDown=null,this.onMouseMove=null,this.processMouseMove=null,this.onMouseOut=null,this.processMouseOverOut=null,this.onTouchStart=null,this.processTouchStart=null,this.onTouchEnd=null,this.processTouchEnd=null,this.onTouchMove=null,this.processTouchMove=null,this._tempPoint=null},core.WebGLRenderer.registerPlugin("interaction",InteractionManager),core.CanvasRenderer.registerPlugin("interaction",InteractionManager);
},{"../core":37,"./InteractionData":123,"./interactiveTarget":126}],125:[function(require,module,exports){
module.exports={InteractionData:require("./InteractionData"),InteractionManager:require("./InteractionManager"),interactiveTarget:require("./interactiveTarget")};
},{"./InteractionData":123,"./InteractionManager":124,"./interactiveTarget":126}],126:[function(require,module,exports){
var interactiveTarget={interactive:!1,buttonMode:!1,interactiveChildren:!0,defaultCursor:"pointer",_over:!1,_touchDown:!1};module.exports=interactiveTarget;
},{}],127:[function(require,module,exports){
function parse(e,t){var r={},a=e.data.getElementsByTagName("info")[0],n=e.data.getElementsByTagName("common")[0];r.font=a.getAttribute("face"),r.size=parseInt(a.getAttribute("size"),10),r.lineHeight=parseInt(n.getAttribute("lineHeight"),10),r.chars={};for(var s=e.data.getElementsByTagName("char"),i=0;i<s.length;i++){var g=parseInt(s[i].getAttribute("id"),10),u=new core.Rectangle(parseInt(s[i].getAttribute("x"),10)+t.frame.x,parseInt(s[i].getAttribute("y"),10)+t.frame.y,parseInt(s[i].getAttribute("width"),10),parseInt(s[i].getAttribute("height"),10));r.chars[g]={xOffset:parseInt(s[i].getAttribute("xoffset"),10),yOffset:parseInt(s[i].getAttribute("yoffset"),10),xAdvance:parseInt(s[i].getAttribute("xadvance"),10),kerning:{},texture:new core.Texture(t.baseTexture,u)}}var o=e.data.getElementsByTagName("kerning");for(i=0;i<o.length;i++){var l=parseInt(o[i].getAttribute("first"),10),c=parseInt(o[i].getAttribute("second"),10),f=parseInt(o[i].getAttribute("amount"),10);r.chars[c].kerning[l]=f}e.bitmapFont=r,extras.BitmapText.fonts[r.font]=r}var Resource=require("resource-loader").Resource,core=require("../core"),extras=require("../extras"),path=require("path");module.exports=function(){return function(e,t){if(!e.data||!e.isXml)return t();if(0===e.data.getElementsByTagName("page").length||0===e.data.getElementsByTagName("info").length||null===e.data.getElementsByTagName("info")[0].getAttribute("face"))return t();var r=path.dirname(e.url);"."===r&&(r=""),this.baseUrl&&r&&("/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(r+="/"),r=r.replace(this.baseUrl,"")),r&&"/"!==r.charAt(r.length-1)&&(r+="/");var a=r+e.data.getElementsByTagName("page")[0].getAttribute("file");if(core.utils.TextureCache[a])parse(e,core.utils.TextureCache[a]),t();else{var n={crossOrigin:e.crossOrigin,loadType:Resource.LOAD_TYPE.IMAGE};this.add(e.name+"_image",a,n,function(r){parse(e,r.texture),t()})}}};
},{"../core":37,"../extras":93,"path":1,"resource-loader":26}],128:[function(require,module,exports){
module.exports={Loader:require("./loader"),bitmapFontParser:require("./bitmapFontParser"),spritesheetParser:require("./spritesheetParser"),textureParser:require("./textureParser"),Resource:require("resource-loader").Resource};
},{"./bitmapFontParser":127,"./loader":129,"./spritesheetParser":130,"./textureParser":131,"resource-loader":26}],129:[function(require,module,exports){
function Loader(e,r){ResourceLoader.call(this,e,r);for(var o=0;o<Loader._pixiMiddleware.length;++o)this.use(Loader._pixiMiddleware[o]())}var ResourceLoader=require("resource-loader"),textureParser=require("./textureParser"),spritesheetParser=require("./spritesheetParser"),bitmapFontParser=require("./bitmapFontParser");Loader.prototype=Object.create(ResourceLoader.prototype),Loader.prototype.constructor=Loader,module.exports=Loader,Loader._pixiMiddleware=[ResourceLoader.middleware.parsing.blob,textureParser,spritesheetParser,bitmapFontParser],Loader.addPixiMiddleware=function(e){Loader._pixiMiddleware.push(e)};var Resource=ResourceLoader.Resource;Resource.setExtensionXhrType("fnt",Resource.XHR_RESPONSE_TYPE.DOCUMENT);
},{"./bitmapFontParser":127,"./spritesheetParser":130,"./textureParser":131,"resource-loader":26}],130:[function(require,module,exports){
var Resource=require("resource-loader").Resource,path=require("path"),core=require("../core");module.exports=function(){return function(e,r){if(!e.data||!e.isJson||!e.data.frames)return r();var t={crossOrigin:e.crossOrigin,loadType:Resource.LOAD_TYPE.IMAGE},a=path.dirname(e.url.replace(this.baseUrl,"")),i=core.utils.getResolutionOfUrl(e.url);this.add(e.name+"_image",a+"/"+e.data.meta.image,t,function(t){e.textures={};var a=e.data.frames;for(var o in a){var u=a[o].frame;if(u){var c=null,s=null;if(c=a[o].rotated?new core.Rectangle(u.x,u.y,u.h,u.w):new core.Rectangle(u.x,u.y,u.w,u.h),a[o].trimmed&&(s=new core.Rectangle(a[o].spriteSourceSize.x/i,a[o].spriteSourceSize.y/i,a[o].sourceSize.w/i,a[o].sourceSize.h/i)),a[o].rotated){var n=c.width;c.width=c.height,c.height=n}c.x/=i,c.y/=i,c.width/=i,c.height/=i,e.textures[o]=new core.Texture(t.texture.baseTexture,c,c.clone(),s,a[o].rotated),core.utils.TextureCache[o]=e.textures[o]}}r()})}};
},{"../core":37,"path":1,"resource-loader":26}],131:[function(require,module,exports){
var core=require("../core");module.exports=function(){return function(e,r){if(e.data&&e.isImage){var u=new core.BaseTexture(e.data,null,core.utils.getResolutionOfUrl(e.url));u.imageUrl=e.url,e.texture=new core.Texture(u),core.utils.BaseTextureCache[e.url]=u,core.utils.TextureCache[e.url]=e.texture}r()}};
},{"../core":37}],132:[function(require,module,exports){
function Mesh(e,t,r,n,s){core.Container.call(this),this._texture=null,this.uvs=r||new Float32Array([0,1,1,1,1,0,0,1]),this.vertices=t||new Float32Array([0,0,100,0,100,100,0,100]),this.indices=n||new Uint16Array([0,1,2,3]),this.dirty=!0,this.blendMode=core.BLEND_MODES.NORMAL,this.canvasPadding=0,this.drawMode=s||Mesh.DRAW_MODES.TRIANGLE_MESH,this.texture=e}var core=require("../core"),tempPoint=new core.Point,tempPolygon=new core.Polygon;Mesh.prototype=Object.create(core.Container.prototype),Mesh.prototype.constructor=Mesh,module.exports=Mesh,Object.defineProperties(Mesh.prototype,{texture:{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture=e,e&&(e.baseTexture.hasLoaded?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}}),Mesh.prototype._renderWebGL=function(e){e.setObjectRenderer(e.plugins.mesh),e.plugins.mesh.render(this)},Mesh.prototype._renderCanvas=function(e){var t=e.context,r=this.worldTransform;e.roundPixels?t.setTransform(r.a,r.b,r.c,r.d,0|r.tx,0|r.ty):t.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty),this.drawMode===Mesh.DRAW_MODES.TRIANGLE_MESH?this._renderCanvasTriangleMesh(t):this._renderCanvasTriangles(t)},Mesh.prototype._renderCanvasTriangleMesh=function(e){for(var t=this.vertices,r=this.uvs,n=t.length/2,s=0;n-2>s;s++){var i=2*s;this._renderCanvasDrawTriangle(e,t,r,i,i+2,i+4)}},Mesh.prototype._renderCanvasTriangles=function(e){for(var t=this.vertices,r=this.uvs,n=this.indices,s=n.length,i=0;s>i;i+=3){var o=2*n[i],a=2*n[i+1],h=2*n[i+2];this._renderCanvasDrawTriangle(e,t,r,o,a,h)}},Mesh.prototype._renderCanvasDrawTriangle=function(e,t,r,n,s,i){var o=this._texture.baseTexture.source,a=this._texture.baseTexture.width,h=this._texture.baseTexture.height,d=t[n],c=t[s],u=t[i],l=t[n+1],p=t[s+1],v=t[i+1],M=r[n]*a,f=r[s]*a,g=r[i]*a,T=r[n+1]*h,y=r[s+1]*h,_=r[i+1]*h;if(this.canvasPadding>0){var x=this.canvasPadding/this.worldTransform.a,m=this.canvasPadding/this.worldTransform.d,P=(d+c+u)/3,w=(l+p+v)/3,b=d-P,E=l-w,A=Math.sqrt(b*b+E*E);d=P+b/A*(A+x),l=w+E/A*(A+m),b=c-P,E=p-w,A=Math.sqrt(b*b+E*E),c=P+b/A*(A+x),p=w+E/A*(A+m),b=u-P,E=v-w,A=Math.sqrt(b*b+E*E),u=P+b/A*(A+x),v=w+E/A*(A+m)}e.save(),e.beginPath(),e.moveTo(d,l),e.lineTo(c,p),e.lineTo(u,v),e.closePath(),e.clip();var D=M*y+T*g+f*_-y*g-T*f-M*_,R=d*y+T*u+c*_-y*u-T*c-d*_,S=M*c+d*g+f*u-c*g-d*f-M*u,C=M*y*u+T*c*g+d*f*_-d*y*g-T*f*u-M*c*_,L=l*y+T*v+p*_-y*v-T*p-l*_,O=M*p+l*g+f*v-p*g-l*f-M*v,I=M*y*v+T*p*g+l*f*_-l*y*g-T*f*v-M*p*_;e.transform(R/D,L/D,S/D,O/D,C/D,I/D),e.drawImage(o,0,0),e.restore()},Mesh.prototype.renderMeshFlat=function(e){var t=this.context,r=e.vertices,n=r.length/2;t.beginPath();for(var s=1;n-2>s;s++){var i=2*s,o=r[i],a=r[i+2],h=r[i+4],d=r[i+1],c=r[i+3],u=r[i+5];t.moveTo(o,d),t.lineTo(a,c),t.lineTo(h,u)}t.fillStyle="#FF0000",t.fill(),t.closePath()},Mesh.prototype._onTextureUpdate=function(){this.updateFrame=!0},Mesh.prototype.getBounds=function(e){if(!this._currentBounds){for(var t=e||this.worldTransform,r=t.a,n=t.b,s=t.c,i=t.d,o=t.tx,a=t.ty,h=-(1/0),d=-(1/0),c=1/0,u=1/0,l=this.vertices,p=0,v=l.length;v>p;p+=2){var M=l[p],f=l[p+1],g=r*M+s*f+o,T=i*f+n*M+a;c=c>g?g:c,u=u>T?T:u,h=g>h?g:h,d=T>d?T:d}if(c===-(1/0)||d===1/0)return core.Rectangle.EMPTY;var y=this._bounds;y.x=c,y.width=h-c,y.y=u,y.height=d-u,this._currentBounds=y}return this._currentBounds},Mesh.prototype.containsPoint=function(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,tempPoint);var t,r,n=this.vertices,s=tempPolygon.points;if(this.drawMode===Mesh.DRAW_MODES.TRIANGLES){var i=this.indices;for(r=this.indices.length,t=0;r>t;t+=3){var o=2*i[t],a=2*i[t+1],h=2*i[t+2];if(s[0]=n[o],s[1]=n[o+1],s[2]=n[a],s[3]=n[a+1],s[4]=n[h],s[5]=n[h+1],tempPolygon.contains(tempPoint.x,tempPoint.y))return!0}}else for(r=n.length,t=0;r>t;t+=6)if(s[0]=n[t],s[1]=n[t+1],s[2]=n[t+2],s[3]=n[t+3],s[4]=n[t+4],s[5]=n[t+5],tempPolygon.contains(tempPoint.x,tempPoint.y))return!0;return!1},Mesh.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1};
},{"../core":37}],133:[function(require,module,exports){
function Rope(t,e){Mesh.call(this,t),this.points=e,this.vertices=new Float32Array(4*e.length),this.uvs=new Float32Array(4*e.length),this.colors=new Float32Array(2*e.length),this.indices=new Uint16Array(2*e.length),this._ready=!0,this.refresh()}var Mesh=require("./Mesh"),core=require("../core");Rope.prototype=Object.create(Mesh.prototype),Rope.prototype.constructor=Rope,module.exports=Rope,Rope.prototype.refresh=function(){var t=this.points;if(!(t.length<1)&&this._texture._uvs){var e=this.uvs,r=this.indices,o=this.colors,s=this._texture._uvs,i=new core.Point(s.x0,s.y0),h=new core.Point(s.x2-s.x0,s.y2-s.y0);e[0]=0+i.x,e[1]=0+i.y,e[2]=0+i.x,e[3]=1*h.y+i.y,o[0]=1,o[1]=1,r[0]=0,r[1]=1;for(var n,p,y,a=t.length,c=1;a>c;c++)n=t[c],p=4*c,y=c/(a-1),e[p]=y*h.x+i.x,e[p+1]=0+i.y,e[p+2]=y*h.x+i.x,e[p+3]=1*h.y+i.y,p=2*c,o[p]=1,o[p+1]=1,p=2*c,r[p]=p,r[p+1]=p+1;this.dirty=!0}},Rope.prototype._onTextureUpdate=function(){Mesh.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},Rope.prototype.updateTransform=function(){var t=this.points;if(!(t.length<1)){for(var e,r,o,s,i,h,n=t[0],p=0,y=0,a=this.vertices,c=t.length,l=0;c>l;l++)r=t[l],o=4*l,e=l<t.length-1?t[l+1]:r,y=-(e.x-n.x),p=e.y-n.y,s=10*(1-l/(c-1)),s>1&&(s=1),i=Math.sqrt(p*p+y*y),h=this._texture.height/2,p/=i,y/=i,p*=h,y*=h,a[o]=r.x+p,a[o+1]=r.y+y,a[o+2]=r.x-p,a[o+3]=r.y-y,n=r;this.containerUpdateTransform()}};
},{"../core":37,"./Mesh":132}],134:[function(require,module,exports){
module.exports={Mesh:require("./Mesh"),Rope:require("./Rope"),MeshRenderer:require("./webgl/MeshRenderer"),MeshShader:require("./webgl/MeshShader")};
},{"./Mesh":132,"./Rope":133,"./webgl/MeshRenderer":135,"./webgl/MeshShader":136}],135:[function(require,module,exports){
function MeshRenderer(e){core.ObjectRenderer.call(this,e),this.indices=new Uint16Array(15e3);for(var r=0,t=0;15e3>r;r+=6,t+=4)this.indices[r+0]=t+0,this.indices[r+1]=t+1,this.indices[r+2]=t+2,this.indices[r+3]=t+0,this.indices[r+4]=t+2,this.indices[r+5]=t+3}var core=require("../../core"),Mesh=require("../Mesh");MeshRenderer.prototype=Object.create(core.ObjectRenderer.prototype),MeshRenderer.prototype.constructor=MeshRenderer,module.exports=MeshRenderer,core.WebGLRenderer.registerPlugin("mesh",MeshRenderer),MeshRenderer.prototype.onContextChange=function(){},MeshRenderer.prototype.render=function(e){e._vertexBuffer||this._initWebGL(e);var r=this.renderer,t=r.gl,i=e._texture.baseTexture,n=r.shaderManager.plugins.meshShader,f=e.drawMode===Mesh.DRAW_MODES.TRIANGLE_MESH?t.TRIANGLE_STRIP:t.TRIANGLES;r.blendModeManager.setBlendMode(e.blendMode),t.uniformMatrix3fv(n.uniforms.translationMatrix._location,!1,e.worldTransform.toArray(!0)),t.uniformMatrix3fv(n.uniforms.projectionMatrix._location,!1,r.currentRenderTarget.projectionMatrix.toArray(!0)),t.uniform1f(n.uniforms.alpha._location,e.worldAlpha),e.dirty?(e.dirty=!1,t.bindBuffer(t.ARRAY_BUFFER,e._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,e.vertices,t.STATIC_DRAW),t.vertexAttribPointer(n.attributes.aVertexPosition,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e._uvBuffer),t.bufferData(t.ARRAY_BUFFER,e.uvs,t.STATIC_DRAW),t.vertexAttribPointer(n.attributes.aTextureCoord,2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),i._glTextures[t.id]?t.bindTexture(t.TEXTURE_2D,i._glTextures[t.id]):this.renderer.updateTexture(i),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e.indices,t.STATIC_DRAW)):(t.bindBuffer(t.ARRAY_BUFFER,e._vertexBuffer),t.bufferSubData(t.ARRAY_BUFFER,0,e.vertices),t.vertexAttribPointer(n.attributes.aVertexPosition,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e._uvBuffer),t.vertexAttribPointer(n.attributes.aTextureCoord,2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),i._glTextures[t.id]?t.bindTexture(t.TEXTURE_2D,i._glTextures[t.id]):this.renderer.updateTexture(i),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e._indexBuffer),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.indices)),t.drawElements(f,e.indices.length,t.UNSIGNED_SHORT,0)},MeshRenderer.prototype._initWebGL=function(e){var r=this.renderer.gl;e._vertexBuffer=r.createBuffer(),e._indexBuffer=r.createBuffer(),e._uvBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e._vertexBuffer),r.bufferData(r.ARRAY_BUFFER,e.vertices,r.DYNAMIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,e._uvBuffer),r.bufferData(r.ARRAY_BUFFER,e.uvs,r.STATIC_DRAW),e.colors&&(e._colorBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e._colorBuffer),r.bufferData(r.ARRAY_BUFFER,e.colors,r.STATIC_DRAW)),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e._indexBuffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e.indices,r.STATIC_DRAW)},MeshRenderer.prototype.flush=function(){},MeshRenderer.prototype.start=function(){var e=this.renderer.shaderManager.plugins.meshShader;this.renderer.shaderManager.setShader(e)},MeshRenderer.prototype.destroy=function(){core.ObjectRenderer.prototype.destroy.call(this)};
},{"../../core":37,"../Mesh":132}],136:[function(require,module,exports){
function MeshShader(e){core.Shader.call(this,e,["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * alpha ;","}"].join("\n"),{alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aTextureCoord:0})}var core=require("../../core");MeshShader.prototype=Object.create(core.Shader.prototype),MeshShader.prototype.constructor=MeshShader,module.exports=MeshShader,core.ShaderManager.registerPlugin("meshShader",MeshShader);
},{"../../core":37}],137:[function(require,module,exports){
Math.sign||(Math.sign=function(n){return n=+n,0===n||isNaN(n)?n:n>0?1:-1});
},{}],138:[function(require,module,exports){
Object.assign||(Object.assign=require("object-assign"));
},{"object-assign":21}],139:[function(require,module,exports){
require("./Object.assign"),require("./requestAnimationFrame"),require("./Math.sign");
},{"./Math.sign":137,"./Object.assign":138,"./requestAnimationFrame":140}],140:[function(require,module,exports){
(function (global){
if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!global.performance||!global.performance.now){var startTime=Date.now();global.performance||(global.performance={}),global.performance.now=function(){return Date.now()-startTime}}for(var lastTime=Date.now(),vendors=["ms","moz","webkit","o"],x=0;x<vendors.length&&!global.requestAnimationFrame;++x)global.requestAnimationFrame=global[vendors[x]+"RequestAnimationFrame"],global.cancelAnimationFrame=global[vendors[x]+"CancelAnimationFrame"]||global[vendors[x]+"CancelRequestAnimationFrame"];global.requestAnimationFrame||(global.requestAnimationFrame=function(e){if("function"!=typeof e)throw new TypeError(e+"is not a function");var n=Date.now(),a=16+lastTime-n;return 0>a&&(a=0),lastTime=n,setTimeout(function(){lastTime=Date.now(),e(performance.now())},a)}),global.cancelAnimationFrame||(global.cancelAnimationFrame=function(e){clearTimeout(e)});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],141:[function(require,module,exports){
var Stats=function(){function e(e,n,t){var r=document.createElement(e);return r.id=n,r.style.cssText=t,r}function n(n,t,r){var i=e("div",n,"padding:0 0 3px 3px;text-align:left;background:"+r),a=e("div",n+"Text","font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px;color:"+t);a.innerHTML=n.toUpperCase(),i.appendChild(a);var o=e("div",n+"Graph","width:74px;height:30px;background:"+t);i.appendChild(o);for(var d=0;74>d;d++)o.appendChild(e("span","","width:1px;height:30px;float:left;opacity:0.9;background:"+r));return i}function t(e){for(var n=l.children,t=0;t<n.length;t++)n[t].style.display=t===e?"block":"none";p=e}function r(e,n){var t=e.appendChild(e.firstChild);t.style.height=Math.min(30,30-30*n)+"px"}var i=self.performance&&self.performance.now?self.performance.now.bind(performance):Date.now,a=i(),o=a,d=0,p=0,l=e("div","stats","width:80px;opacity:0.9;cursor:pointer");l.addEventListener("mousedown",function(e){e.preventDefault(),t(++p%l.children.length)},!1);var f=0,h=1/0,c=0,m=n("fps","#0ff","#002"),s=m.children[0],u=m.children[1];l.appendChild(m);var v=0,x=1/0,g=0,M=n("ms","#0f0","#020"),C=M.children[0],y=M.children[1];if(l.appendChild(M),self.performance&&self.performance.memory){var b=0,w=1/0,S=0,k=n("mb","#f08","#201"),E=k.children[0],H=k.children[1];l.appendChild(k)}return t(p),{REVISION:14,domElement:l,setMode:t,begin:function(){a=i()},end:function(){var e=i();if(v=e-a,x=Math.min(x,v),g=Math.max(g,v),C.textContent=(0|v)+" MS ("+(0|x)+"-"+(0|g)+")",r(y,v/200),d++,e>o+1e3&&(f=Math.round(1e3*d/(e-o)),h=Math.min(h,f),c=Math.max(c,f),s.textContent=f+" FPS ("+h+"-"+c+")",r(u,f/100),o=e,d=0,void 0!==b)){var n=performance.memory.usedJSHeapSize,t=performance.memory.jsHeapSizeLimit;b=Math.round(9.54e-7*n),w=Math.min(w,b),S=Math.max(S,b),E.textContent=b+" MB ("+w+"-"+S+")",r(H,n/t)}return e},update:function(){a=this.end()}}};"object"==typeof module&&(module.exports=Stats);
},{}],142:[function(require,module,exports){
module.exports={Entity:require("./lib/Entity.js"),EntityManager:require("./lib/EntityManager.js"),Messanger:require("./lib/Messanger.js"),ObjectPool:require("./lib/ObjectPool.js"),QuadTree:require("./lib/QuadTree.js"),Spatial:require("./lib/Spatial.js"),Vec2:require("./lib/Vec2.js")};
},{"./lib/Entity.js":143,"./lib/EntityManager.js":144,"./lib/Messanger.js":146,"./lib/ObjectPool.js":147,"./lib/QuadTree.js":148,"./lib/Spatial.js":149,"./lib/Vec2.js":150}],143:[function(require,module,exports){
function Entity(){this._manager=null,this._Components=[],this._tags=[]}module.exports=Entity,Entity.prototype.addComponent=function(t){return this._manager.entityAddComponent(this,t),this},Entity.prototype.removeComponent=function(t){return this._manager.entityRemoveComponent(this,t),this},Entity.prototype.hasComponent=function(t){return!!~this._Components.indexOf(t)},Entity.prototype.hasAllComponents=function(t){for(var n=!0,e=0;e<t.length;e++){var o=t[e];n&=!!~this._Components.indexOf(o)}return n},Entity.prototype.hasTag=function(t){return!!~this._tags.indexOf(t)},Entity.prototype.addTag=function(t){return this._manager.entityAddTag(this,t),this},Entity.prototype.removeTag=function(t){return this._manager.entityRemoveTag(this,t),this},Entity.prototype.remove=function(){return this._manager.removeEntity(this)};
},{}],144:[function(require,module,exports){
function EntityManager(t){this.messanger=t,this._tags={},this._entities=[],this._groups={},this._entityPool=new ObjectPool(Entity),this._componentPools={}}function Group(t,e){this.Components=t||[],this.entities=e||[]}function componentPropertyName(t){var e=getName(t);return e.charAt(0).toLowerCase()+e.slice(1)}function groupKey(t){for(var e=[],n=0;n<t.length;n++){var i=t[n];e.push(getName(i))}return e.map(function(t){return t.toLowerCase()}).sort().join("-")}module.exports=EntityManager;var Entity=require("./Entity.js"),ObjectPool=require("./ObjectPool.js"),Messanger=require("./Messanger.js"),getName=require("typedef").getName;EntityManager.ENTITY_CREATED="EntityManager#ENTITY_CREATED",EntityManager.ENTITY_REMOVE="EntityManager#ENTITY_REMOVE",EntityManager.COMPONENT_ADDED="EntityManager#COMPONENT_ADDED",EntityManager.COMPONENT_REMOVE="EntityManager#COMPONENT_REMOVE",EntityManager.prototype.createEntity=function(){var t=this._entityPool.aquire();return this._entities.push(t),t._manager=this,this._trigger(EntityManager.ENTITY_CREATED,t),t},EntityManager.prototype.removeEntitiesByTag=function(t){var e=this._tags[t];if(e)for(var n=e.length-1;n>=0;n--){var i=e[n];i.remove()}},EntityManager.prototype.removeAllEntities=function(){for(var t=this._entities.length-1;t>=0;t--)this._entities[t].remove()},EntityManager.prototype.removeEntity=function(t){var e=this._entities.indexOf(t);if(!~e)throw new Error("Tried to remove entity not in list");this.entityRemoveAllComponents(t),this._trigger(EntityManager.ENTITY_REMOVE,t),this._entities.splice(e,1),t._tags=null;for(var n in this._tags){var i=this._tags[n],o=i.indexOf(t);~o&&i.splice(o,1)}t._manager=null,this._entityPool.release(t)},EntityManager.prototype.entityAddTag=function(t,e){var n=this._tags[e];n||(n=this._tags[e]=[]),~n.indexOf(t)||(n.push(t),t._tags.push(e))},EntityManager.prototype.entityRemoveTag=function(t,e){var n=this._tags[e];if(n){var i=n.indexOf(t);~i&&(n.splice(i,1),t._tags.splice(t._tags.indexOf(e),1))}},EntityManager.prototype.entityAddComponent=function(t,e){if(!~t._Components.indexOf(e)){t._Components.push(e);var n=componentPropertyName(e),i=this._componentPools[n];i||(i=this._componentPools[n]=new ObjectPool(e));var o=i.aquire();t[n]=o;for(var r in this._groups){var s=this._groups[r];~s.Components.indexOf(e)&&t.hasAllComponents(s.Components)&&(~s.entities.indexOf(t)||s.entities.push(t))}this._trigger(EntityManager.COMPONENT_ADDED,t,e)}},EntityManager.prototype.entityRemoveAllComponents=function(t){for(var e=t._Components,n=e.length-1;n>=0;n--){var i=e[n];t.removeComponent(i)}},EntityManager.prototype.entityRemoveComponent=function(t,e){var n=t._Components.indexOf(e);if(~n){this._trigger(EntityManager.COMPONENT_REMOVE,t,e);for(var i in this._groups){var o=this._groups[i];if(~o.Components.indexOf(e)&&t.hasAllComponents(o.Components)){var r=o.entities.indexOf(t);~r&&o.entities.splice(r,1)}}var s=componentPropertyName(e);t._Components.splice(n,1);var a=t[s];delete t[s],this._componentPools[s].release(a)}},EntityManager.prototype.queryComponents=function(t){var e=this._groups[groupKey(t)];return e||(e=this._indexGroup(t)),e.entities},EntityManager.prototype.queryTag=function(t){var e=this._tags[t];return void 0===e&&(e=this._tags[t]=[]),e},EntityManager.prototype.count=function(){return this._entities.length},EntityManager.prototype.poolStats=function(){var t={};this._entityPool;t.entity={used:this._entityPool.totalUsed(),size:this._entityPool.count};for(var e in this._componentPools){var n=this._componentPools[e];t[e]={used:n.totalUsed(),size:n.count}}return t},EntityManager.prototype._indexGroup=function(t){var e=groupKey(t);if(!this._groups[e]){for(var n=this._groups[e]=new Group(t),i=0;i<this._entities.length;i++){var o=this._entities[i];o.hasAllComponents(t)&&n.entities.push(o)}return n}},EntityManager.prototype._trigger=function(t,e,n){this.messanger&&this.messanger.trigger(t,e,n)};
},{"./Entity.js":143,"./Messanger.js":146,"./ObjectPool.js":147,"typedef":151}],145:[function(require,module,exports){
function Event(n,t){this._name=n||"name",this._callback=t||null,this._Components=[]}module.exports=Event,Event.prototype.fire=function(n,t,e){if(n!==this._name)return!1;var o=this._Components;return!(t&&t.hasAllComponents&&o.length)||t&&t.hasAllComponents(o)?(this._callback(t,e),!0):!1},Event.prototype.whereComponent=function(n){this._Components.push(n)},Event.prototype.whereComponents=function(n){return this._Components=this._Components.concat(n),this};
},{}],146:[function(require,module,exports){
function Messanger(){this._events={},this.fired=0,this.handled=0}module.exports=Messanger;var Event=require("./Event.js");Messanger.prototype.listenTo=function(e,t){this._events[e]||(this._events[e]=[]);var s=new Event(e,t);return this._events[e].push(s),s},Messanger.prototype.trigger=function(e,t,s){this.fired++;var n=this._events[e];if(n)for(var r=0;r<n.length;r++){var i=n[r];i.fire(e,t,s)&&this.handled++}};
},{"./Event.js":145}],147:[function(require,module,exports){
function ObjectPool(t){this.freeList=[],this.count=0,this.T=t}module.exports=ObjectPool,ObjectPool.prototype.aquire=function(){this.freeList.length<=0&&this.expand(Math.round(.2*this.count)+1);var t=this.freeList.pop();return t.__init?t.__init():this.T.call(t),t},ObjectPool.prototype.release=function(t){this.freeList.push(t)},ObjectPool.prototype.expand=function(t){for(var e=0;t>e;e++)this.freeList.push(new this.T);this.count+=t},ObjectPool.prototype.totalSize=function(){return this.count},ObjectPool.prototype.totalFree=function(){return this.freeList.length},ObjectPool.prototype.totalUsed=function(){return this.count-this.freeList.length};
},{}],148:[function(require,module,exports){
function QuadTree(){this.level=0,this.position=new Vec2,this.size=new Vec2,this.maxEntities=15,this.maxLevels=10,this.pool=new ObjectPool(QuadTree),this.nodes=[],this.entities=[]}module.exports=QuadTree;var ObjectPool=require("./ObjectPool.js"),Spatial=require("./Spatial.js"),Vec2=require("./Vec2.js");QuadTree.prototype.__init=function(){this.level=0,this.position.clear(),this.size.clear(),this.nodes.length=0,this.entities.length=0,this.pool=null},QuadTree.prototype.insert=function(t){if(this.nodes.length){var e=this._getIndex(t.spatial.absPosition(),t.spatial.absHwidth());if(~e)return this.nodes[e].insert(t)}return this.entities.push(t),this._splitAndRedistributeIfNeeded(),t.spatial._node=this,t},QuadTree.prototype.remove=function(t){var e=this.entities.indexOf(t);if(~e)return this.entities.splice(e,1),t.spatial._node=null,void(this.totalSize()||this.clear());if(this.nodes.length){var i=this._getIndex(t.spatial.absPosition(),t.spatial.absHwidth());if(~i)return this.nodes[i].remove(t)}},QuadTree.prototype.totalSize=function(){for(var t=this.entities.length,e=0;e<this.nodes.length;e++){var i=this.nodes[e];t+=i.totalSize()}return t},QuadTree.prototype.clear=function(){for(var t=0;t<this.entities.length;t++){var e=this.entities[t];e.spatial._node=null}this.entities.length=0;for(var i=0;i<this.nodes.length;i++){var s=this.nodes[i];s.clear(),this.pool.release(s)}this.nodes.length=0},QuadTree.prototype.queryArea=function(t,e,i){var s=i||[],n=this._getIndex(t,e);if(~n&&this.nodes.length)this.nodes[n].queryArea(t,e,s);else for(var o=0;o<this.nodes.length;o++){var r=this.nodes[o];r.queryArea(t,e,s)}for(var a=0;a<this.entities.length;a++){var h=this.entities[a],l=Vec2.rectIntersect(h.spatial.absPosition(),h.spatial.absHwidth(),t,e);l&&s.push(h)}return s},QuadTree.prototype.reIndex=function(){this._combine(),this._splitAndRedistributeIfNeeded()};var tSize=new Vec2,tPos=new Vec2;QuadTree.prototype.validateEntity=function(t){var e=t.spatial.position,i=t.spatial.hwidth;tSize.assign(this.size).smult(.5),tPos.assign(tSize).add(this.position);var s=Vec2.rectContains(e,i,tPos,tSize);if(!s)return!1;if(!this.nodes.length)return!0;var n=this._getIndex(t.spatial.absPosition(),t.spatial.absHwidth());return this.nodes.length&&!~n?!0:!1},QuadTree.prototype._getIndex=function(t,e){var i=this.position.x+this.size.x/2,s=this.position.y+this.size.y/2,n=t.x-e.x<i&&t.x+e.x<i,o=t.x-e.x>i&&t.x+e.x>i,r=t.y-e.y<s&&t.y+e.y<s,a=t.y-e.y>s&&t.y+e.y>s;return r&&o?0:r&&n?1:a&&n?2:a&&o?3:-1},QuadTree.prototype._splitAndRedistributeIfNeeded=function(){this.entities.length>this.maxEntities&&this.level<this.maxLevels&&(this._split(),this._redistribute())},QuadTree.prototype._factory=function(){var t=this.pool.aquire();return t.pool=this.pool,t.level=this.level+1,t.maxEntities=this.maxEntities,t.maxLevels=this.maxLevels,t},QuadTree.prototype._split=function(){if(!this.nodes.length)for(var t=this.position.x,e=this.position.y,i=this.size.x/2,s=this.size.y/2,n=0;4>n;n++){var o=this._factory();switch(o.size.set(i,s),n){case 0:o.position.set(t+i,e);break;case 1:o.position.set(t,e);break;case 2:o.position.set(t,e+s);break;case 3:o.position.set(t+i,e+s)}this.nodes.push(o)}},QuadTree.prototype._redistribute=function(){for(var t=0;t<this.entities.length;){var e=this.entities[t],i=this._getIndex(e.spatial.absPosition(),e.spatial.absHwidth());~i?(this.nodes[i].insert(e),this.entities.splice(t,1)):t++}},QuadTree.prototype._combine=function(){for(var t=0;t<this.nodes.length;t++){var e=this.nodes[t];e._combine();for(var i=0;i<e.entities.length;i++){var s=e.entities[i];this.entities.push(s)}e.entities.length=0,e.clear(),this.pool.release(e)}this.nodes.length=0};
},{"./ObjectPool.js":147,"./Spatial.js":149,"./Vec2.js":150}],149:[function(require,module,exports){
function Spatial(){this.position=new Vec2,this.scale=new Vec2,this.hwidth=new Vec2,this._absScale=new Vec2,this._absPosition=new Vec2,this._absHwidth=new Vec2,this.__init()}module.exports=Spatial;var Vec2=require("./Vec2.js");Spatial.prototype.__init=function(){this.rotation=0,this._node=null,this.parent=null,this.position.clear(),this.scale.set(1,1),this.hwidth.clear(),this._absPosition.clear(),this._absScale.set(1,1),this._absHwidth.clear()},Spatial.COINCIDENT="Spatial#COINCIDENT",Spatial.prototype.attachTo=function(t){if(this.parent)throw new Error("Entity already attached");if(!t||!t.spatial)throw new Error("Invalid / missing entity");this.parent=t.spatial},Spatial.prototype.absPosition=function(){var t=this._absPosition.assign(this.position);if(!this.parent)return t;var i=this.parent;this.absRotation();t.rotate(i.absRotation());var a=i.absScale();return t.set(t.x*a.x,t.y*a.y),t.add(i.absPosition())},Spatial.prototype.absRotation=function(){if(!this.parent)return this.rotation;var t=this.rotation+this.parent.absRotation();return t%(2*Math.PI)},Spatial.prototype.absHwidth=function(){var t=this._absHwidth.assign(this.hwidth);if(!this.parent)return t;var i=this.absScale();return t.set(t.x*i.x,t.y*i.y)},Spatial.prototype.absScale=function(){var t=this._absScale.assign(this.scale);if(!this.parent)return t;var i=this.parent.absScale();return t.set(t.x*i.x,t.y*i.y)};
},{"./Vec2.js":150}],150:[function(require,module,exports){
function Vec2(t,e){this.x=+t||0,this.y=+e||0}module.exports=Vec2;var ObjectPool=require("./ObjectPool.js");Vec2.prototype.__init=function(){this.clear()};var pool=new ObjectPool(Vec2);Vec2.aquire=function(){return pool.aquire()},Vec2.release=function(t){return t&&pool.release(t),pool.count-pool.freeList.length},Vec2.prototype.clear=function(){return this.x=this.y=0,this},Vec2.prototype.assign=function(t){return this.x=t.x,this.y=t.y,this},Vec2.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},Vec2.prototype.set=function(t,e){return this.x=+t,this.y=+e,this},Vec2.prototype.limit=function(t){return t=+t,t&&this.magnitude()>t?this.normalize(t):this},Vec2.prototype.normalize=function(t){t=t||1;var e=Math.sqrt(this.x*this.x+this.y*this.y);return this.x=t*this.x/e,this.y=t*this.y/e,this},Vec2.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},Vec2.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},Vec2.prototype.smult=function(t){return t=+t,this.x*=t,this.y*=t,this},Vec2.prototype.rotate=function(t){return this.set(this.x*Math.cos(t)-this.y*Math.sin(t),this.x*Math.sin(t)+this.y*Math.cos(t))},Vec2.prototype.dot=function(t){return+(this.x*t.x+this.y*t.y)},Vec2.prototype.det=function(t){return+(this.x*t.y-this.y*t.x)},Vec2.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Vec2.prototype.magnitude2=function(){return this.x*this.x+this.y*this.y},Vec2.prototype.angle=function(){return Math.atan2(this.y,this.x)},Vec2.prototype.angleBetween=function(t){return Math.atan2(this.det(t),this.dot(t))},Vec2.prototype.pcopy=function(){return Vec2.aquire().assign(this)},Vec2.prototype.copy=function(){return(new Vec2).assign(this)},Vec2.fromAngle=function(t,e){return e=+e||1,new Vec2(Math.cos(t)*e,Math.sin(t)*e)},Vec2.pfromAngle=function(t,e){return e=+e||1,Vec2.aquire().set(Math.cos(t)*e,Math.sin(t)*e)},Vec2.rectIntersect=function(t,e,i,n){var o=t.x+e.x<i.x-n.x,r=t.x-e.x>i.x+n.x,s=t.y+e.y<i.y-n.y,c=t.y-e.y>i.y+n.y;return!(o||r||s||c)},Vec2.rectContains=function(t,e,i,n){return t.x-e.x<i.x-n.x?!1:t.x+e.x>i.x+n.x?!1:t.y-e.y<i.y-n.y?!1:t.y+e.y>i.y+n.y?!1:!0},Vec2.sizeToHwidth=function(t,e,i,n){n.assign(e).smult(.5),i.assign(t).add(n)},Vec2.prototype.toString=function(){return""+this.x.toFixed(2)+","+this.y.toFixed(2)};
},{"./ObjectPool.js":147}],151:[function(require,module,exports){
module.exports={"extends":require("./lib/extends.js"),mixin:require("./lib/mixin.js"),getArguments:require("./lib/getArguments.js"),getName:require("./lib/getName.js")};
},{"./lib/extends.js":152,"./lib/getArguments.js":153,"./lib/getName.js":154,"./lib/mixin.js":155}],152:[function(require,module,exports){
function extends_(t,e){for(var o in e)!t.hasOwnProperty(o)&&e.hasOwnProperty(o)&&(t[o]=e[o]);if(t.Super=e,Object.create instanceof Function)t.prototype=Object.create(e.prototype,{constructor:{value:t}});else{var r=makeT(t);r.prototype=e.prototype,t.prototype=new r}return t}function makeT(t){return function(){this.constructor=t}}module.exports=extends_;
},{}],153:[function(require,module,exports){
function getArguments(r){var t=[],e=r.toString().match(FUNCTION_ARGS);if(e){e=e[1].replace(/[ ]*,[ ]*/,",").split(",");for(var n=0;n<e.length;n++){var a=e[n].replace(/^\s+|\s+$/g,"");a&&t.push(a)}}return t}module.exports=getArguments;var FUNCTION_ARGS=/^\w*function[^\(]*\(([^\)]+)/;
},{}],154:[function(require,module,exports){
function getName(n){var t="";if(n instanceof Function){if(n.name)return n.name;var e=n.toString().match(FUNCTION_NAME);e&&(t=e[1])}else n&&n.constructor instanceof Function&&(t=getName(n.constructor));return t}module.exports=getName;var FUNCTION_NAME=/function\s+([^\s(]+)/;
},{}],155:[function(require,module,exports){
function mixin_(o,n){if(n instanceof Function){for(var i in n)o[i]=n[i];n=n.prototype}for(var r in n)n.hasOwnProperty(r)&&(o.prototype[r]=n[r])}module.exports=mixin_;
},{}]},{},[10])


//# sourceMappingURL=./bundle/bundle.map.json